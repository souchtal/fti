<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.18">
  <compounddef id="api-cuda_8c" kind="file" language="C++">
    <compoundname>api-cuda.c</compoundname>
    <includes refid="interface_8h" local="yes">interface.h</includes>
    <includes local="yes">fti.h</includes>
    <includes local="yes">zlib.h</includes>
    <includes local="no">assert.h</includes>
    <includes local="no">string.h</includes>
    <includes local="yes">/home/bscuser/Documents/release/dev/fti/src/utility.h</includes>
    <includes local="no">openssl/md5.h</includes>
    <includes local="no">sys/types.h</includes>
    <includes local="no">sys/stat.h</includes>
    <includes local="no">unistd.h</includes>
    <includes local="no">stdio.h</includes>
    <includes local="no">stdlib.h</includes>
    <includes local="yes">/home/bscuser/Documents/release/dev/fti/deps/iniparser/dictionary.h</includes>
    <includes local="no">stdint.h</includes>
    <includes local="yes">/home/bscuser/Documents/release/dev/fti/deps/jerasure/include/gf_complete.h</includes>
    <includes local="yes">/home/bscuser/Documents/release/dev/fti/deps/jerasure/include/galois.h</includes>
    <incdepgraph>
      <node id="32">
        <label>sys/stat.h</label>
      </node>
      <node id="28">
        <label>IO/ftiff.h</label>
      </node>
      <node id="13">
        <label>stdbool.h</label>
      </node>
      <node id="3">
        <label>fti.h</label>
        <link refid="fti_8h"/>
        <childnode refid="4" relation="include">
        </childnode>
      </node>
      <node id="9">
        <label>stdarg.h</label>
      </node>
      <node id="30">
        <label>failure-injection.h</label>
        <link refid="failure-injection_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="31" relation="include">
        </childnode>
        <childnode refid="32" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="34" relation="include">
        </childnode>
      </node>
      <node id="45">
        <label>../deps/jerasure/include/galois.h</label>
      </node>
      <node id="17">
        <label>postreco.h</label>
        <link refid="postreco_8h"/>
      </node>
      <node id="49">
        <label>assert.h</label>
      </node>
      <node id="50">
        <label>openssl/md5.h</label>
      </node>
      <node id="2">
        <label>interface.h</label>
        <link refid="interface_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="16" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
        <childnode refid="21" relation="include">
        </childnode>
        <childnode refid="22" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
        <childnode refid="24" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="26" relation="include">
        </childnode>
        <childnode refid="27" relation="include">
        </childnode>
        <childnode refid="28" relation="include">
        </childnode>
        <childnode refid="29" relation="include">
        </childnode>
        <childnode refid="30" relation="include">
        </childnode>
        <childnode refid="35" relation="include">
        </childnode>
        <childnode refid="36" relation="include">
        </childnode>
        <childnode refid="37" relation="include">
        </childnode>
        <childnode refid="38" relation="include">
        </childnode>
        <childnode refid="39" relation="include">
        </childnode>
        <childnode refid="40" relation="include">
        </childnode>
        <childnode refid="41" relation="include">
        </childnode>
        <childnode refid="43" relation="include">
        </childnode>
        <childnode refid="44" relation="include">
        </childnode>
        <childnode refid="45" relation="include">
        </childnode>
        <childnode refid="46" relation="include">
        </childnode>
        <childnode refid="42" relation="include">
        </childnode>
      </node>
      <node id="11">
        <label>stdint.h</label>
      </node>
      <node id="6">
        <label>stdlib.h</label>
      </node>
      <node id="10">
        <label>errno.h</label>
      </node>
      <node id="38">
        <label>icp.h</label>
        <link refid="icp_8h"/>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
      </node>
      <node id="33">
        <label>fcntl.h</label>
      </node>
      <node id="20">
        <label>conf.h</label>
        <link refid="conf_8h"/>
      </node>
      <node id="35">
        <label>postckpt.h</label>
        <link refid="postckpt_8h"/>
      </node>
      <node id="43">
        <label>../deps/iniparser/iniparser.h</label>
      </node>
      <node id="5">
        <label>stddef.h</label>
      </node>
      <node id="27">
        <label>IO/hdf5-fti.h</label>
      </node>
      <node id="47">
        <label>fti.h</label>
      </node>
      <node id="15">
        <label>meta.h</label>
        <link refid="meta_8h"/>
      </node>
      <node id="34">
        <label>limits.h</label>
      </node>
      <node id="21">
        <label>checkpoint.h</label>
        <link refid="checkpoint_8h"/>
      </node>
      <node id="19">
        <label>dcp.h</label>
        <link refid="dcp_8h"/>
      </node>
      <node id="36">
        <label>recover.h</label>
        <link refid="recover_8h"/>
      </node>
      <node id="31">
        <label>sys/types.h</label>
      </node>
      <node id="8">
        <label>string.h</label>
      </node>
      <node id="40">
        <label>utility.h</label>
        <link refid="utility_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="41" relation="include">
        </childnode>
        <childnode refid="42" relation="include">
        </childnode>
      </node>
      <node id="53">
        <label>/home/bscuser/Documents/release/dev/fti/deps/jerasure/include/galois.h</label>
      </node>
      <node id="18">
        <label>tools.h</label>
        <link refid="tools_8h"/>
      </node>
      <node id="22">
        <label>stage.h</label>
        <link refid="stage_8h"/>
      </node>
      <node id="12">
        <label>unistd.h</label>
      </node>
      <node id="23">
        <label>fti-io.h</label>
        <link refid="fti-io_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
      </node>
      <node id="52">
        <label>/home/bscuser/Documents/release/dev/fti/deps/jerasure/include/gf_complete.h</label>
      </node>
      <node id="4">
        <label>fti-intern.h</label>
        <link refid="fti-intern_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
      </node>
      <node id="41">
        <label>../deps/md5/md5.h</label>
      </node>
      <node id="44">
        <label>../deps/iniparser/dictionary.h</label>
      </node>
      <node id="26">
        <label>IO/posix-dcp.h</label>
      </node>
      <node id="25">
        <label>IO/posix.h</label>
      </node>
      <node id="46">
        <label>../deps/jerasure/include/jerasure.h</label>
      </node>
      <node id="14">
        <label>mpi.h</label>
      </node>
      <node id="29">
        <label>IO/ftiff-dcp.h</label>
      </node>
      <node id="42">
        <label>sion.h</label>
      </node>
      <node id="39">
        <label>macros.h</label>
        <link refid="macros_8h"/>
      </node>
      <node id="51">
        <label>/home/bscuser/Documents/release/dev/fti/deps/iniparser/dictionary.h</label>
      </node>
      <node id="48">
        <label>zlib.h</label>
      </node>
      <node id="37">
        <label>fortran/ftif.h</label>
      </node>
      <node id="7">
        <label>stdio.h</label>
      </node>
      <node id="24">
        <label>topo.h</label>
        <link refid="topo_8h"/>
      </node>
      <node id="1">
        <label>/home/bscuser/Documents/release/dev/fti/src/api-cuda.c</label>
        <link refid="api-cuda_8c"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="47" relation="include">
        </childnode>
        <childnode refid="48" relation="include">
        </childnode>
        <childnode refid="49" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="40" relation="include">
        </childnode>
        <childnode refid="50" relation="include">
        </childnode>
        <childnode refid="31" relation="include">
        </childnode>
        <childnode refid="32" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="51" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="52" relation="include">
        </childnode>
        <childnode refid="53" relation="include">
        </childnode>
      </node>
      <node id="16">
        <label>api-cuda.h</label>
        <link refid="api-cuda_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
    </incdepgraph>
      <sectiondef kind="var">
      <memberdef kind="variable" id="api-cuda_8c_1aa95ffe47f6277da792e9454674c5c23a" prot="public" static="no" mutable="no">
        <type>void *</type>
        <definition>void* hostBuffers[2]</definition>
        <argsstring>[2]</argsstring>
        <name>hostBuffers</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api-cuda.c" line="10" column="6" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api-cuda.c" bodystart="10" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="api-cuda_8c_1a7be887a2ca0a258cf6b368d32fd87487" prot="public" static="no" mutable="no">
        <type>size_t</type>
        <definition>size_t bufferSize</definition>
        <argsstring></argsstring>
        <name>bufferSize</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api-cuda.c" line="11" column="8" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api-cuda.c" bodystart="11" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="func">
      <memberdef kind="function" id="api-cuda_8c_1a77a43dab41fd5721fa4581af47413f4c" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FTI_get_pointer_info</definition>
        <argsstring>(const void *ptr, FTIT_ptrinfo *ptrInfo)</argsstring>
        <name>FTI_get_pointer_info</name>
        <param>
          <type>const void *</type>
          <declname>ptr</declname>
        </param>
        <param>
          <type><ref refid="structFTIT__ptrinfo" kindref="compound">FTIT_ptrinfo</ref> *</type>
          <declname>ptrInfo</declname>
        </param>
        <briefdescription>
<para>It gets the information of this pointer (CPU or GPU, which device, etc.). </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>ptr</parametername>
</parameternamelist>
<parameterdescription>
<para>The pointer to be checked. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>ptrInfo</parametername>
</parameternamelist>
<parameterdescription>
<para>Output the information regarding this pointer. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>integer FTI_SCES if successful.</para>
</simplesect>
This function returns the information of the pointer. It is useful for determining the location of data. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api-cuda.c" line="26" column="5" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api-cuda.c" bodystart="26" bodyend="55"/>
        <references refid="structFTIT__ptrinfo_1a1cadbdc42a8942d807b500b9cb2fe78f" compoundref="api-cuda_8h" startline="47">FTIT_ptrinfo::deviceID</references>
        <references refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" compoundref="fti_8h" startline="12">FTI_BUFS</references>
        <references refid="fti-intern_8h_1a299db837571db9e73119d159b3428fe0" compoundref="fti-intern_8h" startline="65">FTI_DBUG</references>
        <references refid="fti-intern_8h_1a5cb1252ae17ef4ac13b3dbe5a8b1ab13" compoundref="fti-intern_8h" startline="57">FTI_EROR</references>
        <references refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" compoundref="fti_8h" startline="20">FTI_NSCS</references>
        <references refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" compoundref="api_8c" startline="2548" endline="2576">FTI_Print</references>
        <references refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" compoundref="fti_8h" startline="18">FTI_SCES</references>
        <references refid="api-cuda_8h_1a86980048ebdb2b691b357773e7cf4e2da29018ea9dff75eea05902d9bae3c0082" compoundref="api-cuda_8h" startline="36">FTIT_PTRTYPE_CPU</references>
        <references refid="api-cuda_8h_1a86980048ebdb2b691b357773e7cf4e2da31a7e4d2c16a4fee5c18be02b9545f70" compoundref="api-cuda_8h" startline="37">FTIT_PTRTYPE_GPU</references>
        <references refid="structFTIT__ptrinfo_1a823910ebd4aee09f6beda01e6c31cacb" compoundref="api-cuda_8h" startline="46">FTIT_ptrinfo::type</references>
      </memberdef>
      <memberdef kind="function" id="api-cuda_8c_1a544c5bac3dc54ef351d1f37a8dcde9d3" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FTI_copy_from_device</definition>
        <argsstring>(void *dst, const void *src, size_t count, FTIT_execution *exec)</argsstring>
        <name>FTI_copy_from_device</name>
        <param>
          <type>void *</type>
          <declname>dst</declname>
        </param>
        <param>
          <type>const void *</type>
          <declname>src</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>count</declname>
        </param>
        <param>
          <type><ref refid="structFTIT__execution" kindref="compound">FTIT_execution</ref> *</type>
          <declname>exec</declname>
        </param>
        <briefdescription>
<para>It copies data from GPU to CPU. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>dst</parametername>
</parameternamelist>
<parameterdescription>
<para>CPU destination memory address. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>src</parametername>
</parameternamelist>
<parameterdescription>
<para>GPU source memory address. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>count</parametername>
</parameternamelist>
<parameterdescription>
<para>Size in bytes to copy. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>ptrInfo</parametername>
</parameternamelist>
<parameterdescription>
<para>Information of the src pointer. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>exec</parametername>
</parameternamelist>
<parameterdescription>
<para>Information of this execution. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>integer FTI_SCES if successful.</para>
</simplesect>
This function copies count bytes from the GPU memory area pointed to by src to the CPU memory area pointed to by dst. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api-cuda.c" line="71" column="5" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api-cuda.c" bodystart="71" bodyend="78"/>
        <references refid="fti-intern_8h_1a299db837571db9e73119d159b3428fe0" compoundref="fti-intern_8h" startline="65">FTI_DBUG</references>
        <references refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" compoundref="api_8c" startline="2548" endline="2576">FTI_Print</references>
        <references refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" compoundref="fti_8h" startline="18">FTI_SCES</references>
      </memberdef>
      <memberdef kind="function" id="api-cuda_8c_1a3c02d6e2cb35d50d9bbfbbac490e65e1" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FTI_copy_to_device</definition>
        <argsstring>(void *dst, const void *src, size_t count, FTIT_execution *exec)</argsstring>
        <name>FTI_copy_to_device</name>
        <param>
          <type>void *</type>
          <declname>dst</declname>
        </param>
        <param>
          <type>const void *</type>
          <declname>src</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>count</declname>
        </param>
        <param>
          <type><ref refid="structFTIT__execution" kindref="compound">FTIT_execution</ref> *</type>
          <declname>exec</declname>
        </param>
        <briefdescription>
<para>It copies data from CPU to GPU. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>dst</parametername>
</parameternamelist>
<parameterdescription>
<para>GPU destination memory address. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>src</parametername>
</parameternamelist>
<parameterdescription>
<para>CPU source memory address. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>count</parametername>
</parameternamelist>
<parameterdescription>
<para>Size in bytes to copy. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>ptrInfo</parametername>
</parameternamelist>
<parameterdescription>
<para>Information of the dst pointer. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>exec</parametername>
</parameternamelist>
<parameterdescription>
<para>Information of this execution. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>integer FTI_SCES if successful.</para>
</simplesect>
This function copies count bytes from the CPU memory area pointed to by src to the GPU memory area pointed to by dst. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api-cuda.c" line="95" column="5" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api-cuda.c" bodystart="95" bodyend="102"/>
        <references refid="fti-intern_8h_1a299db837571db9e73119d159b3428fe0" compoundref="fti-intern_8h" startline="65">FTI_DBUG</references>
        <references refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" compoundref="api_8c" startline="2548" endline="2576">FTI_Print</references>
        <references refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" compoundref="fti_8h" startline="18">FTI_SCES</references>
      </memberdef>
      <memberdef kind="function" id="api-cuda_8c_1a6e6f5a7d5c8cb196a24781dd48e56fd7" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FTI_TransferDeviceMemToFileAsync</definition>
        <argsstring>(FTIT_dataset *FTI_Data, FTIT_fwritefunc fwritefunc, void *opaque)</argsstring>
        <name>FTI_TransferDeviceMemToFileAsync</name>
        <param>
          <type><ref refid="structFTIT__dataset" kindref="compound">FTIT_dataset</ref> *</type>
          <declname>FTI_Data</declname>
        </param>
        <param>
          <type><ref refid="api-cuda_8h_1af93c5d2661f8e8cf11b38916a4893dd3" kindref="member">FTIT_fwritefunc</ref></type>
          <declname>fwritefunc</declname>
        </param>
        <param>
          <type>void *</type>
          <declname>opaque</declname>
        </param>
        <briefdescription>
<para>Streaming data from GPU to storage. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>FTI_Data</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the dataset to be copied. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>fwritefunc</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the function that perform file writes. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>opaque</parametername>
</parameternamelist>
<parameterdescription>
<para>Additional data to be passed to fwritefunc. <linebreak/>
 </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>integer FTI_SCES if successful.</para>
</simplesect>
This function streams (pipelines) data from the GPU memory to the storage. The actual writes to the storage are performed by fwritefunc. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api-cuda.c" line="116" column="5" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api-cuda.c" bodystart="116" bodyend="148"/>
      </memberdef>
      <memberdef kind="function" id="api-cuda_8c_1aecd6f1d36917ef0320232d64dcdfc700" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FTI_InitPrefetcher</definition>
        <argsstring>(FTIT_data_prefetch *dfls)</argsstring>
        <name>FTI_InitPrefetcher</name>
        <param>
          <type><ref refid="structFTIT__data__prefetch" kindref="compound">FTIT_data_prefetch</ref> *</type>
          <declname>dfls</declname>
        </param>
        <briefdescription>
<para>Initializes a Prefetcher. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>A</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer to the Prefetcher struct </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>integer FTI_SCES if successful.</para>
</simplesect>
This function initializes the streaming procedure for data in the GPU. If the data re in the GPU side it also performs the first request to the GPU to copy data. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api-cuda.c" line="161" column="5" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api-cuda.c" bodystart="161" bodyend="188"/>
        <references refid="api-cuda_8c_1a7be887a2ca0a258cf6b368d32fd87487" compoundref="api-cuda_8c" startline="11">bufferSize</references>
        <references refid="structFTIT__data__prefetch_1a21dc6418d75e7775ba744cc83ce55a9d" compoundref="api-cuda_8h" startline="52">FTIT_data_prefetch::dptr</references>
        <references refid="structFTIT__data__prefetch_1a0946e03f7a88ce6dec11e934192c5c71" compoundref="api-cuda_8h" startline="57">FTIT_data_prefetch::end</references>
        <references refid="structFTIT__data__prefetch_1abef53fc0dc2feefada7ec6127549d631" compoundref="api-cuda_8h" startline="54">FTIT_data_prefetch::fetchSize</references>
        <references refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" compoundref="fti_8h" startline="12">FTI_BUFS</references>
        <references refid="fti-intern_8h_1a299db837571db9e73119d159b3428fe0" compoundref="fti-intern_8h" startline="65">FTI_DBUG</references>
        <references refid="api-cuda_8c_1abb1ca3c8e8cbff17fdcba133ca6a344d" compoundref="api-cuda_8c" startline="279" endline="288">FTI_DestroyDevices</references>
        <references refid="api-cuda_8c_1acd3640ea0b47f0f4b34b9e11294290e1" compoundref="api-cuda_8c" startline="257" endline="268">FTI_InitDevices</references>
        <references refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" compoundref="api_8c" startline="2548" endline="2576">FTI_Print</references>
        <references refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" compoundref="fti_8h" startline="18">FTI_SCES</references>
        <references refid="tools_8c_1a950803008f7cef4892fbba9b2069928e" compoundref="tools_8c" startline="335" endline="349">FTI_Try</references>
        <references refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" compoundref="fti-intern_8h" startline="59">FTI_WARN</references>
        <references refid="api-cuda_8c_1aa95ffe47f6277da792e9454674c5c23a" compoundref="api-cuda_8c" startline="10">hostBuffers</references>
        <references refid="structFTIT__data__prefetch_1abc7c71fb7a3b77aaf2ed7384161ab4b2" compoundref="api-cuda_8h" startline="56">FTIT_data_prefetch::Id</references>
        <references refid="structFTIT__data__prefetch_1a72090119f611e4fbfd88cf7375ecb5db" compoundref="api-cuda_8h" startline="55">FTIT_data_prefetch::isDevice</references>
        <references refid="api-cuda_8h_1a74e75242132eaabbc1c512488a135926" compoundref="api-cuda_8h" startline="31">MIN</references>
        <references refid="structFTIT__data__prefetch_1afbe07d403fda95c554a9975cc90a37cb" compoundref="api-cuda_8h" startline="58">FTIT_data_prefetch::requestedData</references>
        <references refid="structFTIT__data__prefetch_1a1746b75b9c110d779501192dd55beba5" compoundref="api-cuda_8h" startline="53">FTIT_data_prefetch::totalBytesToFetch</references>
      </memberdef>
      <memberdef kind="function" id="api-cuda_8c_1a6be5f3795ebc10603244ef0d60594611" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FTI_getPrefetchedData</definition>
        <argsstring>(FTIT_data_prefetch *dfls, size_t *size, unsigned char **fetchedData)</argsstring>
        <name>FTI_getPrefetchedData</name>
        <param>
          <type><ref refid="structFTIT__data__prefetch" kindref="compound">FTIT_data_prefetch</ref> *</type>
          <declname>dfls</declname>
        </param>
        <param>
          <type>size_t *</type>
          <declname>size</declname>
        </param>
        <param>
          <type>unsigned char **</type>
          <declname>fetchedData</declname>
        </param>
        <briefdescription>
<para>Gets gpu-fetched data. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>dfls</parametername>
</parameternamelist>
<parameterdescription>
<para>A pointer to the Prefetcher struct </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>size</parametername>
</parameternamelist>
<parameterdescription>
<para>the amount of data in bytes copied from the gpu to the cpu </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>fetchData</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer pointing to the data fetched. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>integer FTI_SCES if successful.</para>
</simplesect>
This data returns a pointer to data copied from the GPU side. It also requests more data from the GPU side. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api-cuda.c" line="202" column="5" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api-cuda.c" bodystart="202" bodyend="236"/>
        <references refid="structFTIT__data__prefetch_1a21dc6418d75e7775ba744cc83ce55a9d" compoundref="api-cuda_8h" startline="52">FTIT_data_prefetch::dptr</references>
        <references refid="structFTIT__data__prefetch_1a0946e03f7a88ce6dec11e934192c5c71" compoundref="api-cuda_8h" startline="57">FTIT_data_prefetch::end</references>
        <references refid="structFTIT__data__prefetch_1abef53fc0dc2feefada7ec6127549d631" compoundref="api-cuda_8h" startline="54">FTIT_data_prefetch::fetchSize</references>
        <references refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" compoundref="fti_8h" startline="18">FTI_SCES</references>
        <references refid="api-cuda_8c_1aa95ffe47f6277da792e9454674c5c23a" compoundref="api-cuda_8c" startline="10">hostBuffers</references>
        <references refid="structFTIT__data__prefetch_1abc7c71fb7a3b77aaf2ed7384161ab4b2" compoundref="api-cuda_8h" startline="56">FTIT_data_prefetch::Id</references>
        <references refid="structFTIT__data__prefetch_1a72090119f611e4fbfd88cf7375ecb5db" compoundref="api-cuda_8h" startline="55">FTIT_data_prefetch::isDevice</references>
        <references refid="api-cuda_8h_1a74e75242132eaabbc1c512488a135926" compoundref="api-cuda_8h" startline="31">MIN</references>
        <references refid="structFTIT__data__prefetch_1afbe07d403fda95c554a9975cc90a37cb" compoundref="api-cuda_8h" startline="58">FTIT_data_prefetch::requestedData</references>
        <references refid="structFTIT__data__prefetch_1a1746b75b9c110d779501192dd55beba5" compoundref="api-cuda_8h" startline="53">FTIT_data_prefetch::totalBytesToFetch</references>
      </memberdef>
      <memberdef kind="function" id="api-cuda_8c_1aea1dfacf72335a4e81cc109ea9aa7c0b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FTI_destroyPrefetcher</definition>
        <argsstring>(FTIT_data_prefetch *dfls)</argsstring>
        <name>FTI_destroyPrefetcher</name>
        <param>
          <type><ref refid="structFTIT__data__prefetch" kindref="compound">FTIT_data_prefetch</ref> *</type>
          <declname>dfls</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api-cuda.c" line="238" column="5" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api-cuda.c" bodystart="238" bodyend="244"/>
        <references refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" compoundref="fti_8h" startline="18">FTI_SCES</references>
      </memberdef>
      <memberdef kind="function" id="api-cuda_8c_1acd3640ea0b47f0f4b34b9e11294290e1" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FTI_InitDevices</definition>
        <argsstring>(int HostBuffSize)</argsstring>
        <name>FTI_InitDevices</name>
        <param>
          <type>int</type>
          <declname>HostBuffSize</declname>
        </param>
        <briefdescription>
<para>Allocates Host buffers which will be used for asynchronous communication with the GPU. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>HostBuffSize</parametername>
</parameternamelist>
<parameterdescription>
<para>Size in bytes of each buffer. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>integer FTI_SCES if successful.</para>
</simplesect>
Allocates 2 host buffers which are going to be used for asynchronous communication with the GPU. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api-cuda.c" line="257" column="5" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api-cuda.c" bodystart="257" bodyend="268"/>
        <references refid="api-cuda_8c_1a7be887a2ca0a258cf6b368d32fd87487" compoundref="api-cuda_8c" startline="11">bufferSize</references>
        <references refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" compoundref="fti_8h" startline="12">FTI_BUFS</references>
        <references refid="fti-intern_8h_1a26a561f0e03eec3d15541c85a2a21ffd" compoundref="fti-intern_8h" startline="63">FTI_INFO</references>
        <references refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" compoundref="api_8c" startline="2548" endline="2576">FTI_Print</references>
        <references refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" compoundref="fti_8h" startline="18">FTI_SCES</references>
        <references refid="api-cuda_8c_1aa95ffe47f6277da792e9454674c5c23a" compoundref="api-cuda_8c" startline="10">hostBuffers</references>
      </memberdef>
      <memberdef kind="function" id="api-cuda_8c_1abb1ca3c8e8cbff17fdcba133ca6a344d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FTI_DestroyDevices</definition>
        <argsstring>()</argsstring>
        <name>FTI_DestroyDevices</name>
        <briefdescription>
<para>De-allocates Host buffers which will be used for asynchronous communication with the GPU. </para>
        </briefdescription>
        <detaileddescription>
<para><simplesect kind="return"><para>integer FTI_SCES if successful.</para>
</simplesect>
De-Allocates 2 host buffers which are going to be used for asynchronous communication with the GPU. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api-cuda.c" line="279" column="5" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api-cuda.c" bodystart="279" bodyend="288"/>
        <references refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" compoundref="fti_8h" startline="18">FTI_SCES</references>
        <references refid="api-cuda_8c_1aa95ffe47f6277da792e9454674c5c23a" compoundref="api-cuda_8c" startline="10">hostBuffers</references>
      </memberdef>
      <memberdef kind="function" id="api-cuda_8c_1aa25ca3090fb1052359f6a5fa4b724082" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FTI_TransferFileToDeviceAsync</definition>
        <argsstring>(FILE *fd, void *dptr, int numBytes)</argsstring>
        <name>FTI_TransferFileToDeviceAsync</name>
        <param>
          <type>FILE *</type>
          <declname>fd</declname>
        </param>
        <param>
          <type>void *</type>
          <declname>dptr</declname>
        </param>
        <param>
          <type>int</type>
          <declname>numBytes</declname>
        </param>
        <briefdescription>
<para>Copies data from a file to the GPU asynchronously. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>fd</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the file </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>dptr</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the data </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>numBytes</parametername>
</parameternamelist>
<parameterdescription>
<para>number of bytes to be written </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>integer FTI_SCES if successful.</para>
</simplesect>
Uses 2 streams to copy data from a file to the GPU device memory. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api-cuda.c" line="303" column="5" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api-cuda.c" bodystart="303" bodyend="339"/>
        <references refid="api-cuda_8c_1a7be887a2ca0a258cf6b368d32fd87487" compoundref="api-cuda_8c" startline="11">bufferSize</references>
        <references refid="fti-intern_8h_1a5cb1252ae17ef4ac13b3dbe5a8b1ab13" compoundref="fti-intern_8h" startline="57">FTI_EROR</references>
        <references refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" compoundref="fti_8h" startline="20">FTI_NSCS</references>
        <references refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" compoundref="api_8c" startline="2548" endline="2576">FTI_Print</references>
        <references refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" compoundref="fti_8h" startline="18">FTI_SCES</references>
        <references refid="api-cuda_8c_1aa95ffe47f6277da792e9454674c5c23a" compoundref="api-cuda_8c" startline="10">hostBuffers</references>
        <references refid="api-cuda_8h_1a74e75242132eaabbc1c512488a135926" compoundref="api-cuda_8h" startline="31">MIN</references>
      </memberdef>
      <memberdef kind="function" id="api-cuda_8c_1a5a897085347de12b9f622375b73c514b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>size_t</type>
        <definition>size_t FTI_getHostBuffSize</definition>
        <argsstring>()</argsstring>
        <name>FTI_getHostBuffSize</name>
        <briefdescription>
<para>Returns the size of each host buffer in bytes. </para>
        </briefdescription>
        <detaileddescription>
<para><simplesect kind="return"><para>integer The size of the buffer.</para>
</simplesect>
Returns the size of each host buffer in bytes </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api-cuda.c" line="350" column="8" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api-cuda.c" bodystart="350" bodyend="352"/>
        <references refid="api-cuda_8c_1a7be887a2ca0a258cf6b368d32fd87487" compoundref="api-cuda_8c" startline="11">bufferSize</references>
      </memberdef>
      <memberdef kind="function" id="api-cuda_8c_1a62b401eaf98a6c666ca0f1ac0467b239" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="api-cuda_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref> *</type>
        <definition>BYTE* FTI_getHostBuffer</definition>
        <argsstring>(int id)</argsstring>
        <name>FTI_getHostBuffer</name>
        <param>
          <type>int</type>
          <declname>id</declname>
        </param>
        <briefdescription>
<para>Returns the pointer of a specific host buffer. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>id</parametername>
</parameternamelist>
<parameterdescription>
<para>The id of the host buffer </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>pointer To the location of the data buffer.</para>
</simplesect>
Returns the pointer of a specific host buffer in bytes </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api-cuda.c" line="365" column="6" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api-cuda.c" bodystart="365" bodyend="367"/>
        <references refid="api-cuda_8c_1aa95ffe47f6277da792e9454674c5c23a" compoundref="api-cuda_8c" startline="10">hostBuffers</references>
      </memberdef>
      <memberdef kind="function" id="api-cuda_8c_1a5f16ed2832ece299208ea9c5c0b2c12f" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FTI_copy_to_device_async</definition>
        <argsstring>(void *dst, const void *src, size_t count)</argsstring>
        <name>FTI_copy_to_device_async</name>
        <param>
          <type>void *</type>
          <declname>dst</declname>
        </param>
        <param>
          <type>const void *</type>
          <declname>src</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>count</declname>
        </param>
        <briefdescription>
<para>Copies asynchronously memory from host to device. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>dst</parametername>
</parameternamelist>
<parameterdescription>
<para>Memory location to copy data to. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>src</parametername>
</parameternamelist>
<parameterdescription>
<para>Memory location to copy data from. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>count</parametername>
</parameternamelist>
<parameterdescription>
<para>Number of bytes to copy </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>integer FTI_SCES on success.</para>
</simplesect>
Copies data from a CPU memory Location to a GPU memory location. Attention neither src or dest can be de allocated until the transaction is finished. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api-cuda.c" line="383" column="5" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api-cuda.c" bodystart="383" bodyend="389"/>
        <references refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" compoundref="fti_8h" startline="18">FTI_SCES</references>
      </memberdef>
      <memberdef kind="function" id="api-cuda_8c_1afd0a0ee64043aed23e2dd216db7305ce" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FTI_device_sync</definition>
        <argsstring>()</argsstring>
        <name>FTI_device_sync</name>
        <briefdescription>
<para>Synchronizes the devices. </para>
        </briefdescription>
        <detaileddescription>
<para><simplesect kind="return"><para>integer FTI_SCES on success. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api-cuda.c" line="399" column="5" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api-cuda.c" bodystart="399" bodyend="405"/>
        <references refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" compoundref="fti_8h" startline="18">FTI_SCES</references>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="preprocessor">#include<sp/>&quot;<ref refid="interface_8h" kindref="compound">interface.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>GPUSUPPORT</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;cuda_runtime_api.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal">cudaStream_t<sp/>Gstream;<sp/></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight></codeline>
<codeline lineno="10" refid="api-cuda_8c_1aa95ffe47f6277da792e9454674c5c23a" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="api-cuda_8c_1aa95ffe47f6277da792e9454674c5c23a" kindref="member">hostBuffers</ref>[2];</highlight></codeline>
<codeline lineno="11" refid="api-cuda_8c_1a7be887a2ca0a258cf6b368d32fd87487" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="api-cuda_8c_1a7be887a2ca0a258cf6b368d32fd87487" kindref="member">bufferSize</ref>;</highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="25"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="26" refid="api-cuda_8h_1a77a43dab41fd5721fa4581af47413f4c" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="api-cuda_8c_1a77a43dab41fd5721fa4581af47413f4c" kindref="member">FTI_get_pointer_info</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*ptr,<sp/><ref refid="structFTIT__ptrinfo" kindref="compound">FTIT_ptrinfo</ref><sp/>*ptrInfo)</highlight></codeline>
<codeline lineno="27"><highlight class="normal">{</highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>GPUSUPPORT</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="29"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>message[<ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>];</highlight></codeline>
<codeline lineno="30"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal">cudaPointerAttributes<sp/>attributes;</highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight></codeline>
<codeline lineno="32"><highlight class="normal"><sp/><sp/><sp/><sp/>cudaError_t<sp/>err<sp/>=<sp/>cudaPointerGetAttributes(&amp;attributes,<sp/>ptr);</highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight></codeline>
<codeline lineno="34"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(err<sp/>!=<sp/>cudaSuccess<sp/>&amp;&amp;<sp/>err<sp/>!=<sp/>cudaErrorInvalidValue)<sp/>{</highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sprintf(message,<sp/></highlight><highlight class="stringliteral">&quot;Cuda<sp/>error<sp/>%d<sp/>%s::<sp/>%s&quot;</highlight><highlight class="normal">,<sp/>__LINE__,<sp/>__func__,<sp/>cudaGetErrorString(err));</highlight></codeline>
<codeline lineno="36"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(message,<sp/><ref refid="fti-intern_8h_1a5cb1252ae17ef4ac13b3dbe5a8b1ab13" kindref="member">FTI_EROR</ref>);</highlight></codeline>
<codeline lineno="37"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="38"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight></codeline>
<codeline lineno="40"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(err<sp/>==<sp/>cudaErrorInvalidValue<sp/>||<sp/>attributes.type==<sp/>cudaMemoryTypeHost<sp/>||<sp/>attributes.type<sp/>==<sp/>cudaMemoryTypeManaged)<sp/>{</highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ptrInfo-&gt;<ref refid="structFTIT__ptrinfo_1a823910ebd4aee09f6beda01e6c31cacb" kindref="member">type</ref><sp/>=<sp/><ref refid="api-cuda_8h_1a86980048ebdb2b691b357773e7cf4e2da29018ea9dff75eea05902d9bae3c0082" kindref="member">FTIT_PTRTYPE_CPU</ref>;</highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sprintf(message,<sp/></highlight><highlight class="stringliteral">&quot;Ptr<sp/>%p<sp/>is<sp/>a<sp/>CPU<sp/>pointer&quot;</highlight><highlight class="normal">,<sp/>ptr);</highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ptrInfo-&gt;<ref refid="structFTIT__ptrinfo_1a823910ebd4aee09f6beda01e6c31cacb" kindref="member">type</ref><sp/>=<sp/><ref refid="api-cuda_8h_1a86980048ebdb2b691b357773e7cf4e2da31a7e4d2c16a4fee5c18be02b9545f70" kindref="member">FTIT_PTRTYPE_GPU</ref>;</highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ptrInfo-&gt;<ref refid="structFTIT__ptrinfo_1a1cadbdc42a8942d807b500b9cb2fe78f" kindref="member">deviceID</ref><sp/>=<sp/>attributes.device;</highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sprintf(message,<sp/></highlight><highlight class="stringliteral">&quot;Ptr<sp/>%p<sp/>is<sp/>a<sp/>GPU<sp/>pointer&quot;</highlight><highlight class="normal">,<sp/>ptr);</highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="49"><highlight class="normal"></highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(message,<sp/><ref refid="fti-intern_8h_1a299db837571db9e73119d159b3428fe0" kindref="member">FTI_DBUG</ref>);</highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/><sp/><sp/>cudaGetLastError();</highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight></codeline>
<codeline lineno="53"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/><sp/><sp/><sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="55"><highlight class="normal">}</highlight></codeline>
<codeline lineno="56"><highlight class="normal"></highlight></codeline>
<codeline lineno="57"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="70"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="71" refid="api-cuda_8h_1a544c5bac3dc54ef351d1f37a8dcde9d3" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="api-cuda_8c_1a544c5bac3dc54ef351d1f37a8dcde9d3" kindref="member">FTI_copy_from_device</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*dst,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*src,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>count,<sp/><sp/><ref refid="structFTIT__execution" kindref="compound">FTIT_execution</ref><sp/>*exec)</highlight></codeline>
<codeline lineno="72"><highlight class="normal">{</highlight></codeline>
<codeline lineno="73"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>GPUSUPPORT</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/>CUDA_ERROR_CHECK(cudaMemcpy(dst,<sp/>src,<sp/>count,<sp/>cudaMemcpyDeviceToHost));</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;Copied<sp/>data<sp/>from<sp/>GPU&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a299db837571db9e73119d159b3428fe0" kindref="member">FTI_DBUG</ref>);</highlight></codeline>
<codeline lineno="76"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="78"><highlight class="normal">}</highlight></codeline>
<codeline lineno="79"><highlight class="normal"></highlight></codeline>
<codeline lineno="80"><highlight class="normal"></highlight></codeline>
<codeline lineno="81"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="94"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="95" refid="api-cuda_8h_1a3c02d6e2cb35d50d9bbfbbac490e65e1" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="api-cuda_8c_1a3c02d6e2cb35d50d9bbfbbac490e65e1" kindref="member">FTI_copy_to_device</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*dst,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*src,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>count,<sp/><ref refid="structFTIT__execution" kindref="compound">FTIT_execution</ref><sp/>*exec)</highlight></codeline>
<codeline lineno="96"><highlight class="normal">{</highlight></codeline>
<codeline lineno="97"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>GPUSUPPORT</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/>CUDA_ERROR_CHECK(cudaMemcpy(dst,<sp/>src,<sp/>count,<sp/>cudaMemcpyHostToDevice));</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;Copied<sp/>data<sp/>to<sp/>GPU&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a299db837571db9e73119d159b3428fe0" kindref="member">FTI_DBUG</ref>);</highlight></codeline>
<codeline lineno="100"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="102"><highlight class="normal">}</highlight></codeline>
<codeline lineno="103"><highlight class="normal"></highlight></codeline>
<codeline lineno="104"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="115"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="116" refid="api-cuda_8h_1a6e6f5a7d5c8cb196a24781dd48e56fd7" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="api-cuda_8c_1a6e6f5a7d5c8cb196a24781dd48e56fd7" kindref="member">FTI_TransferDeviceMemToFileAsync</ref>(<ref refid="structFTIT__dataset" kindref="compound">FTIT_dataset</ref><sp/>*FTI_Data,<sp/><sp/><ref refid="api-cuda_8h_1af93c5d2661f8e8cf11b38916a4893dd3" kindref="member">FTIT_fwritefunc</ref><sp/>fwritefunc,<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*opaque)</highlight></codeline>
<codeline lineno="117"><highlight class="normal">{</highlight></codeline>
<codeline lineno="118"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>GPUSUPPORT</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;Piplining<sp/>GPU<sp/>-&gt;<sp/>Storage&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a299db837571db9e73119d159b3428fe0" kindref="member">FTI_DBUG</ref>);</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Data-&gt;<ref refid="structFTIT__dataset_1a112f9319765938eba3339d86c0e140c9" kindref="member">size</ref><sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="122"><highlight class="normal"></highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>res;</highlight></codeline>
<codeline lineno="124"><highlight class="normal"></highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structFTIT__data__prefetch" kindref="compound">FTIT_data_prefetch</ref><sp/>prefetcher;</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/>prefetcher.<ref refid="structFTIT__data__prefetch_1abef53fc0dc2feefada7ec6127549d631" kindref="member">fetchSize</ref><sp/>=<sp/><ref refid="api-cuda_8c_1a7be887a2ca0a258cf6b368d32fd87487" kindref="member">bufferSize</ref>;<sp/></highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/>prefetcher.<ref refid="structFTIT__data__prefetch_1a1746b75b9c110d779501192dd55beba5" kindref="member">totalBytesToFetch</ref><sp/>=<sp/>FTI_Data-&gt;<ref refid="structFTIT__dataset_1a112f9319765938eba3339d86c0e140c9" kindref="member">size</ref>;</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/>prefetcher.<ref refid="structFTIT__data__prefetch_1a72090119f611e4fbfd88cf7375ecb5db" kindref="member">isDevice</ref><sp/>=<sp/>FTI_Data-&gt;<ref refid="structFTIT__dataset_1af5787410c1a17d552c402533a95afebd" kindref="member">isDevicePtr</ref>;</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/>prefetcher.<ref refid="structFTIT__data__prefetch_1a21dc6418d75e7775ba744cc83ce55a9d" kindref="member">dptr</ref><sp/>=<sp/>FTI_Data-&gt;<ref refid="structFTIT__dataset_1a02c90a2a92a7de7cc2407c228053d173" kindref="member">devicePtr</ref>;</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="api-cuda_8c_1aecd6f1d36917ef0320232d64dcdfc700" kindref="member">FTI_InitPrefetcher</ref>(&amp;prefetcher);</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>bytesToWrite;</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*basePtr<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="133"><highlight class="normal"></highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/><ref refid="tools_8c_1a950803008f7cef4892fbba9b2069928e" kindref="member">FTI_Try</ref><sp/>(<sp/><ref refid="api-cuda_8c_1a6be5f3795ebc10603244ef0d60594611" kindref="member">FTI_getPrefetchedData</ref>(&amp;prefetcher,&amp;bytesToWrite,<sp/>&amp;basePtr),<sp/></highlight><highlight class="stringliteral">&quot;Fetching<sp/>next<sp/>memory<sp/>block<sp/>from<sp/>memory&quot;</highlight><highlight class="normal">)<sp/>!=<sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>){</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(basePtr){</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((res<sp/>=<sp/>fwritefunc(basePtr,<sp/>bytesToWrite,<sp/>opaque))<sp/>!=<sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>)</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>res;</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>basePtr<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/><ref refid="tools_8c_1a950803008f7cef4892fbba9b2069928e" kindref="member">FTI_Try</ref><sp/>(<sp/><ref refid="api-cuda_8c_1a6be5f3795ebc10603244ef0d60594611" kindref="member">FTI_getPrefetchedData</ref>(&amp;prefetcher,&amp;bytesToWrite,<sp/>&amp;basePtr),<sp/></highlight><highlight class="stringliteral">&quot;Fetching<sp/>next<sp/>memory<sp/>block<sp/>from<sp/>memory&quot;</highlight><highlight class="normal">)<sp/>!=<sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>)</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="144"><highlight class="normal"></highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="api-cuda_8c_1aea1dfacf72335a4e81cc109ea9aa7c0b" kindref="member">FTI_destroyPrefetcher</ref>(&amp;prefetcher);</highlight></codeline>
<codeline lineno="146"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="148"><highlight class="normal">}</highlight></codeline>
<codeline lineno="149"><highlight class="normal"></highlight></codeline>
<codeline lineno="150"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="160"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="161" refid="api-cuda_8h_1aecd6f1d36917ef0320232d64dcdfc700" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="api-cuda_8c_1aecd6f1d36917ef0320232d64dcdfc700" kindref="member">FTI_InitPrefetcher</ref>(<ref refid="structFTIT__data__prefetch" kindref="compound">FTIT_data_prefetch</ref><sp/>*dfls){</highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/>dfls-&gt;<ref refid="structFTIT__data__prefetch_1abc7c71fb7a3b77aaf2ed7384161ab4b2" kindref="member">Id</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/>dfls-&gt;<ref refid="structFTIT__data__prefetch_1a0946e03f7a88ce6dec11e934192c5c71" kindref="member">end</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>str[<ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>];</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/>sprintf(str,</highlight><highlight class="stringliteral">&quot;FTI_InitPrefetcer::<sp/>I<sp/>am<sp/>Initializing<sp/>GPU<sp/>Prefetcher,<sp/>isGPU:<sp/>%d,<sp/>GPU<sp/>buffer<sp/>Size<sp/>%ld<sp/>Fetch<sp/>Size<sp/>is<sp/>%ld&quot;</highlight><highlight class="normal">,<sp/>dfls-&gt;<ref refid="structFTIT__data__prefetch_1a72090119f611e4fbfd88cf7375ecb5db" kindref="member">isDevice</ref>,<sp/><ref refid="api-cuda_8c_1a7be887a2ca0a258cf6b368d32fd87487" kindref="member">bufferSize</ref><sp/>,<sp/>dfls-&gt;<ref refid="structFTIT__data__prefetch_1abef53fc0dc2feefada7ec6127549d631" kindref="member">fetchSize</ref>);<sp/></highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(str,<ref refid="fti-intern_8h_1a299db837571db9e73119d159b3428fe0" kindref="member">FTI_DBUG</ref>);</highlight></codeline>
<codeline lineno="167"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>GPUSUPPORT</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/>dfls-&gt;<ref refid="structFTIT__data__prefetch_1abc7c71fb7a3b77aaf2ed7384161ab4b2" kindref="member">Id</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dfls-&gt;<ref refid="structFTIT__data__prefetch_1a72090119f611e4fbfd88cf7375ecb5db" kindref="member">isDevice</ref>){</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CUDA_ERROR_CHECK(cudaStreamCreate(&amp;(dfls-&gt;streams[0])));</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CUDA_ERROR_CHECK(cudaStreamCreate(&amp;(dfls-&gt;streams[1])));</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>copy_size<sp/>=<sp/><ref refid="api-cuda_8h_1a74e75242132eaabbc1c512488a135926" kindref="member">MIN</ref>(dfls-&gt;<ref refid="structFTIT__data__prefetch_1abef53fc0dc2feefada7ec6127549d631" kindref="member">fetchSize</ref>,<sp/>dfls-&gt;<ref refid="structFTIT__data__prefetch_1a1746b75b9c110d779501192dd55beba5" kindref="member">totalBytesToFetch</ref>);</highlight></codeline>
<codeline lineno="173"><highlight class="normal"></highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>copy_size<sp/>&gt;<sp/><ref refid="api-cuda_8c_1a7be887a2ca0a258cf6b368d32fd87487" kindref="member">bufferSize</ref><sp/>){</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;I<sp/>am<sp/>requesting<sp/>more<sp/>bytes<sp/>than<sp/>the<sp/>ones<sp/>reserved<sp/>for<sp/>GPU<sp/>usage&quot;</highlight><highlight class="normal">,<ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;I<sp/>will<sp/>reallocate<sp/>the<sp/>address<sp/>space<sp/>to<sp/>match<sp/>the<sp/>new<sp/>size&quot;</highlight><highlight class="normal">,<ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tools_8c_1a950803008f7cef4892fbba9b2069928e" kindref="member">FTI_Try</ref>(<ref refid="api-cuda_8c_1abb1ca3c8e8cbff17fdcba133ca6a344d" kindref="member">FTI_DestroyDevices</ref>(),<sp/></highlight><highlight class="stringliteral">&quot;Destroying<sp/>allocated<sp/>host<sp/>memory<sp/>for<sp/>gpu<sp/>tranfers&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tools_8c_1a950803008f7cef4892fbba9b2069928e" kindref="member">FTI_Try</ref>(<ref refid="api-cuda_8c_1acd3640ea0b47f0f4b34b9e11294290e1" kindref="member">FTI_InitDevices</ref>(copy_size),<sp/></highlight><highlight class="stringliteral">&quot;Allocating<sp/>larger<sp/>host<sp/>memory&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api-cuda_8c_1a7be887a2ca0a258cf6b368d32fd87487" kindref="member">bufferSize</ref><sp/>=<sp/>copy_size;</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CUDA_ERROR_CHECK(cudaMemcpyAsync(<ref refid="api-cuda_8c_1aa95ffe47f6277da792e9454674c5c23a" kindref="member">hostBuffers</ref>[dfls-&gt;<ref refid="structFTIT__data__prefetch_1abc7c71fb7a3b77aaf2ed7384161ab4b2" kindref="member">Id</ref>],<sp/>dfls-&gt;<ref refid="structFTIT__data__prefetch_1a21dc6418d75e7775ba744cc83ce55a9d" kindref="member">dptr</ref>,<sp/>copy_size,<sp/>cudaMemcpyDeviceToHost,<sp/>dfls-&gt;streams[dfls-&gt;<ref refid="structFTIT__data__prefetch_1abc7c71fb7a3b77aaf2ed7384161ab4b2" kindref="member">Id</ref>]<sp/>));</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dfls-&gt;<ref refid="structFTIT__data__prefetch_1a21dc6418d75e7775ba744cc83ce55a9d" kindref="member">dptr</ref><sp/>+=<sp/>copy_size;</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dfls-&gt;<ref refid="structFTIT__data__prefetch_1a1746b75b9c110d779501192dd55beba5" kindref="member">totalBytesToFetch</ref>-=copy_size;</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dfls-&gt;<ref refid="structFTIT__data__prefetch_1afbe07d403fda95c554a9975cc90a37cb" kindref="member">requestedData</ref><sp/>=<sp/>copy_size;</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="186"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="188"><highlight class="normal">}</highlight></codeline>
<codeline lineno="189"><highlight class="normal"></highlight></codeline>
<codeline lineno="190"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="201"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="202" refid="api-cuda_8h_1a6be5f3795ebc10603244ef0d60594611" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="api-cuda_8c_1a6be5f3795ebc10603244ef0d60594611" kindref="member">FTI_getPrefetchedData</ref>(<sp/><ref refid="structFTIT__data__prefetch" kindref="compound">FTIT_data_prefetch</ref><sp/>*dfls,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>*size,<sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>**fetchedData<sp/>){</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dfls-&gt;<ref refid="structFTIT__data__prefetch_1a0946e03f7a88ce6dec11e934192c5c71" kindref="member">end</ref><sp/>){</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*fetchedData<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="207"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>GPUSUPPORT</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>prevId<sp/>=<sp/>dfls-&gt;<ref refid="structFTIT__data__prefetch_1abc7c71fb7a3b77aaf2ed7384161ab4b2" kindref="member">Id</ref>;<sp/></highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/>dfls-&gt;<ref refid="structFTIT__data__prefetch_1abc7c71fb7a3b77aaf2ed7384161ab4b2" kindref="member">Id</ref><sp/><sp/>=<sp/>(prevId<sp/>+<sp/>1)%2;</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>dfls-&gt;<ref refid="structFTIT__data__prefetch_1a72090119f611e4fbfd88cf7375ecb5db" kindref="member">isDevice</ref><sp/>){</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*size<sp/>=<sp/>dfls-&gt;<ref refid="structFTIT__data__prefetch_1afbe07d403fda95c554a9975cc90a37cb" kindref="member">requestedData</ref>;</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>dfls-&gt;<ref refid="structFTIT__data__prefetch_1a1746b75b9c110d779501192dd55beba5" kindref="member">totalBytesToFetch</ref><sp/>&gt;<sp/>0<sp/>){</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>copy_size<sp/>=<sp/><ref refid="api-cuda_8h_1a74e75242132eaabbc1c512488a135926" kindref="member">MIN</ref>(dfls-&gt;<ref refid="structFTIT__data__prefetch_1abef53fc0dc2feefada7ec6127549d631" kindref="member">fetchSize</ref>,<sp/>dfls-&gt;<ref refid="structFTIT__data__prefetch_1a1746b75b9c110d779501192dd55beba5" kindref="member">totalBytesToFetch</ref>);</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CUDA_ERROR_CHECK(cudaMemcpyAsync(<ref refid="api-cuda_8c_1aa95ffe47f6277da792e9454674c5c23a" kindref="member">hostBuffers</ref>[dfls-&gt;<ref refid="structFTIT__data__prefetch_1abc7c71fb7a3b77aaf2ed7384161ab4b2" kindref="member">Id</ref>],<sp/>dfls-&gt;<ref refid="structFTIT__data__prefetch_1a21dc6418d75e7775ba744cc83ce55a9d" kindref="member">dptr</ref>,<sp/>copy_size,<sp/>cudaMemcpyDeviceToHost,<sp/>dfls-&gt;streams[dfls-&gt;<ref refid="structFTIT__data__prefetch_1abc7c71fb7a3b77aaf2ed7384161ab4b2" kindref="member">Id</ref>]<sp/>));</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dfls-&gt;<ref refid="structFTIT__data__prefetch_1a21dc6418d75e7775ba744cc83ce55a9d" kindref="member">dptr</ref><sp/>+=<sp/>copy_size;</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dfls-&gt;<ref refid="structFTIT__data__prefetch_1a1746b75b9c110d779501192dd55beba5" kindref="member">totalBytesToFetch</ref>-=copy_size;</highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dfls-&gt;<ref refid="structFTIT__data__prefetch_1afbe07d403fda95c554a9975cc90a37cb" kindref="member">requestedData</ref><sp/>=<sp/>copy_size;</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dfls-&gt;<ref refid="structFTIT__data__prefetch_1a0946e03f7a88ce6dec11e934192c5c71" kindref="member">end</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CUDA_ERROR_CHECK(cudaStreamSynchronize(dfls-&gt;streams[prevId]));<sp/><sp/><sp/></highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*fetchedData<sp/>=<sp/><ref refid="api-cuda_8c_1aa95ffe47f6277da792e9454674c5c23a" kindref="member">hostBuffers</ref>[prevId];</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*fetchedData<sp/>=<sp/>dfls-&gt;<ref refid="structFTIT__data__prefetch_1a21dc6418d75e7775ba744cc83ce55a9d" kindref="member">dptr</ref>;</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*size<sp/>=<sp/>dfls-&gt;<ref refid="structFTIT__data__prefetch_1a1746b75b9c110d779501192dd55beba5" kindref="member">totalBytesToFetch</ref>;</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dfls-&gt;<ref refid="structFTIT__data__prefetch_1a0946e03f7a88ce6dec11e934192c5c71" kindref="member">end</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="230"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/>*fetchedData<sp/>=<sp/>dfls-&gt;<ref refid="structFTIT__data__prefetch_1a21dc6418d75e7775ba744cc83ce55a9d" kindref="member">dptr</ref>;</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/>*size<sp/>=<sp/>dfls-&gt;<ref refid="structFTIT__data__prefetch_1a1746b75b9c110d779501192dd55beba5" kindref="member">totalBytesToFetch</ref>;</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/>dfls-&gt;<ref refid="structFTIT__data__prefetch_1a0946e03f7a88ce6dec11e934192c5c71" kindref="member">end</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="234"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="236"><highlight class="normal">}</highlight></codeline>
<codeline lineno="237"><highlight class="normal"></highlight></codeline>
<codeline lineno="238" refid="api-cuda_8h_1aea1dfacf72335a4e81cc109ea9aa7c0b" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="api-cuda_8c_1aea1dfacf72335a4e81cc109ea9aa7c0b" kindref="member">FTI_destroyPrefetcher</ref>(<ref refid="structFTIT__data__prefetch" kindref="compound">FTIT_data_prefetch</ref><sp/>*dfls){</highlight></codeline>
<codeline lineno="239"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>GPUSUPPORT</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/>CUDA_ERROR_CHECK(cudaStreamDestroy(dfls-&gt;streams[0]));</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/>CUDA_ERROR_CHECK(cudaStreamDestroy(dfls-&gt;streams[1]));</highlight></codeline>
<codeline lineno="242"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="244"><highlight class="normal">}</highlight></codeline>
<codeline lineno="245"><highlight class="normal"></highlight></codeline>
<codeline lineno="246"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="255"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="256"><highlight class="normal"></highlight></codeline>
<codeline lineno="257" refid="api-cuda_8h_1acd3640ea0b47f0f4b34b9e11294290e1" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="api-cuda_8c_1acd3640ea0b47f0f4b34b9e11294290e1" kindref="member">FTI_InitDevices</ref><sp/>(<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>HostBuffSize<sp/>){</highlight></codeline>
<codeline lineno="258"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>GPUSUPPORT</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>str[<ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>];</highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/>sprintf(str,<sp/></highlight><highlight class="stringliteral">&quot;GPU<sp/>Device<sp/>Init::<sp/>Allocation<sp/>of<sp/>2<sp/>GPU-Host<sp/>Buffers:<sp/>Total<sp/>MBytes:<sp/>%d&quot;</highlight><highlight class="normal">,<sp/>HostBuffSize);</highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(str,<sp/><ref refid="fti-intern_8h_1a26a561f0e03eec3d15541c85a2a21ffd" kindref="member">FTI_INFO</ref>);</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="api-cuda_8c_1a7be887a2ca0a258cf6b368d32fd87487" kindref="member">bufferSize</ref><sp/>=<sp/>HostBuffSize;</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/>CUDA_ERROR_CHECK(cudaHostAlloc(&amp;<ref refid="api-cuda_8c_1aa95ffe47f6277da792e9454674c5c23a" kindref="member">hostBuffers</ref>[0],<sp/>HostBuffSize,<sp/>cudaHostAllocDefault));</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/>CUDA_ERROR_CHECK(cudaHostAlloc(&amp;<ref refid="api-cuda_8c_1aa95ffe47f6277da792e9454674c5c23a" kindref="member">hostBuffers</ref>[1],<sp/>HostBuffSize,<sp/>cudaHostAllocDefault));</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/>CUDA_ERROR_CHECK(cudaStreamCreate(&amp;Gstream));</highlight></codeline>
<codeline lineno="266"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="268"><highlight class="normal">}</highlight></codeline>
<codeline lineno="269"><highlight class="normal"></highlight></codeline>
<codeline lineno="270"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="278"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="279" refid="api-cuda_8h_1abb1ca3c8e8cbff17fdcba133ca6a344d" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="api-cuda_8c_1abb1ca3c8e8cbff17fdcba133ca6a344d" kindref="member">FTI_DestroyDevices</ref>(){</highlight></codeline>
<codeline lineno="280"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>GPUSUPPORT</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="282"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/>CUDA_ERROR_CHECK(cudaFreeHost(<ref refid="api-cuda_8c_1aa95ffe47f6277da792e9454674c5c23a" kindref="member">hostBuffers</ref>[0]));</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/>CUDA_ERROR_CHECK(cudaFreeHost(<ref refid="api-cuda_8c_1aa95ffe47f6277da792e9454674c5c23a" kindref="member">hostBuffers</ref>[1]));</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/>CUDA_ERROR_CHECK(cudaStreamDestroy(Gstream));</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="287"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="288"><highlight class="normal">}</highlight></codeline>
<codeline lineno="289"><highlight class="normal"></highlight></codeline>
<codeline lineno="290"><highlight class="normal"></highlight></codeline>
<codeline lineno="291"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="302"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="303" refid="api-cuda_8h_1aa25ca3090fb1052359f6a5fa4b724082" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="api-cuda_8c_1aa25ca3090fb1052359f6a5fa4b724082" kindref="member">FTI_TransferFileToDeviceAsync</ref>(FILE<sp/>*fd,<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*dptr,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>numBytes){</highlight></codeline>
<codeline lineno="304"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>GPUSUPPORT</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal"><sp/>=<sp/>0<sp/>;</highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>prevId<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>copy_size;</highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/>cudaStream_t<sp/>streams[2];<sp/></highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/>copy_size=<sp/><ref refid="api-cuda_8h_1a74e75242132eaabbc1c512488a135926" kindref="member">MIN</ref>(numBytes,<sp/><ref refid="api-cuda_8c_1a7be887a2ca0a258cf6b368d32fd87487" kindref="member">bufferSize</ref>);</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/>CUDA_ERROR_CHECK(cudaStreamCreate(&amp;(streams[0])));</highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/>CUDA_ERROR_CHECK(cudaStreamCreate(&amp;(streams[1])));</highlight></codeline>
<codeline lineno="312"><highlight class="normal"></highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(numBytes){</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>bytesRead<sp/>=<sp/>fread(<ref refid="api-cuda_8c_1aa95ffe47f6277da792e9454674c5c23a" kindref="member">hostBuffers</ref>[</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">],<sp/>1,<sp/>copy_size,<sp/>fd);</highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bytesRead<sp/>!=<sp/>copy_size){</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;Could<sp/>Not<sp/>read<sp/>entire<sp/>file&quot;</highlight><highlight class="normal">,<ref refid="fti-intern_8h_1a5cb1252ae17ef4ac13b3dbe5a8b1ab13" kindref="member">FTI_EROR</ref>);</highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fclose(fd);</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CUDA_ERROR_CHECK(cudaMemcpyAsync(<sp/>dptr,<ref refid="api-cuda_8c_1aa95ffe47f6277da792e9454674c5c23a" kindref="member">hostBuffers</ref>[</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">],<sp/>copy_size,<sp/>cudaMemcpyHostToDevice,<sp/>streams[</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">]));</highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>numBytes<sp/>=<sp/>numBytes<sp/>-<sp/>copy_size;</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dptr+=copy_size;</highlight></codeline>
<codeline lineno="323"><highlight class="normal"></highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ferror(fd))<sp/>{</highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;Could<sp/>not<sp/>read<sp/>FTI<sp/>checkpoint<sp/>file.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a5cb1252ae17ef4ac13b3dbe5a8b1ab13" kindref="member">FTI_EROR</ref>);</highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fclose(fd);</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CUDA_ERROR_CHECK(cudaStreamSynchronize(streams[prevId]));<sp/><sp/><sp/></highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>prevId<sp/>=<sp/>id;</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal"><sp/>=<sp/>(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal"><sp/>+1)%2;</highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>copy_size=<sp/><ref refid="api-cuda_8h_1a74e75242132eaabbc1c512488a135926" kindref="member">MIN</ref>(numBytes,<sp/><ref refid="api-cuda_8c_1a7be887a2ca0a258cf6b368d32fd87487" kindref="member">bufferSize</ref>);</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/>CUDA_ERROR_CHECK(cudaStreamSynchronize(streams[prevId]));<sp/><sp/><sp/></highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/>CUDA_ERROR_CHECK(cudaStreamDestroy(streams[0]));</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/>CUDA_ERROR_CHECK(cudaStreamDestroy(streams[1]));</highlight></codeline>
<codeline lineno="337"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="339"><highlight class="normal">}</highlight></codeline>
<codeline lineno="340"><highlight class="normal"></highlight></codeline>
<codeline lineno="341"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="349"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="350" refid="api-cuda_8h_1a5a897085347de12b9f622375b73c514b" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="api-cuda_8c_1a5a897085347de12b9f622375b73c514b" kindref="member">FTI_getHostBuffSize</ref>(){</highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="api-cuda_8c_1a7be887a2ca0a258cf6b368d32fd87487" kindref="member">bufferSize</ref>;</highlight></codeline>
<codeline lineno="352"><highlight class="normal">}</highlight></codeline>
<codeline lineno="353"><highlight class="normal"></highlight></codeline>
<codeline lineno="354"><highlight class="normal"></highlight></codeline>
<codeline lineno="355"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="364"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="365" refid="api-cuda_8h_1a62b401eaf98a6c666ca0f1ac0467b239" refkind="member"><highlight class="normal"><ref refid="api-cuda_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>*<ref refid="api-cuda_8c_1a62b401eaf98a6c666ca0f1ac0467b239" kindref="member">FTI_getHostBuffer</ref>(<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal"><sp/>){</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="api-cuda_8c_1aa95ffe47f6277da792e9454674c5c23a" kindref="member">hostBuffers</ref>[id];</highlight></codeline>
<codeline lineno="367"><highlight class="normal">}</highlight></codeline>
<codeline lineno="368"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="381"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="382"><highlight class="normal"></highlight></codeline>
<codeline lineno="383" refid="api-cuda_8h_1a5f16ed2832ece299208ea9c5c0b2c12f" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="api-cuda_8c_1a5f16ed2832ece299208ea9c5c0b2c12f" kindref="member">FTI_copy_to_device_async</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*dst,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*src,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>count)</highlight></codeline>
<codeline lineno="384"><highlight class="normal">{</highlight></codeline>
<codeline lineno="385"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>GPUSUPPORT</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/>CUDA_ERROR_CHECK(cudaMemcpyAsync(dst,<sp/>src,<sp/>count,<sp/>cudaMemcpyHostToDevice,Gstream));</highlight></codeline>
<codeline lineno="387"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="389"><highlight class="normal">}</highlight></codeline>
<codeline lineno="390"><highlight class="normal"></highlight></codeline>
<codeline lineno="391"><highlight class="normal"></highlight></codeline>
<codeline lineno="392"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="398"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="399" refid="api-cuda_8h_1afd0a0ee64043aed23e2dd216db7305ce" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="api-cuda_8c_1afd0a0ee64043aed23e2dd216db7305ce" kindref="member">FTI_device_sync</ref>()</highlight></codeline>
<codeline lineno="400"><highlight class="normal">{</highlight></codeline>
<codeline lineno="401"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>GPUSUPPORT</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/>CUDA_ERROR_CHECK(cudaStreamSynchronize(Gstream));</highlight></codeline>
<codeline lineno="403"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="405"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="/home/bscuser/Documents/release/dev/fti/src/api-cuda.c"/>
  </compounddef>
</doxygen>
