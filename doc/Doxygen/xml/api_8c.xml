<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.18">
  <compounddef id="api_8c" kind="file" language="C++">
    <compoundname>api.c</compoundname>
    <includes refid="interface_8h" local="yes">interface.h</includes>
    <includes local="yes">IO/cuda-md5/md5Opt.h</includes>
    <includes local="no">fti.h</includes>
    <includes local="yes">/home/bscuser/Documents/release/dev/fti/src/tools.h</includes>
    <incdepgraph>
      <node id="32">
        <label>sys/stat.h</label>
      </node>
      <node id="28">
        <label>IO/ftiff.h</label>
      </node>
      <node id="13">
        <label>stdbool.h</label>
      </node>
      <node id="3">
        <label>fti.h</label>
        <link refid="fti_8h"/>
        <childnode refid="4" relation="include">
        </childnode>
      </node>
      <node id="9">
        <label>stdarg.h</label>
      </node>
      <node id="30">
        <label>failure-injection.h</label>
        <link refid="failure-injection_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="31" relation="include">
        </childnode>
        <childnode refid="32" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="34" relation="include">
        </childnode>
      </node>
      <node id="45">
        <label>../deps/jerasure/include/galois.h</label>
      </node>
      <node id="17">
        <label>postreco.h</label>
        <link refid="postreco_8h"/>
      </node>
      <node id="2">
        <label>interface.h</label>
        <link refid="interface_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="16" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
        <childnode refid="21" relation="include">
        </childnode>
        <childnode refid="22" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
        <childnode refid="24" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="26" relation="include">
        </childnode>
        <childnode refid="27" relation="include">
        </childnode>
        <childnode refid="28" relation="include">
        </childnode>
        <childnode refid="29" relation="include">
        </childnode>
        <childnode refid="30" relation="include">
        </childnode>
        <childnode refid="35" relation="include">
        </childnode>
        <childnode refid="36" relation="include">
        </childnode>
        <childnode refid="37" relation="include">
        </childnode>
        <childnode refid="38" relation="include">
        </childnode>
        <childnode refid="39" relation="include">
        </childnode>
        <childnode refid="40" relation="include">
        </childnode>
        <childnode refid="41" relation="include">
        </childnode>
        <childnode refid="43" relation="include">
        </childnode>
        <childnode refid="44" relation="include">
        </childnode>
        <childnode refid="45" relation="include">
        </childnode>
        <childnode refid="46" relation="include">
        </childnode>
        <childnode refid="42" relation="include">
        </childnode>
      </node>
      <node id="11">
        <label>stdint.h</label>
      </node>
      <node id="6">
        <label>stdlib.h</label>
      </node>
      <node id="10">
        <label>errno.h</label>
      </node>
      <node id="38">
        <label>icp.h</label>
        <link refid="icp_8h"/>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
      </node>
      <node id="33">
        <label>fcntl.h</label>
      </node>
      <node id="20">
        <label>conf.h</label>
        <link refid="conf_8h"/>
      </node>
      <node id="35">
        <label>postckpt.h</label>
        <link refid="postckpt_8h"/>
      </node>
      <node id="43">
        <label>../deps/iniparser/iniparser.h</label>
      </node>
      <node id="5">
        <label>stddef.h</label>
      </node>
      <node id="1">
        <label>/home/bscuser/Documents/release/dev/fti/src/api.c</label>
        <link refid="api_8c"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="47" relation="include">
        </childnode>
        <childnode refid="48" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
      </node>
      <node id="47">
        <label>IO/cuda-md5/md5Opt.h</label>
      </node>
      <node id="27">
        <label>IO/hdf5-fti.h</label>
      </node>
      <node id="48">
        <label>fti.h</label>
      </node>
      <node id="15">
        <label>meta.h</label>
        <link refid="meta_8h"/>
      </node>
      <node id="34">
        <label>limits.h</label>
      </node>
      <node id="21">
        <label>checkpoint.h</label>
        <link refid="checkpoint_8h"/>
      </node>
      <node id="19">
        <label>dcp.h</label>
        <link refid="dcp_8h"/>
      </node>
      <node id="36">
        <label>recover.h</label>
        <link refid="recover_8h"/>
      </node>
      <node id="31">
        <label>sys/types.h</label>
      </node>
      <node id="8">
        <label>string.h</label>
      </node>
      <node id="40">
        <label>utility.h</label>
        <link refid="utility_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="41" relation="include">
        </childnode>
        <childnode refid="42" relation="include">
        </childnode>
      </node>
      <node id="18">
        <label>tools.h</label>
        <link refid="tools_8h"/>
      </node>
      <node id="22">
        <label>stage.h</label>
        <link refid="stage_8h"/>
      </node>
      <node id="12">
        <label>unistd.h</label>
      </node>
      <node id="23">
        <label>fti-io.h</label>
        <link refid="fti-io_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
      </node>
      <node id="4">
        <label>fti-intern.h</label>
        <link refid="fti-intern_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
      </node>
      <node id="41">
        <label>../deps/md5/md5.h</label>
      </node>
      <node id="44">
        <label>../deps/iniparser/dictionary.h</label>
      </node>
      <node id="26">
        <label>IO/posix-dcp.h</label>
      </node>
      <node id="25">
        <label>IO/posix.h</label>
      </node>
      <node id="46">
        <label>../deps/jerasure/include/jerasure.h</label>
      </node>
      <node id="14">
        <label>mpi.h</label>
      </node>
      <node id="29">
        <label>IO/ftiff-dcp.h</label>
      </node>
      <node id="42">
        <label>sion.h</label>
      </node>
      <node id="39">
        <label>macros.h</label>
        <link refid="macros_8h"/>
      </node>
      <node id="37">
        <label>fortran/ftif.h</label>
      </node>
      <node id="7">
        <label>stdio.h</label>
      </node>
      <node id="24">
        <label>topo.h</label>
        <link refid="topo_8h"/>
      </node>
      <node id="16">
        <label>api-cuda.h</label>
        <link refid="api-cuda_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
    </incdepgraph>
      <sectiondef kind="var">
      <memberdef kind="variable" id="api_8c_1a5b95385892fdc8a93fc7f7239272d23e" prot="public" static="yes" mutable="no">
        <type><ref refid="structFTIT__configuration" kindref="compound">FTIT_configuration</ref></type>
        <definition>FTIT_configuration FTI_Conf</definition>
        <argsstring></argsstring>
        <name>FTI_Conf</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>General configuration information used by FTI. <linebreak/>
 </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="48" column="27" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="48" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="api_8c_1a472c55d554ebe39f4e4507dcb3038604" prot="public" static="yes" mutable="no">
        <type><ref refid="structFTIT__checkpoint" kindref="compound">FTIT_checkpoint</ref></type>
        <definition>FTIT_checkpoint FTI_Ckpt[5]</definition>
        <argsstring>[5]</argsstring>
        <name>FTI_Ckpt</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Checkpoint information for all levels of checkpoint. <linebreak/>
 </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="51" column="24" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="51" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="api_8c_1afcc7055dbe2db230399fd3010f9e4b8b" prot="public" static="yes" mutable="no">
        <type><ref refid="structFTIT__execution" kindref="compound">FTIT_execution</ref></type>
        <definition>FTIT_execution FTI_Exec</definition>
        <argsstring></argsstring>
        <name>FTI_Exec</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Dynamic information for this execution. <linebreak/>
 </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="54" column="23" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="54" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="api_8c_1a4645e2fc6a24d696307cf6fe0be196eb" prot="public" static="yes" mutable="no">
        <type><ref refid="structFTIT__topology" kindref="compound">FTIT_topology</ref></type>
        <definition>FTIT_topology FTI_Topo</definition>
        <argsstring></argsstring>
        <name>FTI_Topo</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Topology of the system. <linebreak/>
 </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="57" column="22" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="57" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="api_8c_1a7c052c34fd63a7688178dbdb8ff5f881" prot="public" static="yes" mutable="no">
        <type><ref refid="structFTIT__dataset" kindref="compound">FTIT_dataset</ref></type>
        <definition>FTIT_dataset FTI_Data[FTI_BUFS]</definition>
        <argsstring>[FTI_BUFS]</argsstring>
        <name>FTI_Data</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Array of datasets and all their internal information. <linebreak/>
 </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="60" column="21" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="60" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="api_8c_1a8f34b86fe29f7664ef2f0d2689590b50" prot="public" static="yes" mutable="no">
        <type><ref refid="structFTIT__injection" kindref="compound">FTIT_injection</ref></type>
        <definition>FTIT_injection FTI_Inje</definition>
        <argsstring></argsstring>
        <name>FTI_Inje</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>SDC injection model and all the required information. <linebreak/>
 </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="63" column="23" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="63" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="api_8c_1a7deaa5171fbf22fe59ae1c08f2bdcc97" prot="public" static="no" mutable="no">
        <type>MPI_Comm</type>
        <definition>MPI_Comm FTI_COMM_WORLD</definition>
        <argsstring></argsstring>
        <name>FTI_COMM_WORLD</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>MPI communicator that splits the global one into app and FTI appart. <linebreak/>
 </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="66" column="10" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="66" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="api_8c_1af384b54744550e2300db530ef46f7e77" prot="public" static="no" mutable="no">
        <type><ref refid="structFTIT__type" kindref="compound">FTIT_type</ref></type>
        <definition>FTIT_type FTI_CHAR</definition>
        <argsstring></argsstring>
        <name>FTI_CHAR</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>FTI data type for chars. <linebreak/>
 </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="69" column="11" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="69" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="api_8c_1a7f97366acb17493ec718fb6086f1ac3c" prot="public" static="no" mutable="no">
        <type><ref refid="structFTIT__type" kindref="compound">FTIT_type</ref></type>
        <definition>FTIT_type FTI_SHRT</definition>
        <argsstring></argsstring>
        <name>FTI_SHRT</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>FTI data type for short integers. <linebreak/>
 </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="71" column="11" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="71" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="api_8c_1ad236df2303494837c97a13741423a51b" prot="public" static="no" mutable="no">
        <type><ref refid="structFTIT__type" kindref="compound">FTIT_type</ref></type>
        <definition>FTIT_type FTI_INTG</definition>
        <argsstring></argsstring>
        <name>FTI_INTG</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>FTI data type for integers. <linebreak/>
 </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="73" column="11" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="73" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="api_8c_1a29acf773174ad269577b5c771521694a" prot="public" static="no" mutable="no">
        <type><ref refid="structFTIT__type" kindref="compound">FTIT_type</ref></type>
        <definition>FTIT_type FTI_LONG</definition>
        <argsstring></argsstring>
        <name>FTI_LONG</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>FTI data type for long integers. <linebreak/>
 </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="75" column="11" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="75" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="api_8c_1a2a1ee34ef81027534671ee3145a89213" prot="public" static="no" mutable="no">
        <type><ref refid="structFTIT__type" kindref="compound">FTIT_type</ref></type>
        <definition>FTIT_type FTI_UCHR</definition>
        <argsstring></argsstring>
        <name>FTI_UCHR</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>FTI data type for unsigned chars. <linebreak/>
 </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="77" column="11" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="77" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="api_8c_1ad00601a105ae08e82837c629b8e55612" prot="public" static="no" mutable="no">
        <type><ref refid="structFTIT__type" kindref="compound">FTIT_type</ref></type>
        <definition>FTIT_type FTI_USHT</definition>
        <argsstring></argsstring>
        <name>FTI_USHT</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>FTI data type for unsigned short integers. <linebreak/>
 </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="79" column="11" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="79" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="api_8c_1a1e77437528f3df560360e0626b9a3b89" prot="public" static="no" mutable="no">
        <type><ref refid="structFTIT__type" kindref="compound">FTIT_type</ref></type>
        <definition>FTIT_type FTI_UINT</definition>
        <argsstring></argsstring>
        <name>FTI_UINT</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>FTI data type for unsigned integers. <linebreak/>
 </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="81" column="11" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="81" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="api_8c_1afdc10ccdf5f020d7b0306ecce07f52c1" prot="public" static="no" mutable="no">
        <type><ref refid="structFTIT__type" kindref="compound">FTIT_type</ref></type>
        <definition>FTIT_type FTI_ULNG</definition>
        <argsstring></argsstring>
        <name>FTI_ULNG</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>FTI data type for unsigned long integers. <linebreak/>
 </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="83" column="11" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="83" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="api_8c_1a39b15455ede057260e435cf49bc3ee6d" prot="public" static="no" mutable="no">
        <type><ref refid="structFTIT__type" kindref="compound">FTIT_type</ref></type>
        <definition>FTIT_type FTI_SFLT</definition>
        <argsstring></argsstring>
        <name>FTI_SFLT</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>FTI data type for single floating point. <linebreak/>
 </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="85" column="11" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="85" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="api_8c_1aafb3604bd7ebfae406d1c419890e04d8" prot="public" static="no" mutable="no">
        <type><ref refid="structFTIT__type" kindref="compound">FTIT_type</ref></type>
        <definition>FTIT_type FTI_DBLE</definition>
        <argsstring></argsstring>
        <name>FTI_DBLE</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>FTI data type for double floating point. <linebreak/>
 </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="87" column="11" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="87" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="api_8c_1acd10e7ef980b4ed3d775bb499cfac8ba" prot="public" static="no" mutable="no">
        <type><ref refid="structFTIT__type" kindref="compound">FTIT_type</ref></type>
        <definition>FTIT_type FTI_LDBE</definition>
        <argsstring></argsstring>
        <name>FTI_LDBE</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>FTI data type for long doble floating point. <linebreak/>
 </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="89" column="11" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="89" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="func">
      <memberdef kind="function" id="api_8c_1abe8c2b202eaab996bbd88eea4cafe51a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FTI_Init</definition>
        <argsstring>(const char *configFile, MPI_Comm globalComm)</argsstring>
        <name>FTI_Init</name>
        <param>
          <type>const char *</type>
          <declname>configFile</declname>
        </param>
        <param>
          <type>MPI_Comm</type>
          <declname>globalComm</declname>
        </param>
        <briefdescription>
<para>Initializes FTI. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>configFile</parametername>
</parameternamelist>
<parameterdescription>
<para>FTI configuration file. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>globalComm</parametername>
</parameternamelist>
<parameterdescription>
<para>Main MPI communicator of the application. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>integer FTI_SCES if successful.</para>
</simplesect>
This function initializes the FTI context and prepares the heads to wait for checkpoints. FTI processes should never get out of this function. In case of a restart, checkpoint files should be recovered and in place at the end of this function. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="107" column="5" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="107" bodyend="210"/>
        <references refid="tools_8c_1ad95399f229aa8c9ae4aef2574d732f7d" compoundref="tools_8c" startline="88" endline="236">FTI_InitExecVars</references>
        <references refid="failure-injection_8c_1a7acbcfc49eb071c72fcd452dbf00c197" compoundref="failure-injection_8c" startline="16" endline="31">FTI_InitFIIO</references>
      </memberdef>
      <memberdef kind="function" id="api_8c_1a5222b52e6f1d6b737f4ec1b173f362f5" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FTI_Status</definition>
        <argsstring>()</argsstring>
        <name>FTI_Status</name>
        <briefdescription>
<para>It returns the current status of the recovery flag. </para>
        </briefdescription>
        <detaileddescription>
<para><simplesect kind="return"><para>integer FTI_Exec.reco.</para>
</simplesect>
This function returns the current status of the recovery flag. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="224" column="5" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="224" bodyend="227"/>
      </memberdef>
      <memberdef kind="function" id="api_8c_1a725ffe84dd16beb533e7b4b74fa4e9c4" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FTI_InitType</definition>
        <argsstring>(FTIT_type *type, int size)</argsstring>
        <name>FTI_InitType</name>
        <param>
          <type><ref refid="structFTIT__type" kindref="compound">FTIT_type</ref> *</type>
          <declname>type</declname>
        </param>
        <param>
          <type>int</type>
          <declname>size</declname>
        </param>
        <briefdescription>
<para>It initializes a data type. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>type</parametername>
</parameternamelist>
<parameterdescription>
<para>The data type to be intialized. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>size</parametername>
</parameternamelist>
<parameterdescription>
<para>The size of the data type to be intialized. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>integer FTI_SCES if successful.</para>
</simplesect>
This function initalizes a data type. The only information needed is the size of the data type, the rest is black box for FTI. Types saved as byte array in case of HDF5 format. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="242" column="5" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="242" bodyend="287"/>
        <references refid="structFTIT__type_1a75237aa3e6824b450ee623bffb36608a" compoundref="fti-intern_8h" startline="349">FTIT_type::id</references>
      </memberdef>
      <memberdef kind="function" id="api_8c_1a7fab7e8f18c24f415dc658714c27c669" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FTI_InitComplexType</definition>
        <argsstring>(FTIT_type *newType, FTIT_complexType *typeDefinition, int length, size_t size, char *name, FTIT_H5Group *h5group)</argsstring>
        <name>FTI_InitComplexType</name>
        <param>
          <type><ref refid="structFTIT__type" kindref="compound">FTIT_type</ref> *</type>
          <declname>newType</declname>
        </param>
        <param>
          <type><ref refid="structFTIT__complexType" kindref="compound">FTIT_complexType</ref> *</type>
          <declname>typeDefinition</declname>
        </param>
        <param>
          <type>int</type>
          <declname>length</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>size</declname>
        </param>
        <param>
          <type>char *</type>
          <declname>name</declname>
        </param>
        <param>
          <type><ref refid="structFTIT__H5Group" kindref="compound">FTIT_H5Group</ref> *</type>
          <declname>h5group</declname>
        </param>
        <briefdescription>
<para>It initializes a complex data type. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>newType</parametername>
</parameternamelist>
<parameterdescription>
<para>The data type to be intialized. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>typeDefinition</parametername>
</parameternamelist>
<parameterdescription>
<para>Structure definition of the new type. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>length</parametername>
</parameternamelist>
<parameterdescription>
<para>Number of fields in structure </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>size</parametername>
</parameternamelist>
<parameterdescription>
<para>Size of the structure. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>name</parametername>
</parameternamelist>
<parameterdescription>
<para>Name of the structure. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>h5group</parametername>
</parameternamelist>
<parameterdescription>
<para>Group of the type. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>integer FTI_SCES if successful.</para>
</simplesect>
This function initalizes a simple data type. New type can only consists fields of flat FTI types (no arrays). Type definition must include:<itemizedlist>
<listitem><para>length =&gt; number of fields in the new type</para>
</listitem><listitem><para>field[].type =&gt; types of the field in the new type</para>
</listitem><listitem><para>field[].name =&gt; name of the field in the new type</para>
</listitem><listitem><para>field[].rank =&gt; number of dimentions of the field</para>
</listitem><listitem><para>field[].dimLength[] =&gt; length of each dimention of the field </para>
</listitem></itemizedlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="310" column="5" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="310" bodyend="373"/>
      </memberdef>
      <memberdef kind="function" id="api_8c_1a990302331eacb14390ce4feae438405f" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void FTI_AddSimpleField</definition>
        <argsstring>(FTIT_complexType *typeDefinition, FTIT_type *ftiType, size_t offset, int id, char *name)</argsstring>
        <name>FTI_AddSimpleField</name>
        <param>
          <type><ref refid="structFTIT__complexType" kindref="compound">FTIT_complexType</ref> *</type>
          <declname>typeDefinition</declname>
        </param>
        <param>
          <type><ref refid="structFTIT__type" kindref="compound">FTIT_type</ref> *</type>
          <declname>ftiType</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>offset</declname>
        </param>
        <param>
          <type>int</type>
          <declname>id</declname>
        </param>
        <param>
          <type>char *</type>
          <declname>name</declname>
        </param>
        <briefdescription>
<para>It adds a simple field in complex data type. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>typeDefinition</parametername>
</parameternamelist>
<parameterdescription>
<para>Structure definition of the complex data type. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>ftiType</parametername>
</parameternamelist>
<parameterdescription>
<para>Type of the field </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>offset</parametername>
</parameternamelist>
<parameterdescription>
<para>Offset of the field (use offsetof) </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>id</parametername>
</parameternamelist>
<parameterdescription>
<para>Id of the field (start with 0) </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>name</parametername>
</parameternamelist>
<parameterdescription>
<para>Name of the field (put NULL if want default) </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>integer FTI_SCES if successful.</para>
</simplesect>
This function adds a field to the complex datatype. Use offsetof macro to set offset. First ID must be 0, next one must be +1. If name is NULL FTI will set &quot;T${id}&quot; name. Sets rank and dimLength to 1. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="391" column="6" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="391" bodyend="402"/>
        <references refid="structFTIT__typeField_1af0e311f38f7f6b7ab7ff04e3897f6c37" compoundref="fti-intern_8h" startline="394">FTIT_typeField::dimLength</references>
        <references refid="structFTIT__complexType_1abbb9d041a59fd4972244d8c62e78dbaa" compoundref="fti-intern_8h" startline="406">FTIT_complexType::field</references>
        <references refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" compoundref="fti_8h" startline="12">FTI_BUFS</references>
        <references refid="structFTIT__type_1a75237aa3e6824b450ee623bffb36608a" compoundref="fti-intern_8h" startline="349">FTIT_type::id</references>
        <references refid="structFTIT__typeField_1aa2dcf41b2455dd8b220587a655fcf73d" compoundref="fti-intern_8h" startline="395">FTIT_typeField::name</references>
        <references refid="structFTIT__typeField_1a75068a6f39c20766ec43624f9b497cbf" compoundref="fti-intern_8h" startline="392">FTIT_typeField::offset</references>
        <references refid="structFTIT__typeField_1ad46ee30f23a6af1c5ac85ecce834cdc2" compoundref="fti-intern_8h" startline="393">FTIT_typeField::rank</references>
        <references refid="structFTIT__typeField_1ac81ba503b07eae0ed82ad1e2f5ecdced" compoundref="fti-intern_8h" startline="391">FTIT_typeField::typeID</references>
      </memberdef>
      <memberdef kind="function" id="api_8c_1ab93e233cbea2ba23a026e3f2396ec0a3" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void FTI_AddComplexField</definition>
        <argsstring>(FTIT_complexType *typeDefinition, FTIT_type *ftiType, size_t offset, int rank, int *dimLength, int id, char *name)</argsstring>
        <name>FTI_AddComplexField</name>
        <param>
          <type><ref refid="structFTIT__complexType" kindref="compound">FTIT_complexType</ref> *</type>
          <declname>typeDefinition</declname>
        </param>
        <param>
          <type><ref refid="structFTIT__type" kindref="compound">FTIT_type</ref> *</type>
          <declname>ftiType</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>offset</declname>
        </param>
        <param>
          <type>int</type>
          <declname>rank</declname>
        </param>
        <param>
          <type>int *</type>
          <declname>dimLength</declname>
        </param>
        <param>
          <type>int</type>
          <declname>id</declname>
        </param>
        <param>
          <type>char *</type>
          <declname>name</declname>
        </param>
        <briefdescription>
<para>It adds a simple field in complex data type. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>typeDefinition</parametername>
</parameternamelist>
<parameterdescription>
<para>Structure definition of the complex data type. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>ftiType</parametername>
</parameternamelist>
<parameterdescription>
<para>Type of the field </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>offset</parametername>
</parameternamelist>
<parameterdescription>
<para>Offset of the field (use offsetof) </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>rank</parametername>
</parameternamelist>
<parameterdescription>
<para>Rank of the array </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>dimLength</parametername>
</parameternamelist>
<parameterdescription>
<para>Dimention length for each rank </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>id</parametername>
</parameternamelist>
<parameterdescription>
<para>Id of the field (start with 0) </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>name</parametername>
</parameternamelist>
<parameterdescription>
<para>Name of the field (put NULL if want default) </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>integer FTI_SCES if successful.</para>
</simplesect>
This function adds a field to the complex datatype. Use offsetof macro to set offset. First ID must be 0, next one must be +1. If name is NULL FTI will set &quot;T${id}&quot; name. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="422" column="6" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="422" bodyend="436"/>
        <references refid="structFTIT__typeField_1af0e311f38f7f6b7ab7ff04e3897f6c37" compoundref="fti-intern_8h" startline="394">FTIT_typeField::dimLength</references>
        <references refid="structFTIT__complexType_1abbb9d041a59fd4972244d8c62e78dbaa" compoundref="fti-intern_8h" startline="406">FTIT_complexType::field</references>
        <references refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" compoundref="fti_8h" startline="12">FTI_BUFS</references>
        <references refid="structFTIT__type_1a75237aa3e6824b450ee623bffb36608a" compoundref="fti-intern_8h" startline="349">FTIT_type::id</references>
        <references refid="structFTIT__typeField_1aa2dcf41b2455dd8b220587a655fcf73d" compoundref="fti-intern_8h" startline="395">FTIT_typeField::name</references>
        <references refid="structFTIT__typeField_1a75068a6f39c20766ec43624f9b497cbf" compoundref="fti-intern_8h" startline="392">FTIT_typeField::offset</references>
        <references refid="structFTIT__typeField_1ad46ee30f23a6af1c5ac85ecce834cdc2" compoundref="fti-intern_8h" startline="393">FTIT_typeField::rank</references>
        <references refid="structFTIT__typeField_1ac81ba503b07eae0ed82ad1e2f5ecdced" compoundref="fti-intern_8h" startline="391">FTIT_typeField::typeID</references>
      </memberdef>
      <memberdef kind="function" id="api_8c_1a9a144006e804d976446ba5a9c21f1591" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FTI_GetStageDir</definition>
        <argsstring>(char *stageDir, int maxLen)</argsstring>
        <name>FTI_GetStageDir</name>
        <param>
          <type>char *</type>
          <declname>stageDir</declname>
        </param>
        <param>
          <type>int</type>
          <declname>maxLen</declname>
        </param>
        <briefdescription>
<para>Places the FTI staging directory path into &apos;stageDir&apos;. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>stageDir</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer to allocated memory region. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>maxLen</parametername>
</parameternamelist>
<parameterdescription>
<para>size of allocated memory region in bytes. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>integer FTI_SCES if successful, FTI_NSCS else.</para>
</simplesect>
This function places the FTI staging directory path in &apos;stageDir&apos;. If allocation size is not sufficiant, no action is perfoprmed and FTI_NSCS is returned. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="450" column="5" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="450" bodyend="480"/>
      </memberdef>
      <memberdef kind="function" id="api_8c_1a244522ba34ee7fced63cab22a24b326b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FTI_GetStageStatus</definition>
        <argsstring>(int ID)</argsstring>
        <name>FTI_GetStageStatus</name>
        <param>
          <type>int</type>
          <declname>ID</declname>
        </param>
        <briefdescription>
<para>Returns status of staging request. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>ID</parametername>
</parameternamelist>
<parameterdescription>
<para>ID of staging request. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>integer Status of staging request on success, FTI_NSCS else.</para>
</simplesect>
This function returns the status of the staging request corresponding to ID. The ID is returned by the function &apos;FTI_SendFile&apos;. The status may be one of the five possible statuses:</para>
<para><simplesect kind="par"><title></title><para>FTI_SI_FAIL - Stage request failed FTI_SI_SCES - Stage request succeed FTI_SI_ACTV - Stage request is currently processed FTI_SI_PEND - Stage request is pending FTI_SI_NINI - There is no stage request with this ID</para>
</simplesect>
<simplesect kind="note"><para>If the status is FTI_SI_NINI, the ID is either invalid or the request was finished (succeeded or failed). In the latter case, &apos;FTI_GetStageStatus&apos; returns FTI_SI_FAIL or FTI_SI_SCES and frees the stage request ressources. In the consecutive call it will then return FTI_SI_NINI. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="507" column="5" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="507" bodyend="546"/>
      </memberdef>
      <memberdef kind="function" id="api_8c_1ae89330f9e650a1a5b7e2f460edba8d54" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FTI_SendFile</definition>
        <argsstring>(char *lpath, char *rpath)</argsstring>
        <name>FTI_SendFile</name>
        <param>
          <type>char *</type>
          <declname>lpath</declname>
        </param>
        <param>
          <type>char *</type>
          <declname>rpath</declname>
        </param>
        <briefdescription>
<para>Copies file asynchronously from &apos;lpath&apos; to &apos;rpath&apos;. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>lpath</parametername>
</parameternamelist>
<parameterdescription>
<para>absolute path local file. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>rpath</parametername>
</parameternamelist>
<parameterdescription>
<para>absolute path remote file. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>integer Request handle (ID) on success, FTI_NSCS else.</para>
</simplesect>
This function may be used to copy a file local on the nodes via the FTI head process asynchronously to the PFS. The file will not be removed after successful transfer, however, if stored in the directory returned by &apos;FTI_GetStageDir&apos; it will be removed during &apos;FTI_Finalize&apos;.</para>
<para><simplesect kind="par"><title></title><para>If staging is enabled but no head process, the staging will be performed synchronously (i.e. by the calling rank). </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="566" column="5" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="566" bodyend="618"/>
      </memberdef>
      <memberdef kind="function" id="api_8c_1a13fc751bcf88d7c2766d0b76344b0964" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FTI_InitGroup</definition>
        <argsstring>(FTIT_H5Group *h5group, char *name, FTIT_H5Group *parent)</argsstring>
        <name>FTI_InitGroup</name>
        <param>
          <type><ref refid="structFTIT__H5Group" kindref="compound">FTIT_H5Group</ref> *</type>
          <declname>h5group</declname>
        </param>
        <param>
          <type>char *</type>
          <declname>name</declname>
        </param>
        <param>
          <type><ref refid="structFTIT__H5Group" kindref="compound">FTIT_H5Group</ref> *</type>
          <declname>parent</declname>
        </param>
        <briefdescription>
<para>It initialize a HDF5 group. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>h5group</parametername>
</parameternamelist>
<parameterdescription>
<para>H5 group that we want to initialize </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>name</parametername>
</parameternamelist>
<parameterdescription>
<para>Name of the H5 group </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>parent</parametername>
</parameternamelist>
<parameterdescription>
<para>Parent H5 group </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>integer FTI_SCES if successful.</para>
</simplesect>
Initialize group defined by user. If parent is NULL this mean parent will be set to root group. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="633" column="5" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="633" bodyend="670"/>
      </memberdef>
      <memberdef kind="function" id="api_8c_1a2da201b48449cc457f338d23bc3f4cf3" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FTI_setIDFromString</definition>
        <argsstring>(char *name)</argsstring>
        <name>FTI_setIDFromString</name>
        <param>
          <type>char *</type>
          <declname>name</declname>
        </param>
        <briefdescription>
<para>Searches in the protected variables for a name. If not found it allocates and returns the ID. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>name</parametername>
</parameternamelist>
<parameterdescription>
<para>Name of the protected variable to search </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>integer id of the variable.</para>
</simplesect>
This function searches for a given name in the protected variables and returns the respective id for it. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="684" column="5" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="684" bodyend="693"/>
      </memberdef>
      <memberdef kind="function" id="api_8c_1aa3085533f52818cf46175b8f783ad17b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FTI_getIDFromString</definition>
        <argsstring>(char *name)</argsstring>
        <name>FTI_getIDFromString</name>
        <param>
          <type>char *</type>
          <declname>name</declname>
        </param>
        <briefdescription>
<para>Searches in the protected variables for a name. If not found it allocates and returns the ID. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>name</parametername>
</parameternamelist>
<parameterdescription>
<para>Name of the protected variable to search </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>integer id of the variable.</para>
</simplesect>
This function searches for a given name in the protected variables and returns the respective id for it. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="705" column="5" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="705" bodyend="718"/>
      </memberdef>
      <memberdef kind="function" id="api_8c_1a2dc4fb3b0353541b7bc156f1c803f92f" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FTI_RenameGroup</definition>
        <argsstring>(FTIT_H5Group *h5group, char *name)</argsstring>
        <name>FTI_RenameGroup</name>
        <param>
          <type><ref refid="structFTIT__H5Group" kindref="compound">FTIT_H5Group</ref> *</type>
          <declname>h5group</declname>
        </param>
        <param>
          <type>char *</type>
          <declname>name</declname>
        </param>
        <briefdescription>
<para>Renames a HDF5 group. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>h5group</parametername>
</parameternamelist>
<parameterdescription>
<para>H5 group that we want to rename </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>name</parametername>
</parameternamelist>
<parameterdescription>
<para>New name of the H5 group </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>integer FTI_SCES if successful.</para>
</simplesect>
This function renames HDF5 group defined by user. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="731" column="5" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="731" bodyend="735"/>
      </memberdef>
      <memberdef kind="function" id="api_8c_1a913b8cd6e29a152eceaeaec35e21e677" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FTI_Protect</definition>
        <argsstring>(int id, void *ptr, long count, FTIT_type type)</argsstring>
        <name>FTI_Protect</name>
        <param>
          <type>int</type>
          <declname>id</declname>
        </param>
        <param>
          <type>void *</type>
          <declname>ptr</declname>
        </param>
        <param>
          <type>long</type>
          <declname>count</declname>
        </param>
        <param>
          <type><ref refid="structFTIT__type" kindref="compound">FTIT_type</ref></type>
          <declname>type</declname>
        </param>
        <briefdescription>
<para>It sets/resets the pointer and type to a protected variable. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>id</parametername>
</parameternamelist>
<parameterdescription>
<para>ID for searches and update. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>ptr</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the data structure. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>count</parametername>
</parameternamelist>
<parameterdescription>
<para>Number of elements in the data structure. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>type</parametername>
</parameternamelist>
<parameterdescription>
<para>Type of elements in the data structure. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>integer FTI_SCES if successful.</para>
</simplesect>
This function stores a pointer to a data structure, its size, its ID, its number of elements and the type of the elements. This list of structures is the data that will be stored during a checkpoint and loaded during a recovery. It resets the pointer to a data structure, its size, its number of elements and the type of the elements if the dataset was already previously registered. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="755" column="5" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="755" bodyend="914"/>
      </memberdef>
      <memberdef kind="function" id="api_8c_1a1abef7eeec0efb4fb73b5929637aa90f" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FTI_DefineGlobalDataset</definition>
        <argsstring>(int id, int rank, FTIT_hsize_t *dimLength, const char *name, FTIT_H5Group *h5group, FTIT_type type)</argsstring>
        <name>FTI_DefineGlobalDataset</name>
        <param>
          <type>int</type>
          <declname>id</declname>
        </param>
        <param>
          <type>int</type>
          <declname>rank</declname>
        </param>
        <param>
          <type><ref refid="fti-intern_8h_1a93fc516f1fbe5fb3d37e6527684b8dd4" kindref="member">FTIT_hsize_t</ref> *</type>
          <declname>dimLength</declname>
        </param>
        <param>
          <type>const char *</type>
          <declname>name</declname>
        </param>
        <param>
          <type><ref refid="structFTIT__H5Group" kindref="compound">FTIT_H5Group</ref> *</type>
          <declname>h5group</declname>
        </param>
        <param>
          <type><ref refid="structFTIT__type" kindref="compound">FTIT_type</ref></type>
          <declname>type</declname>
        </param>
        <briefdescription>
<para>Defines a global dataset (shared among application processes) </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>id</parametername>
</parameternamelist>
<parameterdescription>
<para>ID of the dataset. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>rank</parametername>
</parameternamelist>
<parameterdescription>
<para>Rank of the dataset. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>dimLength</parametername>
</parameternamelist>
<parameterdescription>
<para>Dimention length for each rank. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>name</parametername>
</parameternamelist>
<parameterdescription>
<para>Name of the dataset in HDF5 file. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>h5group</parametername>
</parameternamelist>
<parameterdescription>
<para>Group of the dataset. If Null then &quot;/&quot;. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>type</parametername>
</parameternamelist>
<parameterdescription>
<para>FTI type of the dataset. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>integer FTI_SCES if successful.</para>
</simplesect>
This function defines a global dataset which is shared among all ranks. In order to assign sub sets to the dataset the user has to call the function &apos;FTI_AddSubset&apos;. The parameter &apos;did&apos; of that function, corres- ponds to the global dataset id define here. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="934" column="5" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="934" bodyend="985"/>
      </memberdef>
      <memberdef kind="function" id="api_8c_1a55e7d096389f363b570084126af8ece5" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FTI_AddSubset</definition>
        <argsstring>(int id, int rank, FTIT_hsize_t *offset, FTIT_hsize_t *count, int did)</argsstring>
        <name>FTI_AddSubset</name>
        <param>
          <type>int</type>
          <declname>id</declname>
        </param>
        <param>
          <type>int</type>
          <declname>rank</declname>
        </param>
        <param>
          <type><ref refid="fti-intern_8h_1a93fc516f1fbe5fb3d37e6527684b8dd4" kindref="member">FTIT_hsize_t</ref> *</type>
          <declname>offset</declname>
        </param>
        <param>
          <type><ref refid="fti-intern_8h_1a93fc516f1fbe5fb3d37e6527684b8dd4" kindref="member">FTIT_hsize_t</ref> *</type>
          <declname>count</declname>
        </param>
        <param>
          <type>int</type>
          <declname>did</declname>
        </param>
        <briefdescription>
<para>Assigns a FTI protected variable to a global dataset. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>id</parametername>
</parameternamelist>
<parameterdescription>
<para>Corresponding variable ID. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>rank</parametername>
</parameternamelist>
<parameterdescription>
<para>Rank of the dataset. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>offset</parametername>
</parameternamelist>
<parameterdescription>
<para>Starting coordinates in global dataset. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>count</parametername>
</parameternamelist>
<parameterdescription>
<para>number of elements for each coordinate. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>did</parametername>
</parameternamelist>
<parameterdescription>
<para>Corresponding global dataset ID. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>integer FTI_SCES if successful.</para>
</simplesect>
This function assigns the protected dataset with ID &apos;id&apos; to a global data- set with ID &apos;did&apos;. The parameters &apos;offset&apos; and &apos;count&apos; specify the selec- tion of the sub-set inside the global dataset (&apos;offset&apos; and &apos;count&apos; cor- respond to &apos;start&apos; and &apos;count&apos; in the HDF5 function &apos;H5Sselect_hyperslab&apos; For questions on what they define, please consult the HDF5 documentation.) </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="1005" column="5" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="1005" bodyend="1071"/>
      </memberdef>
      <memberdef kind="function" id="api_8c_1aa52eec71c6460f10f2986acef5469c48" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FTI_UpdateGlobalDataset</definition>
        <argsstring>(int id, int rank, FTIT_hsize_t *dimLength)</argsstring>
        <name>FTI_UpdateGlobalDataset</name>
        <param>
          <type>int</type>
          <declname>id</declname>
        </param>
        <param>
          <type>int</type>
          <declname>rank</declname>
        </param>
        <param>
          <type><ref refid="fti-intern_8h_1a93fc516f1fbe5fb3d37e6527684b8dd4" kindref="member">FTIT_hsize_t</ref> *</type>
          <declname>dimLength</declname>
        </param>
        <briefdescription>
<para>Updates global dataset (shared among application processes) </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>id</parametername>
</parameternamelist>
<parameterdescription>
<para>ID of the dataset. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>rank</parametername>
</parameternamelist>
<parameterdescription>
<para>Rank of the dataset. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>dimLength</parametername>
</parameternamelist>
<parameterdescription>
<para>Dimention length for each rank.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
updates only the rank and number of elements for each coordinate direction. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="1084" column="5" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="1084" bodyend="1120"/>
      </memberdef>
      <memberdef kind="function" id="api_8c_1ad1fb249ff8d7f4b44e40e7e5c027d411" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FTI_UpdateSubset</definition>
        <argsstring>(int id, int rank, FTIT_hsize_t *offset, FTIT_hsize_t *count, int did)</argsstring>
        <name>FTI_UpdateSubset</name>
        <param>
          <type>int</type>
          <declname>id</declname>
        </param>
        <param>
          <type>int</type>
          <declname>rank</declname>
        </param>
        <param>
          <type><ref refid="fti-intern_8h_1a93fc516f1fbe5fb3d37e6527684b8dd4" kindref="member">FTIT_hsize_t</ref> *</type>
          <declname>offset</declname>
        </param>
        <param>
          <type><ref refid="fti-intern_8h_1a93fc516f1fbe5fb3d37e6527684b8dd4" kindref="member">FTIT_hsize_t</ref> *</type>
          <declname>count</declname>
        </param>
        <param>
          <type>int</type>
          <declname>did</declname>
        </param>
        <briefdescription>
<para>Updates a FTI protected variable of a global dataset. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>id</parametername>
</parameternamelist>
<parameterdescription>
<para>Corresponding variable ID. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>rank</parametername>
</parameternamelist>
<parameterdescription>
<para>Rank of the dataset. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>offset</parametername>
</parameternamelist>
<parameterdescription>
<para>Starting coordinates in global dataset. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>count</parametername>
</parameternamelist>
<parameterdescription>
<para>number of elements for each coordinate. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>did</parametername>
</parameternamelist>
<parameterdescription>
<para>Corresponding global dataset ID. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>integer FTI_SCES if successful. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="1134" column="5" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="1134" bodyend="1203"/>
      </memberdef>
      <memberdef kind="function" id="api_8c_1a8dd9c8d88cc5e17214c384478b441dd5" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FTI_GetDatasetRank</definition>
        <argsstring>(int did)</argsstring>
        <name>FTI_GetDatasetRank</name>
        <param>
          <type>int</type>
          <declname>did</declname>
        </param>
        <briefdescription>
<para>returns rank of shared dataset </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>id</parametername>
</parameternamelist>
<parameterdescription>
<para>ID of the dataset. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>integer rank of dataset. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="1212" column="5" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="1212" bodyend="1238"/>
      </memberdef>
      <memberdef kind="function" id="api_8c_1a4f699b71886c24e17b68028c6582449b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="fti-intern_8h_1a93fc516f1fbe5fb3d37e6527684b8dd4" kindref="member">FTIT_hsize_t</ref> *</type>
        <definition>FTIT_hsize_t* FTI_GetDatasetSpan</definition>
        <argsstring>(int did, int rank)</argsstring>
        <name>FTI_GetDatasetSpan</name>
        <param>
          <type>int</type>
          <declname>did</declname>
        </param>
        <param>
          <type>int</type>
          <declname>rank</declname>
        </param>
        <briefdescription>
<para>returns static array of dataset dimensions </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>id</parametername>
</parameternamelist>
<parameterdescription>
<para>ID of the dataset. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>rank</parametername>
</parameternamelist>
<parameterdescription>
<para>Rank of the dataset. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="1248" column="14" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="1248" bodyend="1283"/>
      </memberdef>
      <memberdef kind="function" id="api_8c_1a79b24fc99e9cb826b2ad1d0cb6185882" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FTI_RecoverDatasetDimension</definition>
        <argsstring>(int did)</argsstring>
        <name>FTI_RecoverDatasetDimension</name>
        <param>
          <type>int</type>
          <declname>did</declname>
        </param>
        <briefdescription>
<para>loads dataset dimension from ckpt file to dataset &apos;did&apos; </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>id</parametername>
</parameternamelist>
<parameterdescription>
<para>ID of the dataset. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="1291" column="5" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="1291" bodyend="1350"/>
      </memberdef>
      <memberdef kind="function" id="api_8c_1af4cb738277e5d80c40f10491015395cb" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FTI_DefineDataset</definition>
        <argsstring>(int id, int rank, int *dimLength, char *name, FTIT_H5Group *h5group)</argsstring>
        <name>FTI_DefineDataset</name>
        <param>
          <type>int</type>
          <declname>id</declname>
        </param>
        <param>
          <type>int</type>
          <declname>rank</declname>
        </param>
        <param>
          <type>int *</type>
          <declname>dimLength</declname>
        </param>
        <param>
          <type>char *</type>
          <declname>name</declname>
        </param>
        <param>
          <type><ref refid="structFTIT__H5Group" kindref="compound">FTIT_H5Group</ref> *</type>
          <declname>h5group</declname>
        </param>
        <briefdescription>
<para>Defines the dataset. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>id</parametername>
</parameternamelist>
<parameterdescription>
<para>ID for searches and update. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>rank</parametername>
</parameternamelist>
<parameterdescription>
<para>Rank of the array </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>dimLength</parametername>
</parameternamelist>
<parameterdescription>
<para>Dimention length for each rank </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>name</parametername>
</parameternamelist>
<parameterdescription>
<para>Name of the dataset in HDF5 file. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>h5group</parametername>
</parameternamelist>
<parameterdescription>
<para>Group of the dataset. If Null then &quot;/&quot; </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>integer FTI_SCES if successful.</para>
</simplesect>
This function gives FTI all information needed by HDF5 to correctly save the dataset in the checkpoint file. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="1367" column="5" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="1367" bodyend="1423"/>
      </memberdef>
      <memberdef kind="function" id="api_8c_1adb927ab62324ba774d8daf91afa01c76" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>long</type>
        <definition>long FTI_GetStoredSize</definition>
        <argsstring>(int id)</argsstring>
        <name>FTI_GetStoredSize</name>
        <param>
          <type>int</type>
          <declname>id</declname>
        </param>
        <briefdescription>
<para>Returns size saved in metadata of variable. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>id</parametername>
</parameternamelist>
<parameterdescription>
<para>Variable ID. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>long Returns size of variable or 0 if size not saved.</para>
</simplesect>
This function returns size of variable of given ID that is saved in metadata. This may be different from size of variable that is in the program. If this function it&apos;s called when recovery it returns size from metadata file, if it&apos;s called after checkpoint it returns size saved in temporary metadata. If there is no size saved in metadata it returns 0. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="1439" column="6" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="1439" bodyend="1464"/>
      </memberdef>
      <memberdef kind="function" id="api_8c_1a125d30b04650f470c0ca82a786e55e9d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void *</type>
        <definition>void* FTI_Realloc</definition>
        <argsstring>(int id, void *ptr)</argsstring>
        <name>FTI_Realloc</name>
        <param>
          <type>int</type>
          <declname>id</declname>
        </param>
        <param>
          <type>void *</type>
          <declname>ptr</declname>
        </param>
        <briefdescription>
<para>Reallocates dataset to last checkpoint size. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>id</parametername>
</parameternamelist>
<parameterdescription>
<para>Variable ID. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>ptr</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the variable. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>ptr Pointer if successful, NULL otherwise This function loads the checkpoint data size from the metadata file, reallacates memory and updates data size information. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="1476" column="6" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="1476" bodyend="1512"/>
      </memberdef>
      <memberdef kind="function" id="api_8c_1aa6acb36d29481cd0da05ee66f944c1e8" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FTI_BitFlip</definition>
        <argsstring>(int datasetID)</argsstring>
        <name>FTI_BitFlip</name>
        <param>
          <type>int</type>
          <declname>datasetID</declname>
        </param>
        <briefdescription>
<para>Bit-flip injection following the injection instructions. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>datasetID</parametername>
</parameternamelist>
<parameterdescription>
<para>ID of the dataset where to inject. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>integer FTI_SCES if successful.</para>
</simplesect>
This function injects the given number of bit-flips, at the given frequency and in the given location (rank, dataset, bit position). </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="1525" column="5" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="1525" bodyend="1567"/>
      </memberdef>
      <memberdef kind="function" id="api_8c_1a85ccf559fcbee51bd335ba2c6671eadf" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FTI_Checkpoint</definition>
        <argsstring>(int id, int level)</argsstring>
        <name>FTI_Checkpoint</name>
        <param>
          <type>int</type>
          <declname>id</declname>
        </param>
        <param>
          <type>int</type>
          <declname>level</declname>
        </param>
        <briefdescription>
<para>It takes the checkpoint and triggers the post-ckpt. work. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>id</parametername>
</parameternamelist>
<parameterdescription>
<para>Checkpoint ID. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>level</parametername>
</parameternamelist>
<parameterdescription>
<para>Checkpoint level. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>integer FTI_SCES if successful.</para>
</simplesect>
This function starts by blocking on a receive if the previous ckpt. was offline. Then, it updates the ckpt. information. It writes down the ckpt. data, creates the metadata and the post-processing work. This function is complementary with the FTI_Listen function in terms of communications. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="1583" column="5" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="1583" bodyend="1697"/>
        <references refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" compoundref="fti_8h" startline="12">FTI_BUFS</references>
      </memberdef>
      <memberdef kind="function" id="api_8c_1a7cd136cac151e0a71320ff3f80215e25" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FTI_InitICP</definition>
        <argsstring>(int id, int level, bool activate)</argsstring>
        <name>FTI_InitICP</name>
        <param>
          <type>int</type>
          <declname>id</declname>
        </param>
        <param>
          <type>int</type>
          <declname>level</declname>
        </param>
        <param>
          <type>bool</type>
          <declname>activate</declname>
        </param>
        <briefdescription>
<para>Initialize an incremental checkpoint. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>id</parametername>
</parameternamelist>
<parameterdescription>
<para>Checkpoint ID. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>level</parametername>
</parameternamelist>
<parameterdescription>
<para>Checkpoint level. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>activate</parametername>
</parameternamelist>
<parameterdescription>
<para>Boolean expression. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>integer FTI_SCES if successful.</para>
</simplesect>
This function defines the environment for the incremental checkpointing mechanism. The iCP mechanism consists of three functions: FTI_InitICP, FTI_AddVarICP and FTI_FinalizeICP. The two functions FTI_InitICP and FTI_FinalizeICP define the iCP region within the user may write the protected variables in any order. The iCP region is active, when the expression passed through &apos;activate&apos; evaluates to TRUE.</para>
<para><simplesect kind="note"><para>This function is not blocking for POSIX, FTI-FF and HDF5, but, blocking for MPI-IO. This is due to the collective open call in MPI_IO </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="1718" column="5" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="1718" bodyend="1823"/>
      </memberdef>
      <memberdef kind="function" id="api_8c_1a8eb9b278fa5aa30e53ca4ad8baf95ba1" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FTI_AddVarICP</definition>
        <argsstring>(int varID)</argsstring>
        <name>FTI_AddVarICP</name>
        <param>
          <type>int</type>
          <declname>varID</declname>
        </param>
        <briefdescription>
<para>Write variable into the CP file. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>id</parametername>
</parameternamelist>
<parameterdescription>
<para>Protected variable ID. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>integer FTI_SCES if successful.</para>
</simplesect>
With this function, the user may write the protected datasets in any order into the checkpoint file. However, before the call to FTI_FinalizeICP, all protected variables must have been written into the file. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="1837" column="5" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="1837" bodyend="1890"/>
      </memberdef>
      <memberdef kind="function" id="api_8c_1ab21e904a57a97bef0b20c1afbe0d868d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FTI_FinalizeICP</definition>
        <argsstring>()</argsstring>
        <name>FTI_FinalizeICP</name>
        <briefdescription>
<para>Finalize an incremental checkpoint. </para>
        </briefdescription>
        <detaileddescription>
<para><simplesect kind="return"><para>integer FTI_SCES if successful.</para>
</simplesect>
This function finalizes an incremental checkpoint. In contrast to InitICP, this function is collective on the communicator FTI_COMM_WORLD and blocking. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="1902" column="5" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="1902" bodyend="2022"/>
      </memberdef>
      <memberdef kind="function" id="api_8c_1ab761c55656aab212daf8e6f447ec2214" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FTI_Recover</definition>
        <argsstring>()</argsstring>
        <name>FTI_Recover</name>
        <briefdescription>
<para>It loads the checkpoint data. </para>
        </briefdescription>
        <detaileddescription>
<para><simplesect kind="return"><para>integer FTI_SCES if successful.</para>
</simplesect>
This function loads the checkpoint data from the checkpoint file and it updates some basic checkpoint information. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="2034" column="5" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="2034" bodyend="2176"/>
      </memberdef>
      <memberdef kind="function" id="api_8c_1a6cbf6d6f6b4181e314eef599f85d6c5b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FTI_Snapshot</definition>
        <argsstring>()</argsstring>
        <name>FTI_Snapshot</name>
        <briefdescription>
<para>Takes an FTI snapshot or recovers the data if it is a restart. </para>
        </briefdescription>
        <detaileddescription>
<para><simplesect kind="return"><para>integer FTI_SCES if successful.</para>
</simplesect>
This function loads the checkpoint data from the checkpoint file in case of restart. Otherwise, it checks if the current iteration requires checkpointing, if it does it checks which checkpoint level, write the data in the files and it communicates with the head of the node to inform that a checkpoint has been taken. Checkpoint ID and counters are updated. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="2191" column="5" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="2191" bodyend="2244"/>
      </memberdef>
      <memberdef kind="function" id="api_8c_1aa58102aa8540ed35f2efba23cf2dc19b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FTI_Finalize</definition>
        <argsstring>()</argsstring>
        <name>FTI_Finalize</name>
        <briefdescription>
<para>It closes FTI properly on the application processes. </para>
        </briefdescription>
        <detaileddescription>
<para><simplesect kind="return"><para>integer FTI_SCES if successful.</para>
</simplesect>
This function notifies the FTI processes that the execution is over, frees some data structures and it closes. If this function is not called on the application processes the FTI processes will never finish (deadlock). </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="2257" column="5" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="2257" bodyend="2392"/>
      </memberdef>
      <memberdef kind="function" id="api_8c_1a25b793276f5e79e5947e133abdd52c1e" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FTI_RecoverVar</definition>
        <argsstring>(int id)</argsstring>
        <name>FTI_RecoverVar</name>
        <param>
          <type>int</type>
          <declname>id</declname>
        </param>
        <briefdescription>
<para>During the restart, recovers the given variable. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>id</parametername>
</parameternamelist>
<parameterdescription>
<para>Variable to recover </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>int FTI_SCES if successful.</para>
</simplesect>
During a restart process, this function recovers the variable specified by the given id. No effect during a regular execution. The variable must have already been protected, otherwise, FTI_NSCS is returned. Improvements to be done:<itemizedlist>
<listitem><para>Open checkpoint file at FTI_Init, close it at FTI_Snapshot</para>
</listitem><listitem><para>Maintain a variable accumulating the offset as variable are protected during the restart to avoid doing the loop to calculate the offset in the checkpoint file. </para>
</listitem></itemizedlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="2410" column="9" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="2410" bodyend="2532"/>
        <references refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" compoundref="fti_8h" startline="12">FTI_BUFS</references>
        <references refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" compoundref="fti_8h" startline="20">FTI_NSCS</references>
      </memberdef>
      <memberdef kind="function" id="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void FTI_Print</definition>
        <argsstring>(char *msg, int priority)</argsstring>
        <name>FTI_Print</name>
        <param>
          <type>char *</type>
          <declname>msg</declname>
        </param>
        <param>
          <type>int</type>
          <declname>priority</declname>
        </param>
        <briefdescription>
<para>Prints FTI messages. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>msg</parametername>
</parameternamelist>
<parameterdescription>
<para>Message to print. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>priority</parametername>
</parameternamelist>
<parameterdescription>
<para>Priority of the message to be printed. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>void</para>
</simplesect>
This function prints messages depending on their priority and the verbosity level set by the user. DEBUG messages are printed by all processes with their rank. INFO messages are printed by one process. ERROR messages are printed with errno. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/bscuser/Documents/release/dev/fti/src/api.c" line="2548" column="10" bodyfile="/home/bscuser/Documents/release/dev/fti/src/api.c" bodystart="2548" bodyend="2576"/>
      </memberdef>
      </sectiondef>
    <briefdescription>
<para>API functions for the FTI library. </para>
    </briefdescription>
    <detaileddescription>
<para>Copyright (c) 2017 Leonardo A. Bautista-Gomez All rights reserved</para>
<para>FTI - A multi-level checkpointing library for C/C++/Fortran applications</para>
<para>Revision 1.0 : Fault Tolerance Interface (FTI)</para>
<para>Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</para>
<para><orderedlist>
<listitem><para>Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</para>
</listitem><listitem><para>Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</para>
</listitem><listitem><para>Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</para>
</listitem></orderedlist>
</para>
<para>THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</para>
<para><simplesect kind="date"><para>October, 2017 </para>
</simplesect>
</para>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"></codeline>
<codeline lineno="40"><highlight class="preprocessor">#include<sp/>&quot;<ref refid="interface_8h" kindref="compound">interface.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;IO/cuda-md5/md5Opt.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>GPUSUPPORT</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;cuda_runtime_api.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="45"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight></codeline>
<codeline lineno="48"><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="structFTIT__configuration" kindref="compound">FTIT_configuration</ref><sp/>FTI_Conf;</highlight></codeline>
<codeline lineno="49"><highlight class="normal"></highlight></codeline>
<codeline lineno="51"><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="structFTIT__checkpoint" kindref="compound">FTIT_checkpoint</ref><sp/>FTI_Ckpt[5];</highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight></codeline>
<codeline lineno="54"><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="structFTIT__execution" kindref="compound">FTIT_execution</ref><sp/>FTI_Exec;</highlight></codeline>
<codeline lineno="55"><highlight class="normal"></highlight></codeline>
<codeline lineno="57"><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="structFTIT__topology" kindref="compound">FTIT_topology</ref><sp/>FTI_Topo;</highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight></codeline>
<codeline lineno="60"><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="structFTIT__dataset" kindref="compound">FTIT_dataset</ref><sp/>FTI_Data[<ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>];</highlight></codeline>
<codeline lineno="61"><highlight class="normal"></highlight></codeline>
<codeline lineno="63"><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="structFTIT__injection" kindref="compound">FTIT_injection</ref><sp/>FTI_Inje;</highlight></codeline>
<codeline lineno="64"><highlight class="normal"></highlight></codeline>
<codeline lineno="66" refid="api_8c_1a7deaa5171fbf22fe59ae1c08f2bdcc97" refkind="member"><highlight class="normal">MPI_Comm<sp/><ref refid="api_8c_1a7deaa5171fbf22fe59ae1c08f2bdcc97" kindref="member">FTI_COMM_WORLD</ref>;</highlight></codeline>
<codeline lineno="67"><highlight class="normal"></highlight></codeline>
<codeline lineno="69" refid="api_8c_1af384b54744550e2300db530ef46f7e77" refkind="member"><highlight class="normal"><ref refid="structFTIT__type" kindref="compound">FTIT_type</ref><sp/><ref refid="api_8c_1af384b54744550e2300db530ef46f7e77" kindref="member">FTI_CHAR</ref>;</highlight></codeline>
<codeline lineno="71" refid="api_8c_1a7f97366acb17493ec718fb6086f1ac3c" refkind="member"><highlight class="normal"><ref refid="structFTIT__type" kindref="compound">FTIT_type</ref><sp/><ref refid="api_8c_1a7f97366acb17493ec718fb6086f1ac3c" kindref="member">FTI_SHRT</ref>;</highlight></codeline>
<codeline lineno="73" refid="api_8c_1ad236df2303494837c97a13741423a51b" refkind="member"><highlight class="normal"><ref refid="structFTIT__type" kindref="compound">FTIT_type</ref><sp/><ref refid="api_8c_1ad236df2303494837c97a13741423a51b" kindref="member">FTI_INTG</ref>;</highlight></codeline>
<codeline lineno="75" refid="api_8c_1a29acf773174ad269577b5c771521694a" refkind="member"><highlight class="normal"><ref refid="structFTIT__type" kindref="compound">FTIT_type</ref><sp/><ref refid="api_8c_1a29acf773174ad269577b5c771521694a" kindref="member">FTI_LONG</ref>;</highlight></codeline>
<codeline lineno="77" refid="api_8c_1a2a1ee34ef81027534671ee3145a89213" refkind="member"><highlight class="normal"><ref refid="structFTIT__type" kindref="compound">FTIT_type</ref><sp/><ref refid="api_8c_1a2a1ee34ef81027534671ee3145a89213" kindref="member">FTI_UCHR</ref>;</highlight></codeline>
<codeline lineno="79" refid="api_8c_1ad00601a105ae08e82837c629b8e55612" refkind="member"><highlight class="normal"><ref refid="structFTIT__type" kindref="compound">FTIT_type</ref><sp/><ref refid="api_8c_1ad00601a105ae08e82837c629b8e55612" kindref="member">FTI_USHT</ref>;</highlight></codeline>
<codeline lineno="81" refid="api_8c_1a1e77437528f3df560360e0626b9a3b89" refkind="member"><highlight class="normal"><ref refid="structFTIT__type" kindref="compound">FTIT_type</ref><sp/><ref refid="api_8c_1a1e77437528f3df560360e0626b9a3b89" kindref="member">FTI_UINT</ref>;</highlight></codeline>
<codeline lineno="83" refid="api_8c_1afdc10ccdf5f020d7b0306ecce07f52c1" refkind="member"><highlight class="normal"><ref refid="structFTIT__type" kindref="compound">FTIT_type</ref><sp/><ref refid="api_8c_1afdc10ccdf5f020d7b0306ecce07f52c1" kindref="member">FTI_ULNG</ref>;</highlight></codeline>
<codeline lineno="85" refid="api_8c_1a39b15455ede057260e435cf49bc3ee6d" refkind="member"><highlight class="normal"><ref refid="structFTIT__type" kindref="compound">FTIT_type</ref><sp/><ref refid="api_8c_1a39b15455ede057260e435cf49bc3ee6d" kindref="member">FTI_SFLT</ref>;</highlight></codeline>
<codeline lineno="87" refid="api_8c_1aafb3604bd7ebfae406d1c419890e04d8" refkind="member"><highlight class="normal"><ref refid="structFTIT__type" kindref="compound">FTIT_type</ref><sp/><ref refid="api_8c_1aafb3604bd7ebfae406d1c419890e04d8" kindref="member">FTI_DBLE</ref>;</highlight></codeline>
<codeline lineno="89" refid="api_8c_1acd10e7ef980b4ed3d775bb499cfac8ba" refkind="member"><highlight class="normal"><ref refid="structFTIT__type" kindref="compound">FTIT_type</ref><sp/><ref refid="api_8c_1acd10e7ef980b4ed3d775bb499cfac8ba" kindref="member">FTI_LDBE</ref>;</highlight></codeline>
<codeline lineno="90"><highlight class="normal"></highlight></codeline>
<codeline lineno="91"><highlight class="normal"></highlight></codeline>
<codeline lineno="92"><highlight class="normal"></highlight></codeline>
<codeline lineno="93"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="106"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="107" refid="api_8c_1abe8c2b202eaab996bbd88eea4cafe51a" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="api_8c_1abe8c2b202eaab996bbd88eea4cafe51a" kindref="member">FTI_Init</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>configFile,<sp/>MPI_Comm<sp/>globalComm)</highlight></codeline>
<codeline lineno="108"><highlight class="normal">{</highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="110"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>ENABLE_FTI_FI_IO</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="failure-injection_8c_1a7acbcfc49eb071c72fcd452dbf00c197" kindref="member">FTI_InitFIIO</ref>();</highlight></codeline>
<codeline lineno="112"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="113"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>ENABLE_HDF5</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/>H5Eset_auto2(0,0,<sp/>NULL);</highlight></codeline>
<codeline lineno="115"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="tools_8c_1ad95399f229aa8c9ae4aef2574d732f7d" kindref="member">FTI_InitExecVars</ref>(&amp;FTI_Conf,<sp/>&amp;FTI_Exec,<sp/>&amp;FTI_Topo,<sp/>FTI_Ckpt,<sp/>&amp;FTI_Inje);</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a9cbca3e2e49bb808bc73569db3fdecb2" kindref="member">globalComm</ref><sp/>=<sp/>globalComm;</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/>MPI_Comm_rank(FTI_Exec.<ref refid="structFTIT__execution_1a9cbca3e2e49bb808bc73569db3fdecb2" kindref="member">globalComm</ref>,<sp/>&amp;FTI_Topo.<ref refid="structFTIT__topology_1afd9e834e60e98abbce232192a38a7d58" kindref="member">myRank</ref>);</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/>MPI_Comm_size(FTI_Exec.<ref refid="structFTIT__execution_1a9cbca3e2e49bb808bc73569db3fdecb2" kindref="member">globalComm</ref>,<sp/>&amp;FTI_Topo.<ref refid="structFTIT__topology_1a1ea262b4b51c8134cc3fec8fda8b1836" kindref="member">nbProc</ref>);</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/>snprintf(FTI_Conf.<ref refid="structFTIT__configuration_1af677514300ce3b22d4a5d291c3f9d2ee" kindref="member">cfgFile</ref>,<sp/><ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;%s&quot;</highlight><highlight class="normal">,<sp/>configFile);</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Conf.<ref refid="structFTIT__configuration_1a2776919d74dd1310a03eb046a1c16d0f" kindref="member">verbosity</ref><sp/>=<sp/>1;<sp/></highlight><highlight class="comment">//Temporary<sp/>needed<sp/>for<sp/>output<sp/>in<sp/>FTI_LoadConf.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a5ff8dd064b2a4cc4b7272abddacb8cc1" kindref="member">initSCES</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Inje.<ref refid="structFTIT__injection_1a95bf2ff87b433ce58c6a228b9baf164a" kindref="member">timer</ref><sp/>=<sp/>MPI_Wtime();</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="api_8c_1a7deaa5171fbf22fe59ae1c08f2bdcc97" kindref="member">FTI_COMM_WORLD</ref><sp/>=<sp/>globalComm;<sp/></highlight><highlight class="comment">//<sp/>Temporary<sp/>before<sp/>building<sp/>topology.<sp/>Needed<sp/>in<sp/>FTI_LoadConf<sp/>and<sp/>FTI_Topology<sp/>to<sp/>communicate.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Topo.<ref refid="structFTIT__topology_1a3d4083051c43d031972d83cffb242a38" kindref="member">splitRank</ref><sp/>=<sp/>FTI_Topo.<ref refid="structFTIT__topology_1afd9e834e60e98abbce232192a38a7d58" kindref="member">myRank</ref>;<sp/></highlight><highlight class="comment">//<sp/>Temporary<sp/>before<sp/>building<sp/>topology.<sp/>Needed<sp/>in<sp/>FTI_Print.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>res<sp/>=<sp/><ref refid="tools_8c_1a950803008f7cef4892fbba9b2069928e" kindref="member">FTI_Try</ref>(<ref refid="conf_8c_1a89e78abb2e98f65c3d65e2979550e99d" kindref="member">FTI_LoadConf</ref>(&amp;FTI_Conf,<sp/>&amp;FTI_Exec,<sp/>&amp;FTI_Topo,<sp/>FTI_Ckpt,<sp/>&amp;FTI_Inje),<sp/></highlight><highlight class="stringliteral">&quot;load<sp/>configuration.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>)<sp/>{</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="tools_8c_1a950803008f7cef4892fbba9b2069928e" kindref="member">FTI_Try</ref>(<ref refid="topo_8c_1aeff729c7cc86f39b20d320ead76aa2b6" kindref="member">FTI_Topology</ref>(&amp;FTI_Conf,<sp/>&amp;FTI_Exec,<sp/>&amp;FTI_Topo),<sp/></highlight><highlight class="stringliteral">&quot;build<sp/>topology.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>)<sp/>{</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="tools_8c_1a950803008f7cef4892fbba9b2069928e" kindref="member">FTI_Try</ref>(<ref refid="tools_8c_1ad41f9b1988730c56c052047cfb3f6283" kindref="member">FTI_InitGroupsAndTypes</ref>(&amp;FTI_Exec),<sp/></highlight><highlight class="stringliteral">&quot;malloc<sp/>arrays<sp/>for<sp/>groups<sp/>and<sp/>types.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="tools_8c_1a950803008f7cef4892fbba9b2069928e" kindref="member">FTI_Try</ref>(<ref refid="tools_8c_1a924446571112185f563d5ec1e386afb1" kindref="member">FTI_InitBasicTypes</ref>(FTI_Data),<sp/></highlight><highlight class="stringliteral">&quot;create<sp/>the<sp/>basic<sp/>data<sp/>types.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Topo.<ref refid="structFTIT__topology_1afd9e834e60e98abbce232192a38a7d58" kindref="member">myRank</ref><sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>restart<sp/>=<sp/>(FTI_Exec.<ref refid="structFTIT__execution_1a061085b1c93b22c4fafbe527e7b1f165" kindref="member">reco</ref><sp/>!=<sp/>3)<sp/>?<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a061085b1c93b22c4fafbe527e7b1f165" kindref="member">reco</ref><sp/>:<sp/>0;</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tools_8c_1a950803008f7cef4892fbba9b2069928e" kindref="member">FTI_Try</ref>(<ref refid="conf_8c_1a072119e00ecaef96e6b516174beb0321" kindref="member">FTI_UpdateConf</ref>(&amp;FTI_Conf,<sp/>&amp;FTI_Exec,<sp/>restart),<sp/></highlight><highlight class="stringliteral">&quot;update<sp/>configuration<sp/>file.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/>MPI_Barrier(FTI_Exec.<ref refid="structFTIT__execution_1a9cbca3e2e49bb808bc73569db3fdecb2" kindref="member">globalComm</ref>);<sp/></highlight><highlight class="comment">//wait<sp/>for<sp/>myRank<sp/>==<sp/>0<sp/>process<sp/>to<sp/>save<sp/>config<sp/>file</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="tools_8c_1a803fddbbbdc2e160a5cb4249100e8a00" kindref="member">FTI_MallocMeta</ref>(&amp;FTI_Exec,<sp/>&amp;FTI_Topo);</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="tools_8c_1a950803008f7cef4892fbba9b2069928e" kindref="member">FTI_Try</ref>(<ref refid="meta_8c_1afce9f65bec69ebda8443d7038a762dff" kindref="member">FTI_LoadMeta</ref>(&amp;FTI_Conf,<sp/>&amp;FTI_Exec,<sp/>&amp;FTI_Topo,<sp/>FTI_Ckpt),<sp/></highlight><highlight class="stringliteral">&quot;load<sp/>metadata&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>)<sp/>{</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tools_8c_1a099b42118594b7ec8469348819bfaf93" kindref="member">FTI_FreeMeta</ref>(&amp;FTI_Exec);</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>FTI_Conf.<ref refid="structFTIT__configuration_1a5853fc734fbdc50680125595e6cc4f74" kindref="member">ioMode</ref><sp/>==<sp/><ref refid="fti-intern_8h_1a2b6ae4a8dc77345c8aa9497f8cb9291b" kindref="member">FTI_IO_FTIFF</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTIFF_InitMpiTypes();</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>FTI_Conf.<ref refid="structFTIT__configuration_1ae6c297d0a3c6e122ee63085f2a365a30" kindref="member">stagingEnabled</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="stage_8c_1a46b8c1f1c37f48eb4261fc646e460478" kindref="member">FTI_InitStage</ref>(<sp/>&amp;FTI_Exec,<sp/>&amp;FTI_Conf,<sp/>&amp;FTI_Topo<sp/>);</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="153"><highlight class="normal"></highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>FTI_Conf.<ref refid="structFTIT__configuration_1a5853fc734fbdc50680125595e6cc4f74" kindref="member">ioMode</ref><sp/>==<sp/><ref refid="fti-intern_8h_1ace2ba9a1f6bf621481f19d0ac9aaf839" kindref="member">FTI_IO_HDF5</ref>){</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>strcpy(FTI_Conf.<ref refid="structFTIT__configuration_1a0894284fb39ed4715b9841771717c8c3" kindref="member">suffix</ref>,</highlight><highlight class="stringliteral">&quot;h5&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>strcpy(FTI_Conf.<ref refid="structFTIT__configuration_1a0894284fb39ed4715b9841771717c8c3" kindref="member">suffix</ref>,</highlight><highlight class="stringliteral">&quot;fti&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a5ff8dd064b2a4cc4b7272abddacb8cc1" kindref="member">initSCES</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Topo.<ref refid="structFTIT__topology_1ad44da908f25f84e0dc29086b77b37d8d" kindref="member">amIaHead</ref>)<sp/>{<sp/></highlight><highlight class="comment">//<sp/>If<sp/>I<sp/>am<sp/>a<sp/>FTI<sp/>dedicated<sp/>process</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Exec.<ref refid="structFTIT__execution_1a061085b1c93b22c4fafbe527e7b1f165" kindref="member">reco</ref>)<sp/>{</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="tools_8c_1a950803008f7cef4892fbba9b2069928e" kindref="member">FTI_Try</ref>(<ref refid="recover_8c_1aa5ca92e3168d5b1ee7830507f8847dec" kindref="member">FTI_RecoverFiles</ref>(&amp;FTI_Conf,<sp/>&amp;FTI_Exec,<sp/>&amp;FTI_Topo,<sp/>FTI_Ckpt),<sp/></highlight><highlight class="stringliteral">&quot;recover<sp/>the<sp/>checkpoint<sp/>files.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>!=<sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>)<sp/>{</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a061085b1c93b22c4fafbe527e7b1f165" kindref="member">reco</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a5ff8dd064b2a4cc4b7272abddacb8cc1" kindref="member">initSCES</ref><sp/>=<sp/>2;<sp/></highlight><highlight class="comment">//Could<sp/>not<sp/>recover<sp/>all<sp/>ckpt<sp/>files</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="checkpoint_8c_1a305fb1ae4c686e64fe62c9429d2f4f4c" kindref="member">FTI_Listen</ref>(&amp;FTI_Conf,<sp/>&amp;FTI_Exec,<sp/>&amp;FTI_Topo,<sp/>FTI_Ckpt);<sp/></highlight><highlight class="comment">//infinite<sp/>loop<sp/>inside,<sp/>can<sp/>stop<sp/>only<sp/>by<sp/>callling<sp/>FTI_Finalize</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>FTI_Listen<sp/>only<sp/>returns<sp/>if<sp/>FTI_Conf.keepHeadsAlive<sp/>is<sp/>TRUE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a13af42079571ed8dd290fad82fd11c2d" kindref="member">FTI_HEAD</ref>;</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/></highlight><highlight class="comment">//<sp/>If<sp/>I<sp/>am<sp/>an<sp/>application<sp/>process</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/><ref refid="tools_8c_1a950803008f7cef4892fbba9b2069928e" kindref="member">FTI_Try</ref>(<sp/><ref refid="api-cuda_8c_1acd3640ea0b47f0f4b34b9e11294290e1" kindref="member">FTI_InitDevices</ref>(FTI_Conf.<ref refid="structFTIT__configuration_1aff3e9bbbb6a121c29c5efac2c73264b8" kindref="member">cHostBufSize</ref>),<sp/></highlight><highlight class="stringliteral">&quot;Allocating<sp/>resources<sp/>for<sp/>communication<sp/>with<sp/>the<sp/>devices&quot;</highlight><highlight class="normal">)<sp/>!=<sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>){</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;Cannot<sp/>Allocate<sp/>defice<sp/>memory\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a5cb1252ae17ef4ac13b3dbe5a8b1ab13" kindref="member">FTI_EROR</ref>);</highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/><ref refid="tools_8c_1a950803008f7cef4892fbba9b2069928e" kindref="member">FTI_Try</ref>(<ref refid="fti-io_8c_1a82389b45effbf23533c3377f24d8956c" kindref="member">FTI_InitFunctionPointers</ref>(FTI_Conf.<ref refid="structFTIT__configuration_1a5853fc734fbdc50680125595e6cc4f74" kindref="member">ioMode</ref>,<sp/>&amp;FTI_Exec),</highlight><highlight class="stringliteral">&quot;Initializing<sp/>IO<sp/>pointers&quot;</highlight><highlight class="normal">)<sp/>!=<sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>){</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;Cannot<sp/>define<sp/>the<sp/>function<sp/>pointers\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a5cb1252ae17ef4ac13b3dbe5a8b1ab13" kindref="member">FTI_EROR</ref>);</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="180"><highlight class="normal"></highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>call<sp/>in<sp/>any<sp/>case.<sp/>treatment<sp/>for<sp/>diffCkpt<sp/>disabled<sp/>inside<sp/>initializer.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>FTI_Conf.<ref refid="structFTIT__configuration_1aae6a605160c14bd0f0174d9aa94b4183" kindref="member">dcpFtiff</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_InitDcp(<sp/>&amp;FTI_Conf,<sp/>&amp;FTI_Exec,<sp/>FTI_Data<sp/>);</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Conf.<ref refid="structFTIT__configuration_1a5e319b258138bbb03d5da9917f99acd6" kindref="member">dcpPosix</ref><sp/><sp/>){</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_initMD5(FTI_Conf.<ref refid="structFTIT__configuration_1a082b3136afb25beb45f0c9ece72ddca7" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpConfigurationPosix_1a639ec25941ab5eac6d6c22ebc7fc232e" kindref="member">BlockSize</ref>,<sp/>32*1024*1024,<sp/>&amp;FTI_Conf);<sp/></highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Exec.<ref refid="structFTIT__execution_1a061085b1c93b22c4fafbe527e7b1f165" kindref="member">reco</ref>)<sp/>{</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="tools_8c_1a950803008f7cef4892fbba9b2069928e" kindref="member">FTI_Try</ref>(<ref refid="recover_8c_1aa5ca92e3168d5b1ee7830507f8847dec" kindref="member">FTI_RecoverFiles</ref>(&amp;FTI_Conf,<sp/>&amp;FTI_Exec,<sp/>&amp;FTI_Topo,<sp/>FTI_Ckpt),<sp/></highlight><highlight class="stringliteral">&quot;recover<sp/>the<sp/>checkpoint<sp/>files.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Conf.<ref refid="structFTIT__configuration_1a5853fc734fbdc50680125595e6cc4f74" kindref="member">ioMode</ref><sp/>==<sp/><ref refid="fti-intern_8h_1a2b6ae4a8dc77345c8aa9497f8cb9291b" kindref="member">FTI_IO_FTIFF</ref><sp/>&amp;&amp;<sp/>res<sp/>==<sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>)<sp/>{</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>+=<sp/><ref refid="tools_8c_1a950803008f7cef4892fbba9b2069928e" kindref="member">FTI_Try</ref>(<sp/>FTIFF_ReadDbFTIFF(<sp/>&amp;FTI_Conf,<sp/>&amp;FTI_Exec,<sp/>FTI_Ckpt<sp/>),<sp/></highlight><highlight class="stringliteral">&quot;Read<sp/>FTIFF<sp/>meta<sp/>information&quot;</highlight><highlight class="normal"><sp/>);</highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a590db72f82171781a3ac02de59b350f6" kindref="member">ckptCnt</ref><sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1afe4ababcb4c2ea0a21a87b237f8d7a00" kindref="member">ckptID</ref>;</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a590db72f82171781a3ac02de59b350f6" kindref="member">ckptCnt</ref>++;</highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>!=<sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>)<sp/>{</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a061085b1c93b22c4fafbe527e7b1f165" kindref="member">reco</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a5ff8dd064b2a4cc4b7272abddacb8cc1" kindref="member">initSCES</ref><sp/>=<sp/>2;<sp/></highlight><highlight class="comment">//Could<sp/>not<sp/>recover<sp/>all<sp/>ckpt<sp/>files<sp/>(or<sp/>failed<sp/>reading<sp/>meta;<sp/>FTI-FF)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;FTI<sp/>has<sp/>been<sp/>initialized.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a26a561f0e03eec3d15541c85a2a21ffd" kindref="member">FTI_INFO</ref>);</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1ac879dcdb853f4b5993ceed9fb1d06e88" kindref="member">FTI_NREC</ref>;</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a6b8b6b1922b2561d237b1097a2ea14ef" kindref="member">hasCkpt</ref><sp/>=<sp/>(FTI_Exec.<ref refid="structFTIT__execution_1a061085b1c93b22c4fafbe527e7b1f165" kindref="member">reco</ref><sp/>==<sp/>3)<sp/>?<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal"><sp/>:<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;FTI<sp/>has<sp/>been<sp/>initialized.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a26a561f0e03eec3d15541c85a2a21ffd" kindref="member">FTI_INFO</ref>);</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="206"><highlight class="normal"></highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(<sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/><ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>;<sp/>i++){</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>memset(FTI_Data[i].idChar,</highlight><highlight class="charliteral">&apos;\0&apos;</highlight><highlight class="normal">,<ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>);</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="210"><highlight class="normal">}</highlight></codeline>
<codeline lineno="215"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="223"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="224" refid="api_8c_1a5222b52e6f1d6b737f4ec1b173f362f5" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="api_8c_1a5222b52e6f1d6b737f4ec1b173f362f5" kindref="member">FTI_Status</ref>()</highlight></codeline>
<codeline lineno="225"><highlight class="normal">{</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a061085b1c93b22c4fafbe527e7b1f165" kindref="member">reco</ref>;</highlight></codeline>
<codeline lineno="227"><highlight class="normal">}</highlight></codeline>
<codeline lineno="228"><highlight class="normal"></highlight></codeline>
<codeline lineno="229"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="241"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="242" refid="api_8c_1a725ffe84dd16beb533e7b4b74fa4e9c4" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="api_8c_1a725ffe84dd16beb533e7b4b74fa4e9c4" kindref="member">FTI_InitType</ref>(<ref refid="structFTIT__type" kindref="compound">FTIT_type</ref>*<sp/>type,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>size)</highlight></codeline>
<codeline lineno="243"><highlight class="normal">{<sp/><sp/></highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/>type-&gt;<ref refid="structFTIT__type_1a75237aa3e6824b450ee623bffb36608a" kindref="member">id</ref><sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1ae9e0a0b1ee8bd41e2b6251a597b47d26" kindref="member">nbType</ref>;</highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/>type-&gt;<ref refid="structFTIT__type_1ae849a5abd72710611f1830155f2ce6c4" kindref="member">size</ref><sp/>=<sp/>size;</highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/>type-&gt;<ref refid="structFTIT__type_1ae931b22aad8086d44a71e90228406f1e" kindref="member">structure</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="247"><highlight class="normal"></highlight></codeline>
<codeline lineno="248"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>ENABLE_HDF5</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/>type-&gt;<ref refid="structFTIT__type_1a1e9f285bee0c9f0989e8caef442fd084" kindref="member">h5group</ref><sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a896039ee736e3c0676fe13df8b1ac345" kindref="member">H5groups</ref>[0];</highlight></codeline>
<codeline lineno="250"><highlight class="normal"></highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Maps<sp/>FTI<sp/>types<sp/>to<sp/>HDF5<sp/>types</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(FTI_Exec.<ref refid="structFTIT__execution_1ae9e0a0b1ee8bd41e2b6251a597b47d26" kindref="member">nbType</ref>)<sp/>{</highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>0:</highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>type-&gt;h5datatype<sp/>=<sp/>H5T_NATIVE_CHAR;<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>1:</highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>type-&gt;h5datatype<sp/>=<sp/>H5T_NATIVE_SHORT;<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>2:</highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>type-&gt;h5datatype<sp/>=<sp/>H5T_NATIVE_INT;<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>3:</highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>type-&gt;h5datatype<sp/>=<sp/>H5T_NATIVE_LONG;<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>4:</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>type-&gt;h5datatype<sp/>=<sp/>H5T_NATIVE_UCHAR;<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>5:</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>type-&gt;h5datatype<sp/>=<sp/>H5T_NATIVE_USHORT;<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>6:</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>type-&gt;h5datatype<sp/>=<sp/>H5T_NATIVE_UINT;<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>7:</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>type-&gt;h5datatype<sp/>=<sp/>H5T_NATIVE_ULONG;<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>8:</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>type-&gt;h5datatype<sp/>=<sp/>H5T_NATIVE_FLOAT;<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>9:</highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>type-&gt;h5datatype<sp/>=<sp/>H5T_NATIVE_DOUBLE;<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>10:</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>type-&gt;h5datatype<sp/>=<sp/>H5T_NATIVE_LDOUBLE;<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>type-&gt;h5datatype<sp/>=<sp/>-1;<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/></highlight><highlight class="comment">//to<sp/>mark<sp/>as<sp/>closed</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="278"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="279"><highlight class="normal"></highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//make<sp/>a<sp/>clone<sp/>of<sp/>the<sp/>type<sp/>in<sp/>case<sp/>the<sp/>user<sp/>won&apos;t<sp/>store<sp/>pointer</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a6cbf8f36622f495540e6af68525013d6" kindref="member">FTI_Type</ref>[FTI_Exec.<ref refid="structFTIT__execution_1ae9e0a0b1ee8bd41e2b6251a597b47d26" kindref="member">nbType</ref>]<sp/>=<sp/>malloc(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structFTIT__type" kindref="compound">FTIT_type</ref>));</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/>*FTI_Exec.<ref refid="structFTIT__execution_1a6cbf8f36622f495540e6af68525013d6" kindref="member">FTI_Type</ref>[FTI_Exec.<ref refid="structFTIT__execution_1ae9e0a0b1ee8bd41e2b6251a597b47d26" kindref="member">nbType</ref>]<sp/>=<sp/>*type;</highlight></codeline>
<codeline lineno="283"><highlight class="normal"></highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1ae9e0a0b1ee8bd41e2b6251a597b47d26" kindref="member">nbType</ref><sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1ae9e0a0b1ee8bd41e2b6251a597b47d26" kindref="member">nbType</ref><sp/>+<sp/>1;</highlight></codeline>
<codeline lineno="285"><highlight class="normal"></highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="287"><highlight class="normal">}</highlight></codeline>
<codeline lineno="288"><highlight class="normal"></highlight></codeline>
<codeline lineno="289"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="309"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="310" refid="api_8c_1a7fab7e8f18c24f415dc658714c27c669" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="api_8c_1a7fab7e8f18c24f415dc658714c27c669" kindref="member">FTI_InitComplexType</ref>(<ref refid="structFTIT__type" kindref="compound">FTIT_type</ref>*<sp/>newType,<sp/><ref refid="structFTIT__complexType" kindref="compound">FTIT_complexType</ref>*<sp/>typeDefinition,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>length,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>size,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>name,<sp/><ref refid="structFTIT__H5Group" kindref="compound">FTIT_H5Group</ref>*<sp/>h5group)</highlight></codeline>
<codeline lineno="311"><highlight class="normal">{</highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(h5group<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>h5group<sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a896039ee736e3c0676fe13df8b1ac345" kindref="member">H5groups</ref>[0];</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(length<sp/>&lt;<sp/>1)<sp/>{</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;Type<sp/>can&apos;t<sp/>conain<sp/>less<sp/>than<sp/>1<sp/>type.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(length<sp/>&gt;<sp/>255)<sp/>{</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;Type<sp/>can&apos;t<sp/>conain<sp/>more<sp/>than<sp/>255<sp/>types.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>length;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(typeDefinition-&gt;<ref refid="structFTIT__complexType_1abbb9d041a59fd4972244d8c62e78dbaa" kindref="member">field</ref>[i].<ref refid="structFTIT__typeField_1ad46ee30f23a6af1c5ac85ecce834cdc2" kindref="member">rank</ref><sp/>&lt;<sp/>1)<sp/>{</highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;Type<sp/>rank<sp/>must<sp/>be<sp/>greater<sp/>than<sp/>0.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(typeDefinition-&gt;<ref refid="structFTIT__complexType_1abbb9d041a59fd4972244d8c62e78dbaa" kindref="member">field</ref>[i].<ref refid="structFTIT__typeField_1ad46ee30f23a6af1c5ac85ecce834cdc2" kindref="member">rank</ref><sp/>&gt;<sp/>32)<sp/>{</highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;Maximum<sp/>rank<sp/>is<sp/>32.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>j;</highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(j<sp/>=<sp/>0;<sp/>j<sp/>&lt;<sp/>typeDefinition-&gt;<ref refid="structFTIT__complexType_1abbb9d041a59fd4972244d8c62e78dbaa" kindref="member">field</ref>[i].<ref refid="structFTIT__typeField_1ad46ee30f23a6af1c5ac85ecce834cdc2" kindref="member">rank</ref>;<sp/>j++)<sp/>{</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(typeDefinition-&gt;<ref refid="structFTIT__complexType_1abbb9d041a59fd4972244d8c62e78dbaa" kindref="member">field</ref>[i].<ref refid="structFTIT__typeField_1af0e311f38f7f6b7ab7ff04e3897f6c37" kindref="member">dimLength</ref>[j]<sp/>&lt;<sp/>1)<sp/>{</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>str[<ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>];</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>snprintf(str,<sp/><ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;(%s,<sp/>index:<sp/>%d)<sp/>Type<sp/>dimention<sp/>length<sp/>must<sp/>be<sp/>greater<sp/>than<sp/>0.&quot;</highlight><highlight class="normal">,<sp/>typeDefinition-&gt;<ref refid="structFTIT__complexType_1abbb9d041a59fd4972244d8c62e78dbaa" kindref="member">field</ref>[i].<ref refid="structFTIT__typeField_1aa2dcf41b2455dd8b220587a655fcf73d" kindref="member">name</ref>,<sp/>i);</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(str,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="343"><highlight class="normal"></highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/>newType-&gt;<ref refid="structFTIT__type_1a75237aa3e6824b450ee623bffb36608a" kindref="member">id</ref><sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1ae9e0a0b1ee8bd41e2b6251a597b47d26" kindref="member">nbType</ref>;</highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/>newType-&gt;<ref refid="structFTIT__type_1ae849a5abd72710611f1830155f2ce6c4" kindref="member">size</ref><sp/>=<sp/>size;</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//assign<sp/>type<sp/>definition<sp/>to<sp/>type<sp/>structure<sp/>(types,<sp/>names,<sp/>ranks,<sp/>dimLengths)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/>typeDefinition-&gt;<ref refid="structFTIT__complexType_1a83307bb041927b502b49d9e69ae5af9a" kindref="member">length</ref><sp/>=<sp/>length;</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(name<sp/>==<sp/>NULL<sp/>||<sp/>!strlen(name))<sp/>{</highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sprintf(typeDefinition-&gt;<ref refid="structFTIT__complexType_1a072814c3eb0fd1f8d47c7c64fa34c41d" kindref="member">name</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Type%d&quot;</highlight><highlight class="normal">,<sp/>newType-&gt;<ref refid="structFTIT__type_1a75237aa3e6824b450ee623bffb36608a" kindref="member">id</ref>);</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>strncpy(typeDefinition-&gt;<ref refid="structFTIT__complexType_1a072814c3eb0fd1f8d47c7c64fa34c41d" kindref="member">name</ref>,<sp/>name,<sp/><ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>);</highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="353"><highlight class="normal"></highlight></codeline>
<codeline lineno="354"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>ENABLE_HDF5</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/>newType-&gt;h5datatype<sp/>=<sp/>-1;<sp/></highlight><highlight class="comment">//to<sp/>mark<sp/>as<sp/>closed</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/>newType-&gt;<ref refid="structFTIT__type_1a1e9f285bee0c9f0989e8caef442fd084" kindref="member">h5group</ref><sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a896039ee736e3c0676fe13df8b1ac345" kindref="member">H5groups</ref>[h5group-&gt;<ref refid="structFTIT__H5Group_1a3de0568ad296bc36607c871f14f4daa0" kindref="member">id</ref>];</highlight></codeline>
<codeline lineno="357"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="358"><highlight class="normal"></highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//make<sp/>a<sp/>clone<sp/>of<sp/>the<sp/>type<sp/>definition<sp/>in<sp/>case<sp/>the<sp/>user<sp/>won&apos;t<sp/>store<sp/>pointer</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/>newType-&gt;<ref refid="structFTIT__type_1ae931b22aad8086d44a71e90228406f1e" kindref="member">structure</ref><sp/>=<sp/>malloc(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structFTIT__complexType" kindref="compound">FTIT_complexType</ref>));</highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/>*newType-&gt;<ref refid="structFTIT__type_1ae931b22aad8086d44a71e90228406f1e" kindref="member">structure</ref><sp/>=<sp/>*typeDefinition;</highlight></codeline>
<codeline lineno="362"><highlight class="normal"></highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//append<sp/>a<sp/>space<sp/>for<sp/>new<sp/>type</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a6cbf8f36622f495540e6af68525013d6" kindref="member">FTI_Type</ref><sp/>=<sp/>realloc(FTI_Exec.<ref refid="structFTIT__execution_1a6cbf8f36622f495540e6af68525013d6" kindref="member">FTI_Type</ref>,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structFTIT__type" kindref="compound">FTIT_type</ref>*)<sp/>*<sp/>(FTI_Exec.<ref refid="structFTIT__execution_1ae9e0a0b1ee8bd41e2b6251a597b47d26" kindref="member">nbType</ref><sp/>+<sp/>1));</highlight></codeline>
<codeline lineno="365"><highlight class="normal"></highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//make<sp/>a<sp/>clone<sp/>of<sp/>the<sp/>type<sp/>in<sp/>case<sp/>the<sp/>user<sp/>won&apos;t<sp/>store<sp/>pointer</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a6cbf8f36622f495540e6af68525013d6" kindref="member">FTI_Type</ref>[FTI_Exec.<ref refid="structFTIT__execution_1ae9e0a0b1ee8bd41e2b6251a597b47d26" kindref="member">nbType</ref>]<sp/>=<sp/>malloc(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structFTIT__type" kindref="compound">FTIT_type</ref>));</highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/>*FTI_Exec.<ref refid="structFTIT__execution_1a6cbf8f36622f495540e6af68525013d6" kindref="member">FTI_Type</ref>[FTI_Exec.<ref refid="structFTIT__execution_1ae9e0a0b1ee8bd41e2b6251a597b47d26" kindref="member">nbType</ref>]<sp/>=<sp/>*newType;</highlight></codeline>
<codeline lineno="369"><highlight class="normal"></highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1ae9e0a0b1ee8bd41e2b6251a597b47d26" kindref="member">nbType</ref><sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1ae9e0a0b1ee8bd41e2b6251a597b47d26" kindref="member">nbType</ref><sp/>+<sp/>1;</highlight></codeline>
<codeline lineno="371"><highlight class="normal"></highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="373"><highlight class="normal">}</highlight></codeline>
<codeline lineno="374"><highlight class="normal"></highlight></codeline>
<codeline lineno="375"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="390"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="391" refid="api_8c_1a990302331eacb14390ce4feae438405f" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="api_8c_1a990302331eacb14390ce4feae438405f" kindref="member">FTI_AddSimpleField</ref>(<ref refid="structFTIT__complexType" kindref="compound">FTIT_complexType</ref>*<sp/>typeDefinition,<sp/><ref refid="structFTIT__type" kindref="compound">FTIT_type</ref>*<sp/>ftiType,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>offset,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>name)</highlight></codeline>
<codeline lineno="392"><highlight class="normal">{</highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/>typeDefinition-&gt;<ref refid="structFTIT__complexType_1abbb9d041a59fd4972244d8c62e78dbaa" kindref="member">field</ref>[id].<ref refid="structFTIT__typeField_1ac81ba503b07eae0ed82ad1e2f5ecdced" kindref="member">typeID</ref><sp/>=<sp/>ftiType-&gt;<ref refid="structFTIT__type_1a75237aa3e6824b450ee623bffb36608a" kindref="member">id</ref>;</highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/>typeDefinition-&gt;<ref refid="structFTIT__complexType_1abbb9d041a59fd4972244d8c62e78dbaa" kindref="member">field</ref>[id].<ref refid="structFTIT__typeField_1a75068a6f39c20766ec43624f9b497cbf" kindref="member">offset</ref><sp/>=<sp/>offset;</highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(name<sp/>==<sp/>NULL<sp/>||<sp/>!strlen(name))<sp/>{</highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sprintf(typeDefinition-&gt;<ref refid="structFTIT__complexType_1abbb9d041a59fd4972244d8c62e78dbaa" kindref="member">field</ref>[</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">].<ref refid="structFTIT__typeField_1aa2dcf41b2455dd8b220587a655fcf73d" kindref="member">name</ref>,<sp/></highlight><highlight class="stringliteral">&quot;T%d&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>strncpy(typeDefinition-&gt;<ref refid="structFTIT__complexType_1abbb9d041a59fd4972244d8c62e78dbaa" kindref="member">field</ref>[</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">].<ref refid="structFTIT__typeField_1aa2dcf41b2455dd8b220587a655fcf73d" kindref="member">name</ref>,<sp/>name,<sp/><ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>);</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/>typeDefinition-&gt;<ref refid="structFTIT__complexType_1abbb9d041a59fd4972244d8c62e78dbaa" kindref="member">field</ref>[id].<ref refid="structFTIT__typeField_1ad46ee30f23a6af1c5ac85ecce834cdc2" kindref="member">rank</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/>typeDefinition-&gt;<ref refid="structFTIT__complexType_1abbb9d041a59fd4972244d8c62e78dbaa" kindref="member">field</ref>[id].<ref refid="structFTIT__typeField_1af0e311f38f7f6b7ab7ff04e3897f6c37" kindref="member">dimLength</ref>[0]<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="402"><highlight class="normal">}</highlight></codeline>
<codeline lineno="403"><highlight class="normal"></highlight></codeline>
<codeline lineno="404"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="421"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="422" refid="api_8c_1ab93e233cbea2ba23a026e3f2396ec0a3" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="api_8c_1ab93e233cbea2ba23a026e3f2396ec0a3" kindref="member">FTI_AddComplexField</ref>(<ref refid="structFTIT__complexType" kindref="compound">FTIT_complexType</ref>*<sp/>typeDefinition,<sp/><ref refid="structFTIT__type" kindref="compound">FTIT_type</ref>*<sp/>ftiType,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>offset,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>rank,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal">*<sp/>dimLength,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>name)</highlight></codeline>
<codeline lineno="423"><highlight class="normal">{</highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/>typeDefinition-&gt;<ref refid="structFTIT__complexType_1abbb9d041a59fd4972244d8c62e78dbaa" kindref="member">field</ref>[id].<ref refid="structFTIT__typeField_1ac81ba503b07eae0ed82ad1e2f5ecdced" kindref="member">typeID</ref><sp/>=<sp/>ftiType-&gt;<ref refid="structFTIT__type_1a75237aa3e6824b450ee623bffb36608a" kindref="member">id</ref>;</highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/>typeDefinition-&gt;<ref refid="structFTIT__complexType_1abbb9d041a59fd4972244d8c62e78dbaa" kindref="member">field</ref>[id].<ref refid="structFTIT__typeField_1a75068a6f39c20766ec43624f9b497cbf" kindref="member">offset</ref><sp/>=<sp/>offset;</highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/>typeDefinition-&gt;<ref refid="structFTIT__complexType_1abbb9d041a59fd4972244d8c62e78dbaa" kindref="member">field</ref>[id].<ref refid="structFTIT__typeField_1ad46ee30f23a6af1c5ac85ecce834cdc2" kindref="member">rank</ref><sp/>=<sp/>rank;</highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>rank;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>typeDefinition-&gt;<ref refid="structFTIT__complexType_1abbb9d041a59fd4972244d8c62e78dbaa" kindref="member">field</ref>[id].<ref refid="structFTIT__typeField_1af0e311f38f7f6b7ab7ff04e3897f6c37" kindref="member">dimLength</ref>[i]<sp/>=<sp/>dimLength[i];</highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(name<sp/>==<sp/>NULL<sp/>||<sp/>!strlen(name))<sp/>{</highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sprintf(typeDefinition-&gt;<ref refid="structFTIT__complexType_1abbb9d041a59fd4972244d8c62e78dbaa" kindref="member">field</ref>[</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">].<ref refid="structFTIT__typeField_1aa2dcf41b2455dd8b220587a655fcf73d" kindref="member">name</ref>,<sp/></highlight><highlight class="stringliteral">&quot;T%d&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>strncpy(typeDefinition-&gt;<ref refid="structFTIT__complexType_1abbb9d041a59fd4972244d8c62e78dbaa" kindref="member">field</ref>[</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">].<ref refid="structFTIT__typeField_1aa2dcf41b2455dd8b220587a655fcf73d" kindref="member">name</ref>,<sp/>name,<sp/><ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>);</highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="436"><highlight class="normal">}</highlight></codeline>
<codeline lineno="437"><highlight class="normal"></highlight></codeline>
<codeline lineno="438"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="449"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="450" refid="api_8c_1a9a144006e804d976446ba5a9c21f1591" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="api_8c_1a9a144006e804d976446ba5a9c21f1591" kindref="member">FTI_GetStageDir</ref>(<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>stageDir,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>maxLen)<sp/></highlight></codeline>
<codeline lineno="451"><highlight class="normal">{</highlight></codeline>
<codeline lineno="452"><highlight class="normal"></highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>!FTI_Conf.<ref refid="structFTIT__configuration_1ae6c297d0a3c6e122ee63085f2a365a30" kindref="member">stagingEnabled</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(<sp/></highlight><highlight class="stringliteral">&quot;&apos;FTI_GetStageDir&apos;<sp/>-&gt;<sp/>Staging<sp/>disabled,<sp/>no<sp/>action<sp/>performed.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref><sp/>);</highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="457"><highlight class="normal"></highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stageDir<sp/>==<sp/>NULL<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(<sp/></highlight><highlight class="stringliteral">&quot;invalid<sp/>value<sp/>for<sp/>stageDir<sp/>(&apos;nil&apos;)!&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref><sp/>);</highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="461"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="462"><highlight class="normal"></highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>maxLen<sp/>&lt;<sp/>1<sp/>)<sp/>{<sp/></highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>errstr[<ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>];</highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>snprintf(<sp/>errstr,<sp/><ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;invalid<sp/>value<sp/>for<sp/>maxLen<sp/>(&apos;%d&apos;)!&quot;</highlight><highlight class="normal">,<sp/>maxLen<sp/>);</highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(<sp/>errstr,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref><sp/>);</highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="469"><highlight class="normal"></highlight></codeline>
<codeline lineno="470"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>len<sp/>=<sp/>strlen(FTI_Conf.<ref refid="structFTIT__configuration_1aaec373a5e13128f98021cc221e9fc426" kindref="member">stageDir</ref>);</highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>maxLen<sp/>&lt;<sp/>len+1<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(<sp/></highlight><highlight class="stringliteral">&quot;insufficient<sp/>buffer<sp/>size<sp/>(maxLen<sp/>too<sp/>small)!&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref><sp/>);</highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="475"><highlight class="normal"></highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/>strncpy(<sp/>stageDir,<sp/>FTI_Conf.<ref refid="structFTIT__configuration_1aaec373a5e13128f98021cc221e9fc426" kindref="member">stageDir</ref>,<sp/><ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref><sp/>);</highlight></codeline>
<codeline lineno="477"><highlight class="normal"></highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="479"><highlight class="normal"></highlight></codeline>
<codeline lineno="480"><highlight class="normal">}</highlight></codeline>
<codeline lineno="481"><highlight class="normal"></highlight></codeline>
<codeline lineno="482"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="506"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="507" refid="api_8c_1a244522ba34ee7fced63cab22a24b326b" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="api_8c_1a244522ba34ee7fced63cab22a24b326b" kindref="member">FTI_GetStageStatus</ref>(<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>ID<sp/>)</highlight></codeline>
<codeline lineno="508"><highlight class="normal">{</highlight></codeline>
<codeline lineno="509"><highlight class="normal"></highlight></codeline>
<codeline lineno="510"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>!FTI_Conf.<ref refid="structFTIT__configuration_1ae6c297d0a3c6e122ee63085f2a365a30" kindref="member">stagingEnabled</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(<sp/></highlight><highlight class="stringliteral">&quot;&apos;FTI_GetStageStatus&apos;<sp/>-&gt;<sp/>Staging<sp/>disabled,<sp/>no<sp/>action<sp/>performed.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref><sp/>);</highlight></codeline>
<codeline lineno="512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="513"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="514"><highlight class="normal"></highlight></codeline>
<codeline lineno="515"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>indicator<sp/>if<sp/>we<sp/>still<sp/>need<sp/>the<sp/>request<sp/>structure<sp/>allocated</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="516"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>(i.e.<sp/>send<sp/>buffer<sp/>not<sp/>released<sp/>by<sp/>MPI)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="517"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>free_req<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="518"><highlight class="normal"></highlight></codeline>
<codeline lineno="519"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>get<sp/>status<sp/>of<sp/>request</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="520"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>status;</highlight></codeline>
<codeline lineno="521"><highlight class="normal"><sp/><sp/><sp/><sp/>status<sp/>=<sp/><ref refid="stage_8c_1a03ebd25f6254d11bc790e70e9aabd9eb" kindref="member">FTI_GetStatusField</ref>(<sp/>&amp;FTI_Exec,<sp/>&amp;FTI_Topo,<sp/>ID,<sp/><ref refid="stage_8h_1a90a1c70f104f770eff8ba0b2febc7887a18a6215a6b91702735bbfb1f211d814c" kindref="member">FTI_SIF_VAL</ref>,<sp/>FTI_Topo.<ref refid="structFTIT__topology_1a39761a9bc4ad6d0ca46b7ca82593c175" kindref="member">nodeRank</ref><sp/>);<sp/><sp/></highlight></codeline>
<codeline lineno="522"><highlight class="normal"></highlight></codeline>
<codeline lineno="523"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>check<sp/>if<sp/>pending</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>status<sp/>==<sp/><ref refid="fti_8h_1a4eb6ff54cf8f3c3149d42da30d23c498" kindref="member">FTI_SI_PEND</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>flag<sp/>=<sp/>1,<sp/>idx;</highlight></codeline>
<codeline lineno="526"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>if<sp/>pending<sp/>check<sp/>if<sp/>we<sp/>can<sp/>free<sp/>the<sp/>send<sp/>buffer</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>(idx<sp/>=<sp/><ref refid="stage_8c_1a0c5a2182e719ef3336289bd24f8fd312" kindref="member">FTI_GetRequestIdx</ref>(ID))<sp/>&gt;=<sp/>0<sp/>)<sp/>{<sp/></highlight></codeline>
<codeline lineno="528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MPI_Test(<sp/>&amp;(<ref refid="stage_8h_1ac2bb11c3f5f891e1e161b6b5c4f517e0" kindref="member">FTI_SI_APTR</ref>(FTI_Exec.<ref refid="structFTIT__execution_1a375349b5e9e834a60929b760443e9425" kindref="member">stageInfo</ref>-&gt;<ref refid="structFTIT__StageInfo_1a4687045f1b5e679855bae7251421a82d" kindref="member">request</ref>)[idx].mpiReq),<sp/>&amp;flag,<sp/>MPI_STATUS_IGNORE<sp/>);</highlight></codeline>
<codeline lineno="529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>flag<sp/>==<sp/>0<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>free_req<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="533"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="534"><highlight class="normal"></highlight></codeline>
<codeline lineno="535"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>free_req<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="stage_8c_1a6e74aba3e759272cbdb8db6ccbb879f2" kindref="member">FTI_FreeStageRequest</ref>(<sp/>&amp;FTI_Exec,<sp/>&amp;FTI_Topo,<sp/>ID,<sp/>FTI_Topo.<ref refid="structFTIT__topology_1a39761a9bc4ad6d0ca46b7ca82593c175" kindref="member">nodeRank</ref><sp/>);</highlight></codeline>
<codeline lineno="537"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="538"><highlight class="normal"></highlight></codeline>
<codeline lineno="539"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>(status==<ref refid="fti_8h_1a8b63f0cd5d9aa9417c3d3ec5a703ca1b" kindref="member">FTI_SI_FAIL</ref>)<sp/>||<sp/>(status==<ref refid="fti_8h_1a93cefc8dced9cb5c63c45708ef89694b" kindref="member">FTI_SI_SCES</ref>)<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="stage_8c_1ab210803902592adb2ebb22b9a9a28dda" kindref="member">FTI_SetStatusField</ref>(<sp/>&amp;FTI_Exec,<sp/>&amp;FTI_Topo,<sp/>ID,<sp/><ref refid="fti_8h_1a26fc9f53bb9fcbbf144da0488e217172" kindref="member">FTI_SI_NINI</ref>,<sp/><ref refid="stage_8h_1a90a1c70f104f770eff8ba0b2febc7887a18a6215a6b91702735bbfb1f211d814c" kindref="member">FTI_SIF_VAL</ref>,<sp/>FTI_Topo.<ref refid="structFTIT__topology_1a39761a9bc4ad6d0ca46b7ca82593c175" kindref="member">nodeRank</ref><sp/>);</highlight></codeline>
<codeline lineno="541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="stage_8c_1ab210803902592adb2ebb22b9a9a28dda" kindref="member">FTI_SetStatusField</ref>(<sp/>&amp;FTI_Exec,<sp/>&amp;FTI_Topo,<sp/>ID,<sp/><ref refid="stage_8h_1a801ee3b0f00dfbfb2c72f17666565fa8" kindref="member">FTI_SI_IAVL</ref>,<sp/><ref refid="stage_8h_1a90a1c70f104f770eff8ba0b2febc7887a3c0c80cbe8e4a14370a8a47f2a54b6ba" kindref="member">FTI_SIF_AVL</ref>,<sp/>FTI_Topo.<ref refid="structFTIT__topology_1a39761a9bc4ad6d0ca46b7ca82593c175" kindref="member">nodeRank</ref><sp/>);</highlight></codeline>
<codeline lineno="542"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="543"><highlight class="normal"></highlight></codeline>
<codeline lineno="544"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>status;</highlight></codeline>
<codeline lineno="545"><highlight class="normal"></highlight></codeline>
<codeline lineno="546"><highlight class="normal">}</highlight></codeline>
<codeline lineno="547"><highlight class="normal"></highlight></codeline>
<codeline lineno="548"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="565"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="566" refid="api_8c_1ae89330f9e650a1a5b7e2f460edba8d54" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="api_8c_1ae89330f9e650a1a5b7e2f460edba8d54" kindref="member">FTI_SendFile</ref>(<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>lpath,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*rpath<sp/>)</highlight></codeline>
<codeline lineno="567"><highlight class="normal">{<sp/></highlight></codeline>
<codeline lineno="568"><highlight class="normal"></highlight></codeline>
<codeline lineno="569"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>!FTI_Conf.<ref refid="structFTIT__configuration_1ae6c297d0a3c6e122ee63085f2a365a30" kindref="member">stagingEnabled</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(<sp/></highlight><highlight class="stringliteral">&quot;&apos;FTI_SendFile&apos;<sp/>-&gt;<sp/>Staging<sp/>disabled,<sp/>no<sp/>action<sp/>performed.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref><sp/>);</highlight></codeline>
<codeline lineno="571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="572"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="573"><highlight class="normal"></highlight></codeline>
<codeline lineno="574"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>ID<sp/>=<sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="575"><highlight class="normal"></highlight></codeline>
<codeline lineno="576"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>discard<sp/>if<sp/>path<sp/>is<sp/>NULL</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="577"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>lpath<sp/>==<sp/>NULL<sp/>){</highlight></codeline>
<codeline lineno="578"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(<sp/></highlight><highlight class="stringliteral">&quot;local<sp/>path<sp/>field<sp/>is<sp/>NULL!&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref><sp/>);</highlight></codeline>
<codeline lineno="579"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="580"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="581"><highlight class="normal"></highlight></codeline>
<codeline lineno="582"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>rpath<sp/>==<sp/>NULL<sp/>){</highlight></codeline>
<codeline lineno="583"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(<sp/></highlight><highlight class="stringliteral">&quot;remote<sp/>path<sp/>field<sp/>is<sp/>NULL!&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref><sp/>);</highlight></codeline>
<codeline lineno="584"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="585"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="586"><highlight class="normal"></highlight></codeline>
<codeline lineno="587"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>asign<sp/>new<sp/>request<sp/>ID</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="588"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>note:<sp/>if<sp/>ID<sp/>found,<sp/>FTI_Exec-&gt;stageInfo-&gt;status[ID]<sp/>is<sp/>set<sp/>to<sp/>not<sp/>available</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="589"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>reqID<sp/>=<sp/><ref refid="stage_8c_1af704cfca36ed0ca9ab685a838518c114" kindref="member">FTI_GetRequestID</ref>(<sp/>&amp;FTI_Exec,<sp/>&amp;FTI_Topo<sp/>);</highlight></codeline>
<codeline lineno="590"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(reqID<sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="591"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;Too<sp/>many<sp/>stage<sp/>requests!&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="592"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="593"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="594"><highlight class="normal"><sp/><sp/><sp/><sp/>ID<sp/>=<sp/>reqID;</highlight></codeline>
<codeline lineno="595"><highlight class="normal"></highlight></codeline>
<codeline lineno="596"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="stage_8c_1add93ac9ae93c0bc729d2d68f1617341c" kindref="member">FTI_InitStageRequestApp</ref>(<sp/>&amp;FTI_Exec,<sp/>&amp;FTI_Topo,<sp/>ID<sp/>);</highlight></codeline>
<codeline lineno="597"><highlight class="normal"></highlight></codeline>
<codeline lineno="598"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>FTI_Topo.<ref refid="structFTIT__topology_1ae6c9d66ebe7506e56262bfdd65628ac8" kindref="member">nbHeads</ref><sp/>==<sp/>0<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="599"><highlight class="normal"></highlight></codeline>
<codeline lineno="600"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/><ref refid="stage_8c_1a182f1f60a5374160a724cee0034c572d" kindref="member">FTI_SyncStage</ref>(<sp/>lpath,<sp/>rpath,<sp/>&amp;FTI_Exec,<sp/>&amp;FTI_Topo,<sp/>&amp;FTI_Conf,<sp/>ID<sp/>)<sp/>!=<sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="601"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;synchronous<sp/>staging<sp/>failed!&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="602"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="604"><highlight class="normal"></highlight></codeline>
<codeline lineno="605"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="606"><highlight class="normal"></highlight></codeline>
<codeline lineno="607"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>FTI_Topo.<ref refid="structFTIT__topology_1ae6c9d66ebe7506e56262bfdd65628ac8" kindref="member">nbHeads</ref><sp/>&gt;<sp/>0<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="608"><highlight class="normal"></highlight></codeline>
<codeline lineno="609"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/><ref refid="stage_8c_1a61d6e550d9f80163986a523bc8f2d33d" kindref="member">FTI_AsyncStage</ref>(<sp/>lpath,<sp/>rpath,<sp/>&amp;FTI_Conf,<sp/>&amp;FTI_Exec,<sp/>&amp;FTI_Topo,<sp/>ID<sp/>)<sp/>!=<sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="610"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;asynchronous<sp/>staging<sp/>failed!&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="611"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="612"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="613"><highlight class="normal"></highlight></codeline>
<codeline lineno="614"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="615"><highlight class="normal"></highlight></codeline>
<codeline lineno="616"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ID;</highlight></codeline>
<codeline lineno="617"><highlight class="normal"></highlight></codeline>
<codeline lineno="618"><highlight class="normal">}</highlight></codeline>
<codeline lineno="619"><highlight class="normal"></highlight></codeline>
<codeline lineno="620"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="632"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="633" refid="api_8c_1a13fc751bcf88d7c2766d0b76344b0964" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="api_8c_1a13fc751bcf88d7c2766d0b76344b0964" kindref="member">FTI_InitGroup</ref>(<ref refid="structFTIT__H5Group" kindref="compound">FTIT_H5Group</ref>*<sp/>h5group,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>name,<sp/><ref refid="structFTIT__H5Group" kindref="compound">FTIT_H5Group</ref>*<sp/>parent)</highlight></codeline>
<codeline lineno="634"><highlight class="normal">{</highlight></codeline>
<codeline lineno="635"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(parent<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//child<sp/>of<sp/>root</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="637"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>parent<sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a896039ee736e3c0676fe13df8b1ac345" kindref="member">H5groups</ref>[0];</highlight></codeline>
<codeline lineno="638"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="639"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structFTIT__H5Group" kindref="compound">FTIT_H5Group</ref>*<sp/>parentInArray<sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a896039ee736e3c0676fe13df8b1ac345" kindref="member">H5groups</ref>[parent-&gt;<ref refid="structFTIT__H5Group_1a3de0568ad296bc36607c871f14f4daa0" kindref="member">id</ref>];</highlight></codeline>
<codeline lineno="640"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//check<sp/>if<sp/>this<sp/>parent<sp/>has<sp/>that<sp/>child</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="641"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="642"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>parentInArray-&gt;<ref refid="structFTIT__H5Group_1a20760d6be9ac52ac572b2f253e6c6a42" kindref="member">childrenNo</ref>;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="643"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(strcmp(FTI_Exec.<ref refid="structFTIT__execution_1a896039ee736e3c0676fe13df8b1ac345" kindref="member">H5groups</ref>[parentInArray-&gt;<ref refid="structFTIT__H5Group_1ac1c4d13f5a4a4856f5633dab2f7579a7" kindref="member">childrenID</ref>[i]]-&gt;<ref refid="structFTIT__H5Group_1a228de3501b9a2df5b7950342a836749a" kindref="member">name</ref>,<sp/>name)<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="644"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>str[<ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>];</highlight></codeline>
<codeline lineno="645"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>snprintf(str,<sp/><ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Group<sp/>%s<sp/>already<sp/>has<sp/>the<sp/>%s<sp/>child.&quot;</highlight><highlight class="normal">,<sp/>parentInArray-&gt;<ref refid="structFTIT__H5Group_1a228de3501b9a2df5b7950342a836749a" kindref="member">name</ref>,<sp/>name);</highlight></codeline>
<codeline lineno="646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="647"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="648"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="649"><highlight class="normal"><sp/><sp/><sp/><sp/>h5group-&gt;<ref refid="structFTIT__H5Group_1a3de0568ad296bc36607c871f14f4daa0" kindref="member">id</ref><sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a2c780326f5e9cefc7f2b5904eca1d318" kindref="member">nbGroup</ref>;</highlight></codeline>
<codeline lineno="650"><highlight class="normal"><sp/><sp/><sp/><sp/>h5group-&gt;<ref refid="structFTIT__H5Group_1a20760d6be9ac52ac572b2f253e6c6a42" kindref="member">childrenNo</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="651"><highlight class="normal"><sp/><sp/><sp/><sp/>strncpy(h5group-&gt;<ref refid="structFTIT__H5Group_1a228de3501b9a2df5b7950342a836749a" kindref="member">name</ref>,<sp/>name,<sp/><ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>);</highlight></codeline>
<codeline lineno="652"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>ENABLE_HDF5</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="653"><highlight class="normal"><sp/><sp/><sp/><sp/>h5group-&gt;h5groupID<sp/>=<sp/>-1;<sp/></highlight><highlight class="comment">//to<sp/>mark<sp/>as<sp/>closed</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="654"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="655"><highlight class="normal"></highlight></codeline>
<codeline lineno="656"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>set<sp/>full<sp/>path<sp/>to<sp/>group</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="657"><highlight class="normal"><sp/><sp/><sp/><sp/>snprintf(h5group-&gt;<ref refid="structFTIT__H5Group_1a4c2782e143b281b771470cff79663db2" kindref="member">fullName</ref>,<sp/><ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;%s/%s&quot;</highlight><highlight class="normal">,<sp/>parent-&gt;<ref refid="structFTIT__H5Group_1a4c2782e143b281b771470cff79663db2" kindref="member">fullName</ref>,<sp/>h5group-&gt;<ref refid="structFTIT__H5Group_1a228de3501b9a2df5b7950342a836749a" kindref="member">name</ref>);</highlight></codeline>
<codeline lineno="658"><highlight class="normal"></highlight></codeline>
<codeline lineno="659"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//make<sp/>a<sp/>clone<sp/>of<sp/>the<sp/>group<sp/>in<sp/>case<sp/>the<sp/>user<sp/>won&apos;t<sp/>store<sp/>pointer</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="660"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a896039ee736e3c0676fe13df8b1ac345" kindref="member">H5groups</ref>[FTI_Exec.<ref refid="structFTIT__execution_1a2c780326f5e9cefc7f2b5904eca1d318" kindref="member">nbGroup</ref>]<sp/>=<sp/>malloc(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structFTIT__H5Group" kindref="compound">FTIT_H5Group</ref>));</highlight></codeline>
<codeline lineno="661"><highlight class="normal"><sp/><sp/><sp/><sp/>*FTI_Exec.<ref refid="structFTIT__execution_1a896039ee736e3c0676fe13df8b1ac345" kindref="member">H5groups</ref>[FTI_Exec.<ref refid="structFTIT__execution_1a2c780326f5e9cefc7f2b5904eca1d318" kindref="member">nbGroup</ref>]<sp/>=<sp/>*h5group;</highlight></codeline>
<codeline lineno="662"><highlight class="normal"></highlight></codeline>
<codeline lineno="663"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//assign<sp/>a<sp/>child<sp/>and<sp/>increment<sp/>the<sp/>childrenNo</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="664"><highlight class="normal"><sp/><sp/><sp/><sp/>parentInArray-&gt;<ref refid="structFTIT__H5Group_1ac1c4d13f5a4a4856f5633dab2f7579a7" kindref="member">childrenID</ref>[parentInArray-&gt;<ref refid="structFTIT__H5Group_1a20760d6be9ac52ac572b2f253e6c6a42" kindref="member">childrenNo</ref>]<sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a2c780326f5e9cefc7f2b5904eca1d318" kindref="member">nbGroup</ref>;</highlight></codeline>
<codeline lineno="665"><highlight class="normal"><sp/><sp/><sp/><sp/>parentInArray-&gt;<ref refid="structFTIT__H5Group_1a20760d6be9ac52ac572b2f253e6c6a42" kindref="member">childrenNo</ref>++;</highlight></codeline>
<codeline lineno="666"><highlight class="normal"></highlight></codeline>
<codeline lineno="667"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a2c780326f5e9cefc7f2b5904eca1d318" kindref="member">nbGroup</ref><sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a2c780326f5e9cefc7f2b5904eca1d318" kindref="member">nbGroup</ref><sp/>+<sp/>1;</highlight></codeline>
<codeline lineno="668"><highlight class="normal"></highlight></codeline>
<codeline lineno="669"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="670"><highlight class="normal">}</highlight></codeline>
<codeline lineno="671"><highlight class="normal"></highlight></codeline>
<codeline lineno="672"><highlight class="normal"></highlight></codeline>
<codeline lineno="673"><highlight class="normal"></highlight></codeline>
<codeline lineno="674"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="683"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="684" refid="api_8c_1a2da201b48449cc457f338d23bc3f4cf3" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="api_8c_1a2da201b48449cc457f338d23bc3f4cf3" kindref="member">FTI_setIDFromString</ref>(<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*name<sp/>){</highlight></codeline>
<codeline lineno="685"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="686"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(<sp/>i<sp/>=<sp/>0<sp/>;<sp/>i<sp/>&lt;<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>;<sp/>i++){</highlight></codeline>
<codeline lineno="687"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(strcmp(name,<sp/>FTI_Data[i].idChar)<sp/>==<sp/>0){</highlight></codeline>
<codeline lineno="688"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="689"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="690"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="691"><highlight class="normal"><sp/><sp/><sp/><sp/>strncpy(FTI_Data[i].idChar,<sp/>name,<sp/><ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>);</highlight></codeline>
<codeline lineno="692"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="693"><highlight class="normal">}</highlight></codeline>
<codeline lineno="694"><highlight class="normal"></highlight></codeline>
<codeline lineno="695"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="704"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="705" refid="api_8c_1aa3085533f52818cf46175b8f783ad17b" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="api_8c_1aa3085533f52818cf46175b8f783ad17b" kindref="member">FTI_getIDFromString</ref>(<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*name<sp/>){</highlight></codeline>
<codeline lineno="706"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="707"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>ckptLvL<sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a19a4f92c1d8dd2c86350f59eb7372ca8" kindref="member">ckptLvel</ref>;</highlight></codeline>
<codeline lineno="708"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>numVars<sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a800c2671725989e4b600fb8a62e4145e" kindref="member">meta</ref>[ckptLvL].<ref refid="structFTIT__metadata_1ac37464bdb77263ab72dbc31638e0cfdd" kindref="member">nbVar</ref>[0];</highlight></codeline>
<codeline lineno="709"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*varNames<sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a800c2671725989e4b600fb8a62e4145e" kindref="member">meta</ref>[ckptLvL].<ref refid="structFTIT__metadata_1a778cf3ca25931e378be4f58e0ad5e503" kindref="member">idChar</ref>;</highlight></codeline>
<codeline lineno="710"><highlight class="normal"></highlight></codeline>
<codeline lineno="711"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(<sp/>i<sp/>=<sp/>0<sp/>;<sp/>i<sp/>&lt;<sp/>numVars;<sp/>i++){</highlight></codeline>
<codeline lineno="712"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(strcmp(name,<sp/>&amp;varNames[i*<ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>])<sp/>==<sp/>0){</highlight></codeline>
<codeline lineno="713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="714"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="715"><highlight class="normal"></highlight></codeline>
<codeline lineno="716"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="717"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="718"><highlight class="normal">}</highlight></codeline>
<codeline lineno="719"><highlight class="normal"></highlight></codeline>
<codeline lineno="720"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="730"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="731" refid="api_8c_1a2dc4fb3b0353541b7bc156f1c803f92f" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="api_8c_1a2dc4fb3b0353541b7bc156f1c803f92f" kindref="member">FTI_RenameGroup</ref>(<ref refid="structFTIT__H5Group" kindref="compound">FTIT_H5Group</ref>*<sp/>h5group,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>name)<sp/></highlight></codeline>
<codeline lineno="732"><highlight class="normal">{</highlight></codeline>
<codeline lineno="733"><highlight class="normal"><sp/><sp/><sp/><sp/>strncpy(FTI_Exec.<ref refid="structFTIT__execution_1a896039ee736e3c0676fe13df8b1ac345" kindref="member">H5groups</ref>[h5group-&gt;<ref refid="structFTIT__H5Group_1a3de0568ad296bc36607c871f14f4daa0" kindref="member">id</ref>]-&gt;<ref refid="structFTIT__H5Group_1a228de3501b9a2df5b7950342a836749a" kindref="member">name</ref>,<sp/>name,<sp/><ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>);</highlight></codeline>
<codeline lineno="734"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="735"><highlight class="normal">}</highlight></codeline>
<codeline lineno="736"><highlight class="normal"></highlight></codeline>
<codeline lineno="737"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="754"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="755" refid="api_8c_1a913b8cd6e29a152eceaeaec35e21e677" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="api_8c_1a913b8cd6e29a152eceaeaec35e21e677" kindref="member">FTI_Protect</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/>ptr,<sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>count,<sp/><ref refid="structFTIT__type" kindref="compound">FTIT_type</ref><sp/>type)</highlight></codeline>
<codeline lineno="756"><highlight class="normal">{</highlight></codeline>
<codeline lineno="757"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Exec.<ref refid="structFTIT__execution_1a5ff8dd064b2a4cc4b7272abddacb8cc1" kindref="member">initSCES</ref><sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="758"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;FTI<sp/>is<sp/>not<sp/>initialized.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="759"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="760"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="761"><highlight class="normal"></highlight></codeline>
<codeline lineno="762"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>str[5*<ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>];<sp/></highlight><highlight class="comment">//For<sp/>console<sp/>output</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="763"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>GPUSUPPORT<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="764"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structFTIT__ptrinfo" kindref="compound">FTIT_ptrinfo</ref><sp/>ptrInfo;</highlight></codeline>
<codeline lineno="765"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>res;</highlight></codeline>
<codeline lineno="766"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((<sp/>res<sp/>=<sp/><ref refid="tools_8c_1a950803008f7cef4892fbba9b2069928e" kindref="member">FTI_Try</ref>(<sp/><ref refid="api-cuda_8c_1a77a43dab41fd5721fa4581af47413f4c" kindref="member">FTI_get_pointer_info</ref>((</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*)<sp/>ptr,<sp/>&amp;ptrInfo),</highlight><highlight class="stringliteral">&quot;FTI_Protect:<sp/>determine<sp/>pointer<sp/>type&quot;</highlight><highlight class="normal">))<sp/>!=<sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref><sp/>)<sp/><sp/></highlight></codeline>
<codeline lineno="767"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>res;</highlight></codeline>
<codeline lineno="768"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="769"><highlight class="normal"></highlight></codeline>
<codeline lineno="770"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="771"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>memLocation[4];</highlight></codeline>
<codeline lineno="772"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/><ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="773"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal"><sp/>==<sp/>FTI_Data[i].</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">)<sp/>{<sp/></highlight><highlight class="comment">//Search<sp/>for<sp/>dataset<sp/>with<sp/>given<sp/>id</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="774"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>prevSize<sp/>=<sp/>FTI_Data[i].<ref refid="structFTIT__dataset_1a112f9319765938eba3339d86c0e140c9" kindref="member">size</ref>;</highlight></codeline>
<codeline lineno="775"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>GPUSUPPORT</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="776"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>ptrInfo.<ref refid="structFTIT__ptrinfo_1a823910ebd4aee09f6beda01e6c31cacb" kindref="member">type</ref><sp/>==<sp/><ref refid="api-cuda_8h_1a86980048ebdb2b691b357773e7cf4e2da29018ea9dff75eea05902d9bae3c0082" kindref="member">FTIT_PTRTYPE_CPU</ref>)<sp/>{</highlight></codeline>
<codeline lineno="777"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>strcpy(memLocation,</highlight><highlight class="stringliteral">&quot;CPU&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="778"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[i].<ref refid="structFTIT__dataset_1af5787410c1a17d552c402533a95afebd" kindref="member">isDevicePtr</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="779"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[i].<ref refid="structFTIT__dataset_1a02c90a2a92a7de7cc2407c228053d173" kindref="member">devicePtr</ref>=<sp/>NULL;</highlight></codeline>
<codeline lineno="780"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[i].<ref refid="structFTIT__dataset_1a36ee086d6d8ddace556bdbdbd142acbb" kindref="member">ptr</ref><sp/>=<sp/>ptr;</highlight></codeline>
<codeline lineno="781"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="782"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>ptrInfo.<ref refid="structFTIT__ptrinfo_1a823910ebd4aee09f6beda01e6c31cacb" kindref="member">type</ref><sp/>==<sp/><ref refid="api-cuda_8h_1a86980048ebdb2b691b357773e7cf4e2da31a7e4d2c16a4fee5c18be02b9545f70" kindref="member">FTIT_PTRTYPE_GPU</ref><sp/>){</highlight></codeline>
<codeline lineno="783"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>strcpy(memLocation,</highlight><highlight class="stringliteral">&quot;GPU&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="784"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[i].<ref refid="structFTIT__dataset_1af5787410c1a17d552c402533a95afebd" kindref="member">isDevicePtr</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="785"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[i].<ref refid="structFTIT__dataset_1a02c90a2a92a7de7cc2407c228053d173" kindref="member">devicePtr</ref>=<sp/>ptr;</highlight></codeline>
<codeline lineno="786"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[i].<ref refid="structFTIT__dataset_1a36ee086d6d8ddace556bdbdbd142acbb" kindref="member">ptr</ref><sp/>=<sp/>NULL;<sp/></highlight><highlight class="comment">//(void<sp/>*)<sp/>malloc<sp/>(type.size<sp/>*count);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="787"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="788"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="789"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;ptr<sp/>Should<sp/>be<sp/>either<sp/>a<sp/>device<sp/>location<sp/>or<sp/>a<sp/>cpu<sp/>location\n&quot;</highlight><highlight class="normal">,<ref refid="fti-intern_8h_1a5cb1252ae17ef4ac13b3dbe5a8b1ab13" kindref="member">FTI_EROR</ref>);</highlight></codeline>
<codeline lineno="790"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[i].<ref refid="structFTIT__dataset_1a36ee086d6d8ddace556bdbdbd142acbb" kindref="member">ptr</ref><sp/>=<sp/>NULL;<sp/></highlight><highlight class="comment">//(void<sp/>*)<sp/>malloc<sp/>(type.size<sp/>*count);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="791"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="792"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="793"><highlight class="normal"></highlight><highlight class="preprocessor">#else<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="794"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>strcpy(memLocation,</highlight><highlight class="stringliteral">&quot;CPU&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="795"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[i].<ref refid="structFTIT__dataset_1af5787410c1a17d552c402533a95afebd" kindref="member">isDevicePtr</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="796"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[i].<ref refid="structFTIT__dataset_1a02c90a2a92a7de7cc2407c228053d173" kindref="member">devicePtr</ref>=<sp/>NULL;</highlight></codeline>
<codeline lineno="797"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[i].<ref refid="structFTIT__dataset_1a36ee086d6d8ddace556bdbdbd142acbb" kindref="member">ptr</ref><sp/>=<sp/>ptr;</highlight></codeline>
<codeline lineno="798"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/><sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="799"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[i].<ref refid="structFTIT__dataset_1abc07f32e21abf951afcae67f9636e65c" kindref="member">count</ref><sp/>=<sp/>count;</highlight></codeline>
<codeline lineno="800"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[i].<ref refid="structFTIT__dataset_1a564e1a87d53b7b4e834ea0ece45c35fb" kindref="member">type</ref><sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a6cbf8f36622f495540e6af68525013d6" kindref="member">FTI_Type</ref>[type.<ref refid="structFTIT__type_1a75237aa3e6824b450ee623bffb36608a" kindref="member">id</ref>];</highlight></codeline>
<codeline lineno="801"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[i].<ref refid="structFTIT__dataset_1aa0f368e577ef8f2b564d2607cdb958d1" kindref="member">eleSize</ref><sp/>=<sp/>type.<ref refid="structFTIT__type_1ae849a5abd72710611f1830155f2ce6c4" kindref="member">size</ref>;</highlight></codeline>
<codeline lineno="802"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[i].<ref refid="structFTIT__dataset_1a112f9319765938eba3339d86c0e140c9" kindref="member">size</ref><sp/>=<sp/>type.<ref refid="structFTIT__type_1ae849a5abd72710611f1830155f2ce6c4" kindref="member">size</ref><sp/>*<sp/>count;</highlight></codeline>
<codeline lineno="803"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[i].<ref refid="structFTIT__dataset_1ad0a974da814771e2f244bef0542c9d25" kindref="member">dimLength</ref>[0]<sp/>=<sp/>count;</highlight></codeline>
<codeline lineno="804"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a19693c7f3a31b31d90a40dcf7fc34183" kindref="member">ckptSize</ref><sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a19693c7f3a31b31d90a40dcf7fc34183" kindref="member">ckptSize</ref><sp/>+<sp/>((type.<ref refid="structFTIT__type_1ae849a5abd72710611f1830155f2ce6c4" kindref="member">size</ref><sp/>*<sp/>count)<sp/>-<sp/>prevSize);</highlight></codeline>
<codeline lineno="805"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>strlen(FTI_Data[i].idChar)<sp/>==<sp/>0<sp/>){<sp/></highlight></codeline>
<codeline lineno="806"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sprintf(str,<sp/></highlight><highlight class="stringliteral">&quot;Variable<sp/>ID<sp/>%d<sp/>reseted.<sp/>(Stored<sp/>In<sp/>%s).<sp/><sp/>Current<sp/>ckpt.<sp/>size<sp/>per<sp/>rank<sp/>is<sp/>%.2fMB.&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>memLocation,<sp/>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal">)<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a19693c7f3a31b31d90a40dcf7fc34183" kindref="member">ckptSize</ref><sp/>/<sp/>(1024.0<sp/>*<sp/>1024.0));</highlight></codeline>
<codeline lineno="807"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="808"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="809"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sprintf(str,<sp/></highlight><highlight class="stringliteral">&quot;Variable<sp/>Named<sp/>%s<sp/>with<sp/>ID<sp/>%d<sp/>to<sp/>protect<sp/>(Stored<sp/>in<sp/>%s).<sp/>Current<sp/>ckpt.<sp/>size<sp/>per<sp/>rank<sp/>is<sp/>%.2fMB.&quot;</highlight><highlight class="normal">,FTI_Data[i].idChar,<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>memLocation,<sp/>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal">)<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a19693c7f3a31b31d90a40dcf7fc34183" kindref="member">ckptSize</ref><sp/>/<sp/>(1024.0<sp/>*<sp/>1024.0));</highlight></codeline>
<codeline lineno="810"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="811"><highlight class="normal"></highlight></codeline>
<codeline lineno="812"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(str,<sp/><ref refid="fti-intern_8h_1a299db837571db9e73119d159b3428fe0" kindref="member">FTI_DBUG</ref>);</highlight></codeline>
<codeline lineno="813"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>prevSize<sp/>!=<sp/>FTI_Data[i].size<sp/>&amp;&amp;<sp/><sp/>FTI_Conf.<ref refid="structFTIT__configuration_1a5e319b258138bbb03d5da9917f99acd6" kindref="member">dcpPosix</ref>){</highlight></codeline>
<codeline lineno="814"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!(FTI_Data[i].isDevicePtr)){</highlight></codeline>
<codeline lineno="815"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>nbHashes<sp/>=<sp/>FTI_Data[i].<ref refid="structFTIT__dataset_1a112f9319765938eba3339d86c0e140c9" kindref="member">size</ref><sp/>/FTI_Conf.<ref refid="structFTIT__configuration_1a082b3136afb25beb45f0c9ece72ddca7" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpConfigurationPosix_1a639ec25941ab5eac6d6c22ebc7fc232e" kindref="member">BlockSize</ref><sp/>+<sp/>(bool)(FTI_Data[i].size<sp/>%FTI_Conf.<ref refid="structFTIT__configuration_1a082b3136afb25beb45f0c9ece72ddca7" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpConfigurationPosix_1a639ec25941ab5eac6d6c22ebc7fc232e" kindref="member">BlockSize</ref>);</highlight></codeline>
<codeline lineno="816"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[i].<ref refid="structFTIT__dataset_1af582d52ac7f4f2d56df03232cc0c6cb6" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpDatasetPosix_1a87104fc8812d30b59499828a54e00928" kindref="member">currentHashArray</ref>=<sp/>(</highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*)<sp/>realloc(<sp/>FTI_Data[i].dcpInfoPosix.currentHashArray,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">)*nbHashes*FTI_Conf.<ref refid="structFTIT__configuration_1a082b3136afb25beb45f0c9ece72ddca7" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpConfigurationPosix_1acdd6ef88f5b22e3c29dda4b7929ef866" kindref="member">digestWidth</ref><sp/>);</highlight></codeline>
<codeline lineno="817"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[i].<ref refid="structFTIT__dataset_1af582d52ac7f4f2d56df03232cc0c6cb6" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpDatasetPosix_1a12592fffe729610a32e25d55bf107417" kindref="member">oldHashArray</ref>=<sp/>(</highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*)<sp/>realloc(<sp/>FTI_Data[i].dcpInfoPosix.oldHashArray,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">)*nbHashes*FTI_Conf.<ref refid="structFTIT__configuration_1a082b3136afb25beb45f0c9ece72ddca7" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpConfigurationPosix_1acdd6ef88f5b22e3c29dda4b7929ef866" kindref="member">digestWidth</ref><sp/>);</highlight></codeline>
<codeline lineno="818"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="819"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>GPUSUPPORT</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="820"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="821"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*x;</highlight></codeline>
<codeline lineno="822"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>nbNewHashes<sp/>=<sp/>FTI_Data[i].<ref refid="structFTIT__dataset_1a112f9319765938eba3339d86c0e140c9" kindref="member">size</ref><sp/>/FTI_Conf.<ref refid="structFTIT__configuration_1a082b3136afb25beb45f0c9ece72ddca7" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpConfigurationPosix_1a639ec25941ab5eac6d6c22ebc7fc232e" kindref="member">BlockSize</ref><sp/>+<sp/>(bool)(FTI_Data[i].size<sp/>%FTI_Conf.<ref refid="structFTIT__configuration_1a082b3136afb25beb45f0c9ece72ddca7" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpConfigurationPosix_1a639ec25941ab5eac6d6c22ebc7fc232e" kindref="member">BlockSize</ref>);</highlight></codeline>
<codeline lineno="823"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>nbOldHashes<sp/>=<sp/>prevSize<sp/>/FTI_Conf.<ref refid="structFTIT__configuration_1a082b3136afb25beb45f0c9ece72ddca7" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpConfigurationPosix_1a639ec25941ab5eac6d6c22ebc7fc232e" kindref="member">BlockSize</ref><sp/>+<sp/>(bool)(FTI_Data[i].size<sp/>%FTI_Conf.<ref refid="structFTIT__configuration_1a082b3136afb25beb45f0c9ece72ddca7" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpConfigurationPosix_1a639ec25941ab5eac6d6c22ebc7fc232e" kindref="member">BlockSize</ref>);</highlight></codeline>
<codeline lineno="824"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CUDA_ERROR_CHECK(cudaMallocManaged((</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">**)<sp/>&amp;x,<sp/>(nbNewHashes<sp/>*<sp/>FTI_Conf.<ref refid="structFTIT__configuration_1a082b3136afb25beb45f0c9ece72ddca7" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpConfigurationPosix_1acdd6ef88f5b22e3c29dda4b7929ef866" kindref="member">digestWidth</ref>),cudaMemAttachGlobal));</highlight></codeline>
<codeline lineno="825"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>memcpy(x,<sp/>FTI_Data[i].dcpInfoPosix.currentHashArray,<sp/><ref refid="api-cuda_8h_1a74e75242132eaabbc1c512488a135926" kindref="member">MIN</ref>(nbNewHashes<sp/>*<sp/>FTI_Conf.<ref refid="structFTIT__configuration_1a082b3136afb25beb45f0c9ece72ddca7" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpConfigurationPosix_1acdd6ef88f5b22e3c29dda4b7929ef866" kindref="member">digestWidth</ref>,<sp/>nbOldHashes<sp/>*<sp/>FTI_Conf.<ref refid="structFTIT__configuration_1a082b3136afb25beb45f0c9ece72ddca7" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpConfigurationPosix_1acdd6ef88f5b22e3c29dda4b7929ef866" kindref="member">digestWidth</ref>));</highlight></codeline>
<codeline lineno="826"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CUDA_ERROR_CHECK(cudaFree(FTI_Data[i].dcpInfoPosix.currentHashArray<sp/>));</highlight></codeline>
<codeline lineno="827"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[i].<ref refid="structFTIT__dataset_1af582d52ac7f4f2d56df03232cc0c6cb6" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpDatasetPosix_1a87104fc8812d30b59499828a54e00928" kindref="member">currentHashArray</ref><sp/>=<sp/>x;</highlight></codeline>
<codeline lineno="828"><highlight class="normal"></highlight></codeline>
<codeline lineno="829"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CUDA_ERROR_CHECK(cudaMallocManaged((</highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>**)&amp;x,<sp/>nbNewHashes<sp/>*<sp/>FTI_Conf.<ref refid="structFTIT__configuration_1a082b3136afb25beb45f0c9ece72ddca7" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpConfigurationPosix_1acdd6ef88f5b22e3c29dda4b7929ef866" kindref="member">digestWidth</ref>,cudaMemAttachGlobal<sp/>));</highlight></codeline>
<codeline lineno="830"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>memcpy(x,<sp/>FTI_Data[i].dcpInfoPosix.oldHashArray,<sp/><sp/><ref refid="api-cuda_8h_1a74e75242132eaabbc1c512488a135926" kindref="member">MIN</ref>(nbNewHashes<sp/>*<sp/>FTI_Conf.<ref refid="structFTIT__configuration_1a082b3136afb25beb45f0c9ece72ddca7" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpConfigurationPosix_1acdd6ef88f5b22e3c29dda4b7929ef866" kindref="member">digestWidth</ref>,<sp/>nbOldHashes<sp/>*<sp/>FTI_Conf.<ref refid="structFTIT__configuration_1a082b3136afb25beb45f0c9ece72ddca7" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpConfigurationPosix_1acdd6ef88f5b22e3c29dda4b7929ef866" kindref="member">digestWidth</ref>));</highlight></codeline>
<codeline lineno="831"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CUDA_ERROR_CHECK(cudaFree(FTI_Data[i].dcpInfoPosix.oldHashArray));</highlight></codeline>
<codeline lineno="832"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[i].<ref refid="structFTIT__dataset_1af582d52ac7f4f2d56df03232cc0c6cb6" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpDatasetPosix_1a12592fffe729610a32e25d55bf107417" kindref="member">oldHashArray</ref>=<sp/>x;</highlight></codeline>
<codeline lineno="833"><highlight class="normal"></highlight></codeline>
<codeline lineno="834"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="835"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="836"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="837"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="838"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="839"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="840"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Id<sp/>could<sp/>not<sp/>be<sp/>found<sp/>in<sp/>datasets</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="841"><highlight class="normal"></highlight></codeline>
<codeline lineno="842"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//If<sp/>too<sp/>many<sp/>variables<sp/>exit<sp/>FTI.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="843"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref><sp/>&gt;=<sp/><ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>)<sp/>{</highlight></codeline>
<codeline lineno="844"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;Unable<sp/>to<sp/>register<sp/>variable.<sp/>Too<sp/>many<sp/>variables<sp/>already<sp/>registered.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="845"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="846"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="847"><highlight class="normal"></highlight></codeline>
<codeline lineno="848"><highlight class="normal"></highlight></codeline>
<codeline lineno="849"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Adding<sp/>new<sp/>variable<sp/>to<sp/>protect</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="850"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Data[FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>].<ref refid="structFTIT__dataset_1ac9c58324a5f443f1ea5804b530f7dab2" kindref="member">id</ref><sp/>=<sp/>id;</highlight></codeline>
<codeline lineno="851"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>GPUSUPPORT</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="852"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>ptrInfo.<ref refid="structFTIT__ptrinfo_1a823910ebd4aee09f6beda01e6c31cacb" kindref="member">type</ref><sp/>==<sp/><ref refid="api-cuda_8h_1a86980048ebdb2b691b357773e7cf4e2da29018ea9dff75eea05902d9bae3c0082" kindref="member">FTIT_PTRTYPE_CPU</ref>)<sp/>{</highlight></codeline>
<codeline lineno="853"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>strcpy(memLocation,</highlight><highlight class="stringliteral">&quot;CPU&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="854"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>].<ref refid="structFTIT__dataset_1af5787410c1a17d552c402533a95afebd" kindref="member">isDevicePtr</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="855"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>].<ref refid="structFTIT__dataset_1a02c90a2a92a7de7cc2407c228053d173" kindref="member">devicePtr</ref>=<sp/>NULL;</highlight></codeline>
<codeline lineno="856"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>].<ref refid="structFTIT__dataset_1a36ee086d6d8ddace556bdbdbd142acbb" kindref="member">ptr</ref><sp/>=<sp/>ptr;</highlight></codeline>
<codeline lineno="857"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="858"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>ptrInfo.<ref refid="structFTIT__ptrinfo_1a823910ebd4aee09f6beda01e6c31cacb" kindref="member">type</ref><sp/>==<sp/><ref refid="api-cuda_8h_1a86980048ebdb2b691b357773e7cf4e2da31a7e4d2c16a4fee5c18be02b9545f70" kindref="member">FTIT_PTRTYPE_GPU</ref><sp/>){</highlight></codeline>
<codeline lineno="859"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>strcpy(memLocation,</highlight><highlight class="stringliteral">&quot;GPU&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="860"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>].<ref refid="structFTIT__dataset_1af5787410c1a17d552c402533a95afebd" kindref="member">isDevicePtr</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="861"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>].<ref refid="structFTIT__dataset_1a02c90a2a92a7de7cc2407c228053d173" kindref="member">devicePtr</ref>=<sp/>ptr;</highlight></codeline>
<codeline lineno="862"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>].<ref refid="structFTIT__dataset_1a36ee086d6d8ddace556bdbdbd142acbb" kindref="member">ptr</ref><sp/>=<sp/>NULL;<sp/></highlight><highlight class="comment">//(void<sp/>*)<sp/>malloc<sp/>(type.size<sp/>*count);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="863"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="864"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="865"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;ptr<sp/>Should<sp/>be<sp/>either<sp/>a<sp/>device<sp/>location<sp/>or<sp/>a<sp/>cpu<sp/>location\n&quot;</highlight><highlight class="normal">,<ref refid="fti-intern_8h_1a5cb1252ae17ef4ac13b3dbe5a8b1ab13" kindref="member">FTI_EROR</ref>);</highlight></codeline>
<codeline lineno="866"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>].<ref refid="structFTIT__dataset_1a36ee086d6d8ddace556bdbdbd142acbb" kindref="member">ptr</ref><sp/>=<sp/>NULL;<sp/></highlight><highlight class="comment">//(void<sp/>*)<sp/>malloc<sp/>(type.size<sp/>*count);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="867"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="868"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="869"><highlight class="normal"></highlight><highlight class="preprocessor">#else<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="870"><highlight class="normal"><sp/><sp/><sp/><sp/>strcpy(memLocation,</highlight><highlight class="stringliteral">&quot;CPU&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="871"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Data[FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>].<ref refid="structFTIT__dataset_1af5787410c1a17d552c402533a95afebd" kindref="member">isDevicePtr</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="872"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Data[FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>].<ref refid="structFTIT__dataset_1a02c90a2a92a7de7cc2407c228053d173" kindref="member">devicePtr</ref>=<sp/>NULL;</highlight></codeline>
<codeline lineno="873"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Data[FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>].<ref refid="structFTIT__dataset_1a36ee086d6d8ddace556bdbdbd142acbb" kindref="member">ptr</ref><sp/>=<sp/>ptr;</highlight></codeline>
<codeline lineno="874"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/><sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="875"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Important<sp/>assignment,<sp/>we<sp/>use<sp/>realloc!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="876"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Data[FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>].<ref refid="structFTIT__dataset_1ae7848aea95a9ee1857e0510c5aa61700" kindref="member">sharedData</ref>.<ref refid="structFTIT__sharedData_1ab0853dbe65ce5963c588e0f4dbaa1712" kindref="member">dataset</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="877"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Data[FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>].<ref refid="structFTIT__dataset_1abc07f32e21abf951afcae67f9636e65c" kindref="member">count</ref><sp/>=<sp/>count;</highlight></codeline>
<codeline lineno="878"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Data[FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>].<ref refid="structFTIT__dataset_1a564e1a87d53b7b4e834ea0ece45c35fb" kindref="member">type</ref><sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a6cbf8f36622f495540e6af68525013d6" kindref="member">FTI_Type</ref>[type.<ref refid="structFTIT__type_1a75237aa3e6824b450ee623bffb36608a" kindref="member">id</ref>];</highlight></codeline>
<codeline lineno="879"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Data[FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>].<ref refid="structFTIT__dataset_1aa0f368e577ef8f2b564d2607cdb958d1" kindref="member">eleSize</ref><sp/>=<sp/>type.<ref refid="structFTIT__type_1ae849a5abd72710611f1830155f2ce6c4" kindref="member">size</ref>;</highlight></codeline>
<codeline lineno="880"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Data[FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>].<ref refid="structFTIT__dataset_1a112f9319765938eba3339d86c0e140c9" kindref="member">size</ref><sp/>=<sp/>type.<ref refid="structFTIT__type_1ae849a5abd72710611f1830155f2ce6c4" kindref="member">size</ref><sp/>*<sp/>count;</highlight></codeline>
<codeline lineno="881"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Data[FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>].<ref refid="structFTIT__dataset_1abc5e19eb9d5f9ab72fd1cc4e2c6c4f8f" kindref="member">rank</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="882"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Data[FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>].<ref refid="structFTIT__dataset_1ad0a974da814771e2f244bef0542c9d25" kindref="member">dimLength</ref>[0]<sp/>=<sp/>FTI_Data[FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>].<ref refid="structFTIT__dataset_1abc07f32e21abf951afcae67f9636e65c" kindref="member">count</ref>;</highlight></codeline>
<codeline lineno="883"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Data[FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>].<ref refid="structFTIT__dataset_1a45ceca28ab7961bd174fb418d3bf406a" kindref="member">h5group</ref><sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a896039ee736e3c0676fe13df8b1ac345" kindref="member">H5groups</ref>[0];</highlight></codeline>
<codeline lineno="884"><highlight class="normal"><sp/><sp/><sp/><sp/>sprintf(FTI_Data[FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>].<ref refid="structFTIT__dataset_1a487d5e46155d0f9d961993521eef41f6" kindref="member">name</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Dataset_%d&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="885"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a19693c7f3a31b31d90a40dcf7fc34183" kindref="member">ckptSize</ref><sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a19693c7f3a31b31d90a40dcf7fc34183" kindref="member">ckptSize</ref><sp/>+<sp/>(type.<ref refid="structFTIT__type_1ae849a5abd72710611f1830155f2ce6c4" kindref="member">size</ref><sp/>*<sp/>count);</highlight></codeline>
<codeline lineno="886"><highlight class="normal"></highlight></codeline>
<codeline lineno="887"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>FTI_Conf.<ref refid="structFTIT__configuration_1a5e319b258138bbb03d5da9917f99acd6" kindref="member">dcpPosix</ref><sp/>){</highlight></codeline>
<codeline lineno="888"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!(FTI_Data[FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>].<ref refid="structFTIT__dataset_1af5787410c1a17d552c402533a95afebd" kindref="member">isDevicePtr</ref>)){</highlight></codeline>
<codeline lineno="889"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>nbHashes<sp/>=<sp/>FTI_Data[FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>].<ref refid="structFTIT__dataset_1a112f9319765938eba3339d86c0e140c9" kindref="member">size</ref><sp/>/FTI_Conf.<ref refid="structFTIT__configuration_1a082b3136afb25beb45f0c9ece72ddca7" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpConfigurationPosix_1a639ec25941ab5eac6d6c22ebc7fc232e" kindref="member">BlockSize</ref><sp/>+<sp/>(bool)(FTI_Data[FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>].<ref refid="structFTIT__dataset_1a112f9319765938eba3339d86c0e140c9" kindref="member">size</ref><sp/>%FTI_Conf.<ref refid="structFTIT__configuration_1a082b3136afb25beb45f0c9ece72ddca7" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpConfigurationPosix_1a639ec25941ab5eac6d6c22ebc7fc232e" kindref="member">BlockSize</ref>);</highlight></codeline>
<codeline lineno="890"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>].<ref refid="structFTIT__dataset_1af582d52ac7f4f2d56df03232cc0c6cb6" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpDatasetPosix_1ae090b0ed6cf9fe43ff63a9d54d279229" kindref="member">hashDataSize</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="891"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>].<ref refid="structFTIT__dataset_1af582d52ac7f4f2d56df03232cc0c6cb6" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpDatasetPosix_1a87104fc8812d30b59499828a54e00928" kindref="member">currentHashArray</ref>=<sp/>(</highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*)<sp/>malloc(<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">)*nbHashes*FTI_Conf.<ref refid="structFTIT__configuration_1a082b3136afb25beb45f0c9ece72ddca7" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpConfigurationPosix_1acdd6ef88f5b22e3c29dda4b7929ef866" kindref="member">digestWidth</ref><sp/>);</highlight></codeline>
<codeline lineno="892"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>].<ref refid="structFTIT__dataset_1af582d52ac7f4f2d56df03232cc0c6cb6" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpDatasetPosix_1a12592fffe729610a32e25d55bf107417" kindref="member">oldHashArray</ref>=<sp/>(</highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*)<sp/>malloc(<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">)*nbHashes*FTI_Conf.<ref refid="structFTIT__configuration_1a082b3136afb25beb45f0c9ece72ddca7" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpConfigurationPosix_1acdd6ef88f5b22e3c29dda4b7929ef866" kindref="member">digestWidth</ref><sp/>);</highlight></codeline>
<codeline lineno="893"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="894"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>GPUSUPPORT<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="895"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="896"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*x;</highlight></codeline>
<codeline lineno="897"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>nbNewHashes<sp/>=<sp/>FTI_Data[FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>].<ref refid="structFTIT__dataset_1a112f9319765938eba3339d86c0e140c9" kindref="member">size</ref><sp/>/FTI_Conf.<ref refid="structFTIT__configuration_1a082b3136afb25beb45f0c9ece72ddca7" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpConfigurationPosix_1a639ec25941ab5eac6d6c22ebc7fc232e" kindref="member">BlockSize</ref><sp/>+<sp/>(bool)(FTI_Data[FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>].<ref refid="structFTIT__dataset_1a112f9319765938eba3339d86c0e140c9" kindref="member">size</ref><sp/>%FTI_Conf.<ref refid="structFTIT__configuration_1a082b3136afb25beb45f0c9ece72ddca7" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpConfigurationPosix_1a639ec25941ab5eac6d6c22ebc7fc232e" kindref="member">BlockSize</ref>);</highlight></codeline>
<codeline lineno="898"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CUDA_ERROR_CHECK(cudaMallocManaged((</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">**)&amp;x,<sp/>nbNewHashes<sp/>*<sp/>FTI_Conf.<ref refid="structFTIT__configuration_1a082b3136afb25beb45f0c9ece72ddca7" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpConfigurationPosix_1acdd6ef88f5b22e3c29dda4b7929ef866" kindref="member">digestWidth</ref>,cudaMemAttachGlobal<sp/>));</highlight></codeline>
<codeline lineno="899"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>].<ref refid="structFTIT__dataset_1af582d52ac7f4f2d56df03232cc0c6cb6" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpDatasetPosix_1a87104fc8812d30b59499828a54e00928" kindref="member">currentHashArray</ref><sp/>=<sp/>x;</highlight></codeline>
<codeline lineno="900"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CUDA_ERROR_CHECK(cudaMallocManaged((</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">**)&amp;x,<sp/>nbNewHashes<sp/>*<sp/>FTI_Conf.<ref refid="structFTIT__configuration_1a082b3136afb25beb45f0c9ece72ddca7" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpConfigurationPosix_1acdd6ef88f5b22e3c29dda4b7929ef866" kindref="member">digestWidth</ref>,cudaMemAttachGlobal<sp/>));</highlight></codeline>
<codeline lineno="901"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>].<ref refid="structFTIT__dataset_1af582d52ac7f4f2d56df03232cc0c6cb6" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpDatasetPosix_1a12592fffe729610a32e25d55bf107417" kindref="member">oldHashArray</ref>=<sp/>x;</highlight></codeline>
<codeline lineno="902"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="903"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="904"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="905"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>strlen(FTI_Data[FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>].<ref refid="structFTIT__dataset_1a682b7ca95540127162a55c520f3a5e50" kindref="member">idChar</ref>)<sp/>==<sp/>0<sp/>){<sp/></highlight></codeline>
<codeline lineno="906"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sprintf(str,<sp/></highlight><highlight class="stringliteral">&quot;Variable<sp/>ID<sp/>%d<sp/>to<sp/>protect<sp/>(Stored<sp/>in<sp/>%s).<sp/>Current<sp/>ckpt.<sp/>size<sp/>per<sp/>rank<sp/>is<sp/>%.2fMB.&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>memLocation,<sp/>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal">)<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a19693c7f3a31b31d90a40dcf7fc34183" kindref="member">ckptSize</ref><sp/>/<sp/>(1024.0<sp/>*<sp/>1024.0));</highlight></codeline>
<codeline lineno="907"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="908"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="909"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sprintf(str,<sp/></highlight><highlight class="stringliteral">&quot;Variable<sp/>Named<sp/>%s<sp/>with<sp/>ID<sp/>%d<sp/>to<sp/>protect<sp/>(Stored<sp/>in<sp/>%s).<sp/>Current<sp/>ckpt.<sp/>size<sp/>per<sp/>rank<sp/>is<sp/>%.2fMB.&quot;</highlight><highlight class="normal">,FTI_Data[FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>].<ref refid="structFTIT__dataset_1a682b7ca95540127162a55c520f3a5e50" kindref="member">idChar</ref>,<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>memLocation,<sp/>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal">)<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a19693c7f3a31b31d90a40dcf7fc34183" kindref="member">ckptSize</ref><sp/>/<sp/>(1024.0<sp/>*<sp/>1024.0));</highlight></codeline>
<codeline lineno="910"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="911"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref><sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref><sp/>+<sp/>1;</highlight></codeline>
<codeline lineno="912"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(str,<sp/><ref refid="fti-intern_8h_1a26a561f0e03eec3d15541c85a2a21ffd" kindref="member">FTI_INFO</ref>);</highlight></codeline>
<codeline lineno="913"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="914"><highlight class="normal">}</highlight></codeline>
<codeline lineno="915"><highlight class="normal"></highlight></codeline>
<codeline lineno="916"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="933"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="934" refid="api_8c_1a1abef7eeec0efb4fb73b5929637aa90f" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="api_8c_1a1abef7eeec0efb4fb73b5929637aa90f" kindref="member">FTI_DefineGlobalDataset</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>rank,<sp/><ref refid="fti-intern_8h_1a93fc516f1fbe5fb3d37e6527684b8dd4" kindref="member">FTIT_hsize_t</ref>*<sp/>dimLength,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>name,<sp/><ref refid="structFTIT__H5Group" kindref="compound">FTIT_H5Group</ref>*<sp/>h5group,<sp/><ref refid="structFTIT__type" kindref="compound">FTIT_type</ref><sp/>type)</highlight></codeline>
<codeline lineno="935"><highlight class="normal">{</highlight></codeline>
<codeline lineno="936"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>ENABLE_HDF5</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="937"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structFTIT__globalDataset" kindref="compound">FTIT_globalDataset</ref>*<sp/>last<sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1ab742b517dd48ed019f0629f231cf70c4" kindref="member">globalDatasets</ref>;</highlight></codeline>
<codeline lineno="938"><highlight class="normal"></highlight></codeline>
<codeline lineno="939"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>last<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="940"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structFTIT__globalDataset" kindref="compound">FTIT_globalDataset</ref>*<sp/>curr<sp/>=<sp/>last;</highlight></codeline>
<codeline lineno="941"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(<sp/>curr<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="942"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal"><sp/>==<sp/>last-&gt;<ref refid="structFTIT__globalDataset_1af8ebff1890fa95ab3229db71e6ec5414" kindref="member">id</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="943"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>str[<ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>];</highlight></codeline>
<codeline lineno="944"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>snprintf(<sp/>str,<sp/><ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;FTI_DefineGlobalDataset<sp/>::<sp/>id<sp/>&apos;%d&apos;<sp/>is<sp/>already<sp/>taken.&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal"><sp/>);</highlight></codeline>
<codeline lineno="945"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(str,<sp/><ref refid="fti-intern_8h_1a5cb1252ae17ef4ac13b3dbe5a8b1ab13" kindref="member">FTI_EROR</ref>);</highlight></codeline>
<codeline lineno="946"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="947"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="948"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>last<sp/>=<sp/>curr;</highlight></codeline>
<codeline lineno="949"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>curr<sp/>=<sp/>last-&gt;<ref refid="structFTIT__globalDataset_1a535ac75cfd86dceb21d5cc03451ef52f" kindref="member">next</ref>;</highlight></codeline>
<codeline lineno="950"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="951"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>last-&gt;<ref refid="structFTIT__globalDataset_1a535ac75cfd86dceb21d5cc03451ef52f" kindref="member">next</ref><sp/>=<sp/>(<ref refid="structFTIT__globalDataset" kindref="compound">FTIT_globalDataset</ref>*)<sp/>malloc(<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structFTIT__globalDataset" kindref="compound">FTIT_globalDataset</ref>)<sp/>);</highlight></codeline>
<codeline lineno="952"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>last<sp/>=<sp/>last-&gt;<ref refid="structFTIT__globalDataset_1a535ac75cfd86dceb21d5cc03451ef52f" kindref="member">next</ref>;</highlight></codeline>
<codeline lineno="953"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="954"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>last<sp/>=<sp/>(<ref refid="structFTIT__globalDataset" kindref="compound">FTIT_globalDataset</ref>*)<sp/>malloc(<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structFTIT__globalDataset" kindref="compound">FTIT_globalDataset</ref>)<sp/>);</highlight></codeline>
<codeline lineno="955"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1ab742b517dd48ed019f0629f231cf70c4" kindref="member">globalDatasets</ref><sp/>=<sp/>last;</highlight></codeline>
<codeline lineno="956"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="957"><highlight class="normal"></highlight></codeline>
<codeline lineno="958"><highlight class="normal"><sp/><sp/><sp/><sp/>last-&gt;<ref refid="structFTIT__globalDataset_1af8ebff1890fa95ab3229db71e6ec5414" kindref="member">id</ref><sp/>=<sp/>id;</highlight></codeline>
<codeline lineno="959"><highlight class="normal"><sp/><sp/><sp/><sp/>last-&gt;<ref refid="structFTIT__globalDataset_1ab8d8a8966c7ef637fc7749d1b51998eb" kindref="member">initialized</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="960"><highlight class="normal"><sp/><sp/><sp/><sp/>last-&gt;<ref refid="structFTIT__globalDataset_1ae2c6b2349efc0ce0c737f74a3e72ac44" kindref="member">rank</ref><sp/>=<sp/>rank;</highlight></codeline>
<codeline lineno="961"><highlight class="normal"><sp/><sp/><sp/><sp/>last-&gt;hid<sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="962"><highlight class="normal"><sp/><sp/><sp/><sp/>last-&gt;fileSpace<sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="963"><highlight class="normal"><sp/><sp/><sp/><sp/>last-&gt;dimension<sp/>=<sp/>(hsize_t*)<sp/>malloc(<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(hsize_t)<sp/>*<sp/>rank<sp/>);</highlight></codeline>
<codeline lineno="964"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="965"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(<sp/>i=0;<sp/>i&lt;rank;<sp/>i++<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="966"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>last-&gt;dimension[i]<sp/>=<sp/>dimLength[i];</highlight></codeline>
<codeline lineno="967"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="968"><highlight class="normal"><sp/><sp/><sp/><sp/>strncpy(<sp/>last-&gt;<ref refid="structFTIT__globalDataset_1ace6e182d8761bea731d06771338ae8b6" kindref="member">name</ref>,<sp/>name,<sp/><ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref><sp/>);</highlight></codeline>
<codeline lineno="969"><highlight class="normal"><sp/><sp/><sp/><sp/>last-&gt;<ref refid="structFTIT__globalDataset_1ace6e182d8761bea731d06771338ae8b6" kindref="member">name</ref>[<ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>-1]<sp/>=<sp/></highlight><highlight class="charliteral">&apos;\0&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="970"><highlight class="normal"><sp/><sp/><sp/><sp/>last-&gt;<ref refid="structFTIT__globalDataset_1a3ce86a21fb3f49d863167b4f16048943" kindref="member">numSubSets</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="971"><highlight class="normal"><sp/><sp/><sp/><sp/>last-&gt;<ref refid="structFTIT__globalDataset_1af48b50ca534531295f80a5532f66e498" kindref="member">varIdx</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="972"><highlight class="normal"><sp/><sp/><sp/><sp/>last-&gt;<ref refid="structFTIT__globalDataset_1a53789d90520a5366a24d96f1a86d0024" kindref="member">type</ref><sp/>=<sp/>type;</highlight></codeline>
<codeline lineno="973"><highlight class="normal"><sp/><sp/><sp/><sp/>last-&gt;<ref refid="structFTIT__globalDataset_1a25208723790fe4dacc81170556e0529c" kindref="member">location</ref><sp/>=<sp/>(h5group)<sp/>?<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a896039ee736e3c0676fe13df8b1ac345" kindref="member">H5groups</ref>[h5group-&gt;<ref refid="structFTIT__H5Group_1a3de0568ad296bc36607c871f14f4daa0" kindref="member">id</ref>]<sp/>:<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a896039ee736e3c0676fe13df8b1ac345" kindref="member">H5groups</ref>[0];</highlight></codeline>
<codeline lineno="974"><highlight class="normal"></highlight></codeline>
<codeline lineno="975"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>safe<sp/>path<sp/>to<sp/>dataset</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="976"><highlight class="normal"><sp/><sp/><sp/><sp/>snprintf(<sp/>last-&gt;<ref refid="structFTIT__globalDataset_1ab467b1105df99c66d226cc5382a2fcba" kindref="member">fullName</ref>,<sp/><ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;%s/%s&quot;</highlight><highlight class="normal">,<sp/>last-&gt;<ref refid="structFTIT__globalDataset_1a25208723790fe4dacc81170556e0529c" kindref="member">location</ref>-&gt;<ref refid="structFTIT__H5Group_1a4c2782e143b281b771470cff79663db2" kindref="member">fullName</ref>,<sp/>last-&gt;<ref refid="structFTIT__globalDataset_1ace6e182d8761bea731d06771338ae8b6" kindref="member">name</ref><sp/>);<sp/></highlight></codeline>
<codeline lineno="977"><highlight class="normal"></highlight></codeline>
<codeline lineno="978"><highlight class="normal"><sp/><sp/><sp/><sp/>last-&gt;<ref refid="structFTIT__globalDataset_1a535ac75cfd86dceb21d5cc03451ef52f" kindref="member">next</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="979"><highlight class="normal"></highlight></codeline>
<codeline lineno="980"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="981"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="982"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;&apos;FTI_DefineGlobalDataset&apos;<sp/>is<sp/>an<sp/>HDF5<sp/>feature.<sp/>Please<sp/>enable<sp/>HDF5<sp/>and<sp/>recompile.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="983"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="984"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="985"><highlight class="normal">}</highlight></codeline>
<codeline lineno="986"><highlight class="normal"></highlight></codeline>
<codeline lineno="987"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="1004"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1005" refid="api_8c_1a55e7d096389f363b570084126af8ece5" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="api_8c_1a55e7d096389f363b570084126af8ece5" kindref="member">FTI_AddSubset</ref>(<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>rank,<sp/><ref refid="fti-intern_8h_1a93fc516f1fbe5fb3d37e6527684b8dd4" kindref="member">FTIT_hsize_t</ref>*<sp/>offset,<sp/><ref refid="fti-intern_8h_1a93fc516f1fbe5fb3d37e6527684b8dd4" kindref="member">FTIT_hsize_t</ref>*<sp/>count,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>did<sp/>)</highlight></codeline>
<codeline lineno="1006"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1007"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>ENABLE_HDF5</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1008"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i,<sp/>found=0,<sp/>pvar_idx;</highlight></codeline>
<codeline lineno="1009"><highlight class="normal"></highlight></codeline>
<codeline lineno="1010"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(i=0;<sp/>i&lt;FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="1011"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>FTI_Data[i].</highlight><highlight class="keywordtype">id</highlight><highlight class="normal"><sp/>==<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal"><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1012"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>found<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="1013"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pvar_idx<sp/>=<sp/>i;</highlight></codeline>
<codeline lineno="1014"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1015"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1016"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1017"><highlight class="normal"></highlight></codeline>
<codeline lineno="1018"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!found<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1019"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(<sp/></highlight><highlight class="stringliteral">&quot;variable<sp/>id<sp/>could<sp/>not<sp/>be<sp/>found!&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a5cb1252ae17ef4ac13b3dbe5a8b1ab13" kindref="member">FTI_EROR</ref><sp/>);</highlight></codeline>
<codeline lineno="1020"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1021"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1022"><highlight class="normal"></highlight></codeline>
<codeline lineno="1023"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>GPUSUPPORT<sp/><sp/><sp/><sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1024"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>!FTI_Data[pvar_idx].isDevicePtr<sp/>){</highlight></codeline>
<codeline lineno="1025"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1026"><highlight class="normal"></highlight></codeline>
<codeline lineno="1027"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>found<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1028"><highlight class="normal"></highlight></codeline>
<codeline lineno="1029"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structFTIT__globalDataset" kindref="compound">FTIT_globalDataset</ref>*<sp/>dataset<sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1ab742b517dd48ed019f0629f231cf70c4" kindref="member">globalDatasets</ref>;</highlight></codeline>
<codeline lineno="1030"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(<sp/>dataset<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1031"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>dataset-&gt;<ref refid="structFTIT__globalDataset_1af8ebff1890fa95ab3229db71e6ec5414" kindref="member">id</ref><sp/>==<sp/>did<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1032"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>found<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="1033"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1034"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1035"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dataset<sp/>=<sp/>dataset-&gt;<ref refid="structFTIT__globalDataset_1a535ac75cfd86dceb21d5cc03451ef52f" kindref="member">next</ref>;</highlight></codeline>
<codeline lineno="1036"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1037"><highlight class="normal"></highlight></codeline>
<codeline lineno="1038"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!found<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1039"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(<sp/></highlight><highlight class="stringliteral">&quot;dataset<sp/>id<sp/>could<sp/>not<sp/>be<sp/>found!&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a5cb1252ae17ef4ac13b3dbe5a8b1ab13" kindref="member">FTI_EROR</ref><sp/>);</highlight></codeline>
<codeline lineno="1040"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1041"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1042"><highlight class="normal"></highlight></codeline>
<codeline lineno="1043"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>dataset-&gt;<ref refid="structFTIT__globalDataset_1ae2c6b2349efc0ce0c737f74a3e72ac44" kindref="member">rank</ref><sp/>!=<sp/>rank<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1044"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;rank<sp/>missmatch!&quot;</highlight><highlight class="normal">,<ref refid="fti-intern_8h_1a5cb1252ae17ef4ac13b3dbe5a8b1ab13" kindref="member">FTI_EROR</ref>);</highlight></codeline>
<codeline lineno="1045"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1046"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1047"><highlight class="normal"></highlight></codeline>
<codeline lineno="1048"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dataset-&gt;<ref refid="structFTIT__globalDataset_1a3ce86a21fb3f49d863167b4f16048943" kindref="member">numSubSets</ref>++;</highlight></codeline>
<codeline lineno="1049"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dataset-&gt;<ref refid="structFTIT__globalDataset_1af48b50ca534531295f80a5532f66e498" kindref="member">varIdx</ref><sp/>=<sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">*)<sp/>realloc(<sp/>dataset-&gt;<ref refid="structFTIT__globalDataset_1af48b50ca534531295f80a5532f66e498" kindref="member">varIdx</ref>,<sp/>dataset-&gt;<ref refid="structFTIT__globalDataset_1a3ce86a21fb3f49d863167b4f16048943" kindref="member">numSubSets</ref>*</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)<sp/>);</highlight></codeline>
<codeline lineno="1050"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dataset-&gt;<ref refid="structFTIT__globalDataset_1af48b50ca534531295f80a5532f66e498" kindref="member">varIdx</ref>[dataset-&gt;<ref refid="structFTIT__globalDataset_1a3ce86a21fb3f49d863167b4f16048943" kindref="member">numSubSets</ref>-1]<sp/>=<sp/>pvar_idx;</highlight></codeline>
<codeline lineno="1051"><highlight class="normal"></highlight></codeline>
<codeline lineno="1052"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[pvar_idx].<ref refid="structFTIT__dataset_1ae7848aea95a9ee1857e0510c5aa61700" kindref="member">sharedData</ref>.<ref refid="structFTIT__sharedData_1ab0853dbe65ce5963c588e0f4dbaa1712" kindref="member">dataset</ref><sp/>=<sp/>dataset;</highlight></codeline>
<codeline lineno="1053"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[pvar_idx].<ref refid="structFTIT__dataset_1ae7848aea95a9ee1857e0510c5aa61700" kindref="member">sharedData</ref>.offset<sp/>=<sp/>(hsize_t*)<sp/>malloc(<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(hsize_t)<sp/>*<sp/>rank<sp/>);</highlight></codeline>
<codeline lineno="1054"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[pvar_idx].<ref refid="structFTIT__dataset_1ae7848aea95a9ee1857e0510c5aa61700" kindref="member">sharedData</ref>.count<sp/>=<sp/>(hsize_t*)<sp/>malloc(<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(hsize_t)<sp/>*<sp/>rank<sp/>);</highlight></codeline>
<codeline lineno="1055"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(i=0;<sp/>i&lt;rank;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="1056"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[pvar_idx].<ref refid="structFTIT__dataset_1ae7848aea95a9ee1857e0510c5aa61700" kindref="member">sharedData</ref>.offset[i]<sp/>=<sp/>offset[i];</highlight></codeline>
<codeline lineno="1057"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[pvar_idx].<ref refid="structFTIT__dataset_1ae7848aea95a9ee1857e0510c5aa61700" kindref="member">sharedData</ref>.count[i]<sp/>=<sp/>count[i];</highlight></codeline>
<codeline lineno="1058"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1059"><highlight class="normal"></highlight></codeline>
<codeline lineno="1060"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="1061"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>GPUSUPPORT<sp/><sp/><sp/><sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1062"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1063"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;Dataset<sp/>is<sp/>on<sp/>GPU<sp/>memory.<sp/>VPR<sp/>does<sp/>not<sp/>have<sp/>GPU<sp/>support<sp/>yet!&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1064"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1065"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1066"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1067"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1068"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;&apos;FTI_AddSubset&apos;<sp/>is<sp/>an<sp/>HDF5<sp/>feature.<sp/>Please<sp/>enable<sp/>HDF5<sp/>and<sp/>recompile.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1069"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1070"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1071"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1072"><highlight class="normal"></highlight></codeline>
<codeline lineno="1073"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="1083"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1084" refid="api_8c_1aa52eec71c6460f10f2986acef5469c48" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="api_8c_1aa52eec71c6460f10f2986acef5469c48" kindref="member">FTI_UpdateGlobalDataset</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>rank,<sp/><ref refid="fti-intern_8h_1a93fc516f1fbe5fb3d37e6527684b8dd4" kindref="member">FTIT_hsize_t</ref>*<sp/>dimLength<sp/>)</highlight></codeline>
<codeline lineno="1085"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1086"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>ENABLE_HDF5</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1087"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structFTIT__globalDataset" kindref="compound">FTIT_globalDataset</ref>*<sp/>dataset<sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1ab742b517dd48ed019f0629f231cf70c4" kindref="member">globalDatasets</ref>;</highlight></codeline>
<codeline lineno="1088"><highlight class="normal"></highlight></codeline>
<codeline lineno="1089"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>!dataset<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1090"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;there<sp/>are<sp/>no<sp/>global<sp/>datasets<sp/>defined!&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1091"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1092"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1093"><highlight class="normal"></highlight></codeline>
<codeline lineno="1094"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>found<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1095"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(<sp/>dataset<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1096"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal"><sp/>==<sp/>dataset-&gt;<ref refid="structFTIT__globalDataset_1af8ebff1890fa95ab3229db71e6ec5414" kindref="member">id</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1097"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>found<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1098"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1099"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dataset<sp/>=<sp/>dataset-&gt;<ref refid="structFTIT__globalDataset_1a535ac75cfd86dceb21d5cc03451ef52f" kindref="member">next</ref>;</highlight></codeline>
<codeline lineno="1101"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1102"><highlight class="normal"></highlight></codeline>
<codeline lineno="1103"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!found<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(<sp/></highlight><highlight class="stringliteral">&quot;invalid<sp/>dataset<sp/>id!&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref><sp/>);</highlight></codeline>
<codeline lineno="1105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1106"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1107"><highlight class="normal"></highlight></codeline>
<codeline lineno="1108"><highlight class="normal"><sp/><sp/><sp/><sp/>dataset-&gt;<ref refid="structFTIT__globalDataset_1ae2c6b2349efc0ce0c737f74a3e72ac44" kindref="member">rank</ref><sp/>=<sp/>rank;</highlight></codeline>
<codeline lineno="1109"><highlight class="normal"><sp/><sp/><sp/><sp/>dataset-&gt;dimension<sp/>=<sp/>(hsize_t*)<sp/>realloc(<sp/>dataset-&gt;dimension,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(hsize_t)<sp/>*<sp/>rank<sp/>);</highlight></codeline>
<codeline lineno="1110"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="1111"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(<sp/>i=0;<sp/>i&lt;rank;<sp/>i++<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dataset-&gt;dimension[i]<sp/>=<sp/>dimLength[i];</highlight></codeline>
<codeline lineno="1113"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1114"><highlight class="normal"></highlight></codeline>
<codeline lineno="1115"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="1116"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1117"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;&apos;FTI_UpdateGlobalDataset&apos;<sp/>is<sp/>an<sp/>HDF5<sp/>feature.<sp/>Please<sp/>enable<sp/>HDF5<sp/>and<sp/>recompile.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1118"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1119"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1120"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1121"><highlight class="normal"></highlight></codeline>
<codeline lineno="1122"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="1133"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1134" refid="api_8c_1ad1fb249ff8d7f4b44e40e7e5c027d411" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="api_8c_1ad1fb249ff8d7f4b44e40e7e5c027d411" kindref="member">FTI_UpdateSubset</ref>(<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>rank,<sp/><ref refid="fti-intern_8h_1a93fc516f1fbe5fb3d37e6527684b8dd4" kindref="member">FTIT_hsize_t</ref>*<sp/>offset,<sp/><ref refid="fti-intern_8h_1a93fc516f1fbe5fb3d37e6527684b8dd4" kindref="member">FTIT_hsize_t</ref>*<sp/>count,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>did<sp/>)</highlight></codeline>
<codeline lineno="1135"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1136"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>ENABLE_HDF5</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1137"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i,<sp/>found=0,<sp/>pvar_idx;</highlight></codeline>
<codeline lineno="1138"><highlight class="normal"></highlight></codeline>
<codeline lineno="1139"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(i=0;<sp/>i&lt;FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="1140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>FTI_Data[i].</highlight><highlight class="keywordtype">id</highlight><highlight class="normal"><sp/>==<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal"><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>found<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="1142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pvar_idx<sp/>=<sp/>i;</highlight></codeline>
<codeline lineno="1143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1145"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1146"><highlight class="normal"></highlight></codeline>
<codeline lineno="1147"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!found<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(<sp/></highlight><highlight class="stringliteral">&quot;variable<sp/>id<sp/>could<sp/>not<sp/>be<sp/>found!&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a5cb1252ae17ef4ac13b3dbe5a8b1ab13" kindref="member">FTI_EROR</ref><sp/>);</highlight></codeline>
<codeline lineno="1149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1150"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1151"><highlight class="normal"></highlight></codeline>
<codeline lineno="1152"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>GPUSUPPORT<sp/><sp/><sp/><sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1153"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>!FTI_Data[pvar_idx].isDevicePtr<sp/>){</highlight></codeline>
<codeline lineno="1154"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1155"><highlight class="normal"></highlight></codeline>
<codeline lineno="1156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structFTIT__globalDataset" kindref="compound">FTIT_globalDataset</ref>*<sp/>dataset<sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1ab742b517dd48ed019f0629f231cf70c4" kindref="member">globalDatasets</ref>;</highlight></codeline>
<codeline lineno="1157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(<sp/>dataset<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>dataset-&gt;<ref refid="structFTIT__globalDataset_1af8ebff1890fa95ab3229db71e6ec5414" kindref="member">id</ref><sp/>==<sp/>did<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dataset<sp/>=<sp/>dataset-&gt;<ref refid="structFTIT__globalDataset_1a535ac75cfd86dceb21d5cc03451ef52f" kindref="member">next</ref>;</highlight></codeline>
<codeline lineno="1162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1163"><highlight class="normal"></highlight></codeline>
<codeline lineno="1164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!dataset<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(<sp/></highlight><highlight class="stringliteral">&quot;dataset<sp/>id<sp/>could<sp/>not<sp/>be<sp/>found!&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a5cb1252ae17ef4ac13b3dbe5a8b1ab13" kindref="member">FTI_EROR</ref><sp/>);</highlight></codeline>
<codeline lineno="1166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1168"><highlight class="normal"></highlight></codeline>
<codeline lineno="1169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>dataset-&gt;<ref refid="structFTIT__globalDataset_1ae2c6b2349efc0ce0c737f74a3e72ac44" kindref="member">rank</ref><sp/>!=<sp/>rank<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;rank<sp/>missmatch!&quot;</highlight><highlight class="normal">,<ref refid="fti-intern_8h_1a5cb1252ae17ef4ac13b3dbe5a8b1ab13" kindref="member">FTI_EROR</ref>);</highlight></codeline>
<codeline lineno="1171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1173"><highlight class="normal"></highlight></codeline>
<codeline lineno="1174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(<sp/>i=0;<sp/>i&lt;dataset-&gt;<ref refid="structFTIT__globalDataset_1a3ce86a21fb3f49d863167b4f16048943" kindref="member">numSubSets</ref>;<sp/>i++<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>dataset-&gt;<ref refid="structFTIT__globalDataset_1af48b50ca534531295f80a5532f66e498" kindref="member">varIdx</ref>[i]<sp/>==<sp/>pvar_idx<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1179"><highlight class="normal"></highlight></codeline>
<codeline lineno="1180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>i<sp/>==<sp/>dataset-&gt;<ref refid="structFTIT__globalDataset_1a3ce86a21fb3f49d863167b4f16048943" kindref="member">numSubSets</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;variable<sp/>is<sp/>not<sp/>subset<sp/>of<sp/>dataset!&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1184"><highlight class="normal"></highlight></codeline>
<codeline lineno="1185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[pvar_idx].<ref refid="structFTIT__dataset_1ae7848aea95a9ee1857e0510c5aa61700" kindref="member">sharedData</ref>.offset<sp/>=<sp/>(hsize_t*)<sp/>realloc(<sp/>FTI_Data[pvar_idx].sharedData.offset,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(hsize_t)<sp/>*<sp/>rank<sp/>);</highlight></codeline>
<codeline lineno="1186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[pvar_idx].<ref refid="structFTIT__dataset_1ae7848aea95a9ee1857e0510c5aa61700" kindref="member">sharedData</ref>.count<sp/>=<sp/>(hsize_t*)<sp/>realloc(<sp/>FTI_Data[pvar_idx].sharedData.<ref refid="structFTIT__dataset_1abc07f32e21abf951afcae67f9636e65c" kindref="member">count</ref>,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(hsize_t)<sp/>*<sp/>rank<sp/>);</highlight></codeline>
<codeline lineno="1187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(i=0;<sp/>i&lt;rank;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="1188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[pvar_idx].<ref refid="structFTIT__dataset_1ae7848aea95a9ee1857e0510c5aa61700" kindref="member">sharedData</ref>.offset[i]<sp/>=<sp/>offset[i];</highlight></codeline>
<codeline lineno="1189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[pvar_idx].<ref refid="structFTIT__dataset_1ae7848aea95a9ee1857e0510c5aa61700" kindref="member">sharedData</ref>.count[i]<sp/>=<sp/>count[i];</highlight></codeline>
<codeline lineno="1190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1191"><highlight class="normal"></highlight></codeline>
<codeline lineno="1192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="1193"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>GPUSUPPORT<sp/><sp/><sp/><sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1194"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;Dataset<sp/>is<sp/>on<sp/>GPU<sp/>memory.<sp/>VPR<sp/>does<sp/>not<sp/>have<sp/>GPU<sp/>support<sp/>yet!&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1197"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1198"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1199"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1200"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;&apos;FTI_AddSubset&apos;<sp/>is<sp/>an<sp/>HDF5<sp/>feature.<sp/>Please<sp/>enable<sp/>HDF5<sp/>and<sp/>recompile.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1201"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1202"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1203"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1204"><highlight class="normal"></highlight></codeline>
<codeline lineno="1205"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="1211"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1212" refid="api_8c_1a8dd9c8d88cc5e17214c384478b441dd5" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="api_8c_1a8dd9c8d88cc5e17214c384478b441dd5" kindref="member">FTI_GetDatasetRank</ref>(<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>did<sp/>)<sp/></highlight></codeline>
<codeline lineno="1213"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1214"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>ENABLE_HDF5<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1215"><highlight class="normal"></highlight></codeline>
<codeline lineno="1216"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structFTIT__globalDataset" kindref="compound">FTIT_globalDataset</ref><sp/>*<sp/>dataset<sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1ab742b517dd48ed019f0629f231cf70c4" kindref="member">globalDatasets</ref>;</highlight></codeline>
<codeline lineno="1217"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!dataset<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;No<sp/>datasets<sp/>defined!&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1220"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1221"><highlight class="normal"></highlight></codeline>
<codeline lineno="1222"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(<sp/>dataset<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>dataset-&gt;<ref refid="structFTIT__globalDataset_1af8ebff1890fa95ab3229db71e6ec5414" kindref="member">id</ref><sp/>==<sp/>did<sp/>)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dataset<sp/>=<sp/>dataset-&gt;<ref refid="structFTIT__globalDataset_1a535ac75cfd86dceb21d5cc03451ef52f" kindref="member">next</ref>;</highlight></codeline>
<codeline lineno="1225"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1226"><highlight class="normal"></highlight></codeline>
<codeline lineno="1227"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!dataset<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(<sp/></highlight><highlight class="stringliteral">&quot;Failed<sp/>to<sp/>find<sp/>dataset<sp/>in<sp/>list!&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref><sp/>);</highlight></codeline>
<codeline lineno="1229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1230"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1231"><highlight class="normal"></highlight></codeline>
<codeline lineno="1232"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>dataset-&gt;<ref refid="structFTIT__globalDataset_1ae2c6b2349efc0ce0c737f74a3e72ac44" kindref="member">rank</ref>;</highlight></codeline>
<codeline lineno="1233"><highlight class="normal"></highlight></codeline>
<codeline lineno="1234"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1235"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;&apos;FTI_GetDatasetRank&apos;<sp/>is<sp/>an<sp/>HDF5<sp/>feature.<sp/>Please<sp/>enable<sp/>HDF5<sp/>and<sp/>recompile.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1236"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1237"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1238"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1239"><highlight class="normal"></highlight></codeline>
<codeline lineno="1240"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="1247"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1248" refid="api_8c_1a4f699b71886c24e17b68028c6582449b" refkind="member"><highlight class="normal"><ref refid="fti-intern_8h_1a93fc516f1fbe5fb3d37e6527684b8dd4" kindref="member">FTIT_hsize_t</ref>*<sp/><ref refid="api_8c_1a4f699b71886c24e17b68028c6582449b" kindref="member">FTI_GetDatasetSpan</ref>(<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>did,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>rank<sp/>)<sp/></highlight></codeline>
<codeline lineno="1249"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1250"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>ENABLE_HDF5<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1251"><highlight class="normal"></highlight></codeline>
<codeline lineno="1252"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>hsize_t<sp/>span[FTI_HDF5_MAX_DIM];</highlight></codeline>
<codeline lineno="1253"><highlight class="normal"></highlight></codeline>
<codeline lineno="1254"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structFTIT__globalDataset" kindref="compound">FTIT_globalDataset</ref><sp/>*<sp/>dataset<sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1ab742b517dd48ed019f0629f231cf70c4" kindref="member">globalDatasets</ref>;</highlight></codeline>
<codeline lineno="1255"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!dataset<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;No<sp/>datasets<sp/>defined!&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="1258"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1259"><highlight class="normal"></highlight></codeline>
<codeline lineno="1260"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(<sp/>dataset<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>dataset-&gt;<ref refid="structFTIT__globalDataset_1af8ebff1890fa95ab3229db71e6ec5414" kindref="member">id</ref><sp/>==<sp/>did<sp/>)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dataset<sp/>=<sp/>dataset-&gt;<ref refid="structFTIT__globalDataset_1a535ac75cfd86dceb21d5cc03451ef52f" kindref="member">next</ref>;</highlight></codeline>
<codeline lineno="1263"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1264"><highlight class="normal"></highlight></codeline>
<codeline lineno="1265"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!dataset<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(<sp/></highlight><highlight class="stringliteral">&quot;Failed<sp/>to<sp/>find<sp/>dataset<sp/>in<sp/>list!&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref><sp/>);</highlight></codeline>
<codeline lineno="1267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="1268"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1269"><highlight class="normal"></highlight></codeline>
<codeline lineno="1270"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>rank<sp/>!=<sp/>dataset-&gt;<ref refid="structFTIT__globalDataset_1ae2c6b2349efc0ce0c737f74a3e72ac44" kindref="member">rank</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;Dataset<sp/>rank<sp/>missmatch!&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="1273"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1274"><highlight class="normal"></highlight></codeline>
<codeline lineno="1275"><highlight class="normal"><sp/><sp/><sp/><sp/>memcpy(<sp/>span,<sp/>dataset-&gt;dimension,<sp/>rank*</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(hsize_t)<sp/>);</highlight></codeline>
<codeline lineno="1276"><highlight class="normal"></highlight></codeline>
<codeline lineno="1277"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>span;</highlight></codeline>
<codeline lineno="1278"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1279"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;&apos;FTI_GetDatasetSpan&apos;<sp/>is<sp/>an<sp/>HDF5<sp/>feature.<sp/>Please<sp/>enable<sp/>HDF5<sp/>and<sp/>recompile.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1280"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="1281"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1282"><highlight class="normal"></highlight></codeline>
<codeline lineno="1283"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1284"><highlight class="normal"></highlight></codeline>
<codeline lineno="1285"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="1290"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1291" refid="api_8c_1a79b24fc99e9cb826b2ad1d0cb6185882" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="api_8c_1a79b24fc99e9cb826b2ad1d0cb6185882" kindref="member">FTI_RecoverDatasetDimension</ref>(<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>did<sp/>)<sp/></highlight></codeline>
<codeline lineno="1292"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1293"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>ENABLE_HDF5<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1294"><highlight class="normal"></highlight></codeline>
<codeline lineno="1295"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a061085b1c93b22c4fafbe527e7b1f165" kindref="member">reco</ref><sp/>!=<sp/>3<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;this<sp/>is<sp/>no<sp/>VPR<sp/>recovery!&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1298"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1299"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structFTIT__globalDataset" kindref="compound">FTIT_globalDataset</ref><sp/>*<sp/>dataset<sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1ab742b517dd48ed019f0629f231cf70c4" kindref="member">globalDatasets</ref>;</highlight></codeline>
<codeline lineno="1300"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!dataset<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;No<sp/>datasets<sp/>defined!&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1303"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1304"><highlight class="normal"></highlight></codeline>
<codeline lineno="1305"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(<sp/>dataset<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>dataset-&gt;<ref refid="structFTIT__globalDataset_1af8ebff1890fa95ab3229db71e6ec5414" kindref="member">id</ref><sp/>==<sp/>did<sp/>)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dataset<sp/>=<sp/>dataset-&gt;<ref refid="structFTIT__globalDataset_1a535ac75cfd86dceb21d5cc03451ef52f" kindref="member">next</ref>;</highlight></codeline>
<codeline lineno="1308"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1309"><highlight class="normal"></highlight></codeline>
<codeline lineno="1310"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!dataset<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(<sp/></highlight><highlight class="stringliteral">&quot;Failed<sp/>to<sp/>find<sp/>dataset<sp/>in<sp/>list!&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref><sp/>);</highlight></codeline>
<codeline lineno="1312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1313"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1314"><highlight class="normal"></highlight></codeline>
<codeline lineno="1315"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>open<sp/>HDF5<sp/>file</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1316"><highlight class="normal"><sp/><sp/><sp/><sp/>hid_t<sp/>plid<sp/>=<sp/>H5Pcreate(<sp/>H5P_FILE_ACCESS<sp/>);</highlight></codeline>
<codeline lineno="1317"><highlight class="normal"><sp/><sp/><sp/><sp/>H5Pset_fapl_mpio(<sp/>plid,<sp/><ref refid="api_8c_1a7deaa5171fbf22fe59ae1c08f2bdcc97" kindref="member">FTI_COMM_WORLD</ref>,<sp/>MPI_INFO_NULL<sp/>);</highlight></codeline>
<codeline lineno="1318"><highlight class="normal"><sp/><sp/><sp/><sp/>hid_t<sp/>file_id<sp/>=<sp/>H5Fopen(<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a8cd3cee6e7fd29ee3ea43882a3438623" kindref="member">h5SingleFileReco</ref>,<sp/>H5F_ACC_RDONLY,<sp/>plid<sp/>);</highlight></codeline>
<codeline lineno="1319"><highlight class="normal"><sp/><sp/><sp/><sp/>H5Pclose(<sp/>plid<sp/>);</highlight></codeline>
<codeline lineno="1320"><highlight class="normal"></highlight></codeline>
<codeline lineno="1321"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//hid_t<sp/>gid<sp/>=<sp/>H5Gopen1(<sp/>file_id,<sp/>dataset-&gt;location-&gt;name<sp/>);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1322"><highlight class="normal"><sp/><sp/><sp/><sp/>hid_t<sp/>dataset_id<sp/>=<sp/>H5Dopen(<sp/>file_id,<sp/>dataset-&gt;<ref refid="structFTIT__globalDataset_1ab467b1105df99c66d226cc5382a2fcba" kindref="member">fullName</ref>,<sp/>H5P_DEFAULT);</highlight></codeline>
<codeline lineno="1323"><highlight class="normal"></highlight></codeline>
<codeline lineno="1324"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>drank<sp/>=<sp/>FTI_GetDatasetRankReco(<sp/>dataset_id<sp/>);</highlight></codeline>
<codeline lineno="1325"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>drank<sp/>!=<sp/>dataset-&gt;<ref refid="structFTIT__globalDataset_1ae2c6b2349efc0ce0c737f74a3e72ac44" kindref="member">rank</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(<sp/></highlight><highlight class="stringliteral">&quot;Rank<sp/>missmatch!&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref><sp/>);</highlight></codeline>
<codeline lineno="1327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1328"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1329"><highlight class="normal"></highlight></codeline>
<codeline lineno="1330"><highlight class="normal"><sp/><sp/><sp/><sp/>hsize_t<sp/>*span<sp/>=<sp/>(hsize_t*)<sp/>malloc(<sp/>drank<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(hsize_t)<sp/>);</highlight></codeline>
<codeline lineno="1331"><highlight class="normal"></highlight></codeline>
<codeline lineno="1332"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>status<sp/>=<sp/>FTI_GetDatasetSpanReco(<sp/>dataset_id,<sp/>span<sp/>);</highlight></codeline>
<codeline lineno="1333"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>status<sp/>!=<sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;Failed<sp/>to<sp/>retrieve<sp/>span!&quot;</highlight><highlight class="normal">,<ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1335"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1336"><highlight class="normal"></highlight></codeline>
<codeline lineno="1337"><highlight class="normal"><sp/><sp/><sp/><sp/>dataset-&gt;<ref refid="structFTIT__globalDataset_1ae2c6b2349efc0ce0c737f74a3e72ac44" kindref="member">rank</ref><sp/>=<sp/>drank;</highlight></codeline>
<codeline lineno="1338"><highlight class="normal"><sp/><sp/><sp/><sp/>free(<sp/>dataset-&gt;dimension<sp/>);</highlight></codeline>
<codeline lineno="1339"><highlight class="normal"><sp/><sp/><sp/><sp/>dataset-&gt;dimension<sp/>=<sp/>span;</highlight></codeline>
<codeline lineno="1340"><highlight class="normal"></highlight></codeline>
<codeline lineno="1341"><highlight class="normal"><sp/><sp/><sp/><sp/>H5Dclose(<sp/>did<sp/>);</highlight></codeline>
<codeline lineno="1342"><highlight class="normal"><sp/><sp/><sp/><sp/>H5Fclose(<sp/>file_id<sp/>);</highlight></codeline>
<codeline lineno="1343"><highlight class="normal"></highlight></codeline>
<codeline lineno="1344"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="1345"><highlight class="normal"></highlight></codeline>
<codeline lineno="1346"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1347"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;&apos;FTI_RecoverDatasetDimension&apos;<sp/>is<sp/>an<sp/>HDF5<sp/>feature.<sp/>Please<sp/>enable<sp/>HDF5<sp/>and<sp/>recompile.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1348"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1349"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1350"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1351"><highlight class="normal"></highlight></codeline>
<codeline lineno="1352"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="1366"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1367" refid="api_8c_1af4cb738277e5d80c40f10491015395cb" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="api_8c_1af4cb738277e5d80c40f10491015395cb" kindref="member">FTI_DefineDataset</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>rank,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal">*<sp/>dimLength,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>name,<sp/><ref refid="structFTIT__H5Group" kindref="compound">FTIT_H5Group</ref>*<sp/>h5group)</highlight></codeline>
<codeline lineno="1368"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1369"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Exec.<ref refid="structFTIT__execution_1a5ff8dd064b2a4cc4b7272abddacb8cc1" kindref="member">initSCES</ref><sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;FTI<sp/>is<sp/>not<sp/>initialized.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1372"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1373"><highlight class="normal"></highlight></codeline>
<codeline lineno="1374"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rank<sp/>&gt;<sp/>0<sp/>&amp;&amp;<sp/>dimLength<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;If<sp/>rank<sp/>&gt;<sp/>0,<sp/>the<sp/>dimLength<sp/>cannot<sp/>be<sp/>NULL.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1377"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1378"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rank<sp/>&gt;<sp/>32)<sp/>{</highlight></codeline>
<codeline lineno="1379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;Maximum<sp/>rank<sp/>is<sp/>32.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1381"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1382"><highlight class="normal"></highlight></codeline>
<codeline lineno="1383"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>str[<ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>];<sp/></highlight><highlight class="comment">//For<sp/>console<sp/>output</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1384"><highlight class="normal"></highlight></codeline>
<codeline lineno="1385"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="1386"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/><ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="1387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal"><sp/>==<sp/>FTI_Data[i].</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">)<sp/>{<sp/></highlight><highlight class="comment">//Search<sp/>for<sp/>dataset<sp/>with<sp/>given<sp/>id</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//check<sp/>if<sp/>size<sp/>is<sp/>correct</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>expectedSize<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="1390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>j;</highlight></codeline>
<codeline lineno="1391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(j<sp/>=<sp/>0;<sp/>j<sp/>&lt;<sp/>rank;<sp/>j++)<sp/>{</highlight></codeline>
<codeline lineno="1392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>expectedSize<sp/>*=<sp/>dimLength[j];<sp/></highlight><highlight class="comment">//compute<sp/>the<sp/>number<sp/>of<sp/>elements</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1394"><highlight class="normal"></highlight></codeline>
<codeline lineno="1395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rank<sp/>&gt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(expectedSize<sp/>!=<sp/>FTI_Data[i].count)<sp/>{</highlight></codeline>
<codeline lineno="1397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sprintf(str,<sp/></highlight><highlight class="stringliteral">&quot;Trying<sp/>to<sp/>define<sp/>datasize:<sp/>number<sp/>of<sp/>elements<sp/>%d,<sp/>but<sp/>the<sp/>dataset<sp/>count<sp/>is<sp/>%ld.&quot;</highlight><highlight class="normal">,<sp/>expectedSize,<sp/>FTI_Data[i].count);</highlight></codeline>
<codeline lineno="1398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(str,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[i].<ref refid="structFTIT__dataset_1abc5e19eb9d5f9ab72fd1cc4e2c6c4f8f" kindref="member">rank</ref><sp/>=<sp/>rank;</highlight></codeline>
<codeline lineno="1402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(j<sp/>=<sp/>0;<sp/>j<sp/>&lt;<sp/>rank;<sp/>j++)<sp/>{</highlight></codeline>
<codeline lineno="1403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[i].<ref refid="structFTIT__dataset_1ad0a974da814771e2f244bef0542c9d25" kindref="member">dimLength</ref>[j]<sp/>=<sp/>dimLength[j];</highlight></codeline>
<codeline lineno="1404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1406"><highlight class="normal"></highlight></codeline>
<codeline lineno="1407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(h5group<sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[i].<ref refid="structFTIT__dataset_1a45ceca28ab7961bd174fb418d3bf406a" kindref="member">h5group</ref><sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a896039ee736e3c0676fe13df8b1ac345" kindref="member">H5groups</ref>[h5group-&gt;<ref refid="structFTIT__H5Group_1a3de0568ad296bc36607c871f14f4daa0" kindref="member">id</ref>];</highlight></codeline>
<codeline lineno="1409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1410"><highlight class="normal"></highlight></codeline>
<codeline lineno="1411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(name<sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>memset(FTI_Data[i].name,</highlight><highlight class="charliteral">&apos;\0&apos;</highlight><highlight class="normal">,<ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>);</highlight></codeline>
<codeline lineno="1413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>strncpy(FTI_Data[i].name,<sp/>name,<sp/><ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>);</highlight></codeline>
<codeline lineno="1414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1415"><highlight class="normal"></highlight></codeline>
<codeline lineno="1416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="1417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1418"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1419"><highlight class="normal"></highlight></codeline>
<codeline lineno="1420"><highlight class="normal"><sp/><sp/><sp/><sp/>sprintf(str,<sp/></highlight><highlight class="stringliteral">&quot;The<sp/>dataset<sp/>#%d<sp/>not<sp/>initialized.<sp/>Use<sp/>FTI_Protect<sp/>first.&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1421"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(str,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1422"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1423"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1424"><highlight class="normal"></highlight></codeline>
<codeline lineno="1425"><highlight class="normal"></highlight></codeline>
<codeline lineno="1426"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="1438"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1439" refid="api_8c_1adb927ab62324ba774d8daf91afa01c76" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="api_8c_1adb927ab62324ba774d8daf91afa01c76" kindref="member">FTI_GetStoredSize</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1440"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1441"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Exec.<ref refid="structFTIT__execution_1a5ff8dd064b2a4cc4b7272abddacb8cc1" kindref="member">initSCES</ref><sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;FTI<sp/>is<sp/>not<sp/>initialized.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="1444"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1445"><highlight class="normal"></highlight></codeline>
<codeline lineno="1446"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="1447"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Search<sp/>first<sp/>in<sp/>temporary<sp/>metadata<sp/>(always<sp/>the<sp/>newest)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1448"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/><ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="1449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Exec.<ref refid="structFTIT__execution_1a800c2671725989e4b600fb8a62e4145e" kindref="member">meta</ref>[0].<ref refid="structFTIT__metadata_1aed21e735edbac0db31f09e23eb2e3b2f" kindref="member">varID</ref>[i]<sp/>==<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="1450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Exec.<ref refid="structFTIT__execution_1a800c2671725989e4b600fb8a62e4145e" kindref="member">meta</ref>[0].<ref refid="structFTIT__metadata_1aa823ffc7331029d058ef43a742309231" kindref="member">varSize</ref>[i]<sp/>!=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a800c2671725989e4b600fb8a62e4145e" kindref="member">meta</ref>[0].<ref refid="structFTIT__metadata_1aa823ffc7331029d058ef43a742309231" kindref="member">varSize</ref>[i];</highlight></codeline>
<codeline lineno="1452"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1455"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1456"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//If<sp/>couldn&apos;t<sp/>find<sp/>in<sp/>temporary<sp/>metadata,<sp/>search<sp/>in<sp/>last<sp/>level<sp/>checkpoint</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1457"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//(this<sp/>means<sp/>no<sp/>checkpoint<sp/>was<sp/>taken<sp/>in<sp/>current<sp/>execution)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1458"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/><ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="1459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Exec.<ref refid="structFTIT__execution_1a800c2671725989e4b600fb8a62e4145e" kindref="member">meta</ref>[FTI_Exec.<ref refid="structFTIT__execution_1a19a4f92c1d8dd2c86350f59eb7372ca8" kindref="member">ckptLvel</ref>].<ref refid="structFTIT__metadata_1aed21e735edbac0db31f09e23eb2e3b2f" kindref="member">varID</ref>[i]<sp/>==<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="1460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a800c2671725989e4b600fb8a62e4145e" kindref="member">meta</ref>[FTI_Exec.<ref refid="structFTIT__execution_1a19a4f92c1d8dd2c86350f59eb7372ca8" kindref="member">ckptLvel</ref>].<ref refid="structFTIT__metadata_1aa823ffc7331029d058ef43a742309231" kindref="member">varSize</ref>[i];</highlight></codeline>
<codeline lineno="1461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1462"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1463"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="1464"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1465"><highlight class="normal"></highlight></codeline>
<codeline lineno="1466"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="1475"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1476" refid="api_8c_1a125d30b04650f470c0ca82a786e55e9d" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/><ref refid="api_8c_1a125d30b04650f470c0ca82a786e55e9d" kindref="member">FTI_Realloc</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/>ptr)</highlight></codeline>
<codeline lineno="1477"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1478"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Exec.<ref refid="structFTIT__execution_1a5ff8dd064b2a4cc4b7272abddacb8cc1" kindref="member">initSCES</ref><sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;FTI<sp/>is<sp/>not<sp/>initialized.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ptr;</highlight></codeline>
<codeline lineno="1481"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1482"><highlight class="normal"></highlight></codeline>
<codeline lineno="1483"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;Trying<sp/>to<sp/>reallocate<sp/>dataset.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a299db837571db9e73119d159b3428fe0" kindref="member">FTI_DBUG</ref>);</highlight></codeline>
<codeline lineno="1484"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Exec.<ref refid="structFTIT__execution_1a061085b1c93b22c4fafbe527e7b1f165" kindref="member">reco</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>str[<ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>];</highlight></codeline>
<codeline lineno="1486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="1487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/><ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="1488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal"><sp/>==<sp/>FTI_Data[i].</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="1489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>oldSize<sp/>=<sp/>FTI_Data[i].<ref refid="structFTIT__dataset_1a112f9319765938eba3339d86c0e140c9" kindref="member">size</ref>;</highlight></codeline>
<codeline lineno="1490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[i].<ref refid="structFTIT__dataset_1a112f9319765938eba3339d86c0e140c9" kindref="member">size</ref><sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a800c2671725989e4b600fb8a62e4145e" kindref="member">meta</ref>[FTI_Exec.<ref refid="structFTIT__execution_1a19a4f92c1d8dd2c86350f59eb7372ca8" kindref="member">ckptLvel</ref>].<ref refid="structFTIT__metadata_1aa823ffc7331029d058ef43a742309231" kindref="member">varSize</ref>[i];</highlight></codeline>
<codeline lineno="1491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sprintf(str,<sp/></highlight><highlight class="stringliteral">&quot;Reallocated<sp/>size:<sp/>%ld&quot;</highlight><highlight class="normal">,<sp/>FTI_Data[i].size);</highlight></codeline>
<codeline lineno="1492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(str,<sp/><ref refid="fti-intern_8h_1a299db837571db9e73119d159b3428fe0" kindref="member">FTI_DBUG</ref>);</highlight></codeline>
<codeline lineno="1493"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Data[i].size<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1494"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sprintf(str,<sp/></highlight><highlight class="stringliteral">&quot;Cannot<sp/>allocate<sp/>0<sp/>size.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1495"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(str,<sp/><ref refid="fti-intern_8h_1a299db837571db9e73119d159b3428fe0" kindref="member">FTI_DBUG</ref>);</highlight></codeline>
<codeline lineno="1496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ptr;</highlight></codeline>
<codeline lineno="1497"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1498"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ptr<sp/>=<sp/>realloc<sp/>(ptr,<sp/>FTI_Data[i].size);</highlight></codeline>
<codeline lineno="1499"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[i].<ref refid="structFTIT__dataset_1a36ee086d6d8ddace556bdbdbd142acbb" kindref="member">ptr</ref><sp/>=<sp/>ptr;</highlight></codeline>
<codeline lineno="1500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[i].<ref refid="structFTIT__dataset_1abc07f32e21abf951afcae67f9636e65c" kindref="member">count</ref><sp/>=<sp/>FTI_Data[i].<ref refid="structFTIT__dataset_1a112f9319765938eba3339d86c0e140c9" kindref="member">size</ref><sp/>/<sp/>FTI_Data[i].<ref refid="structFTIT__dataset_1aa0f368e577ef8f2b564d2607cdb958d1" kindref="member">eleSize</ref>;</highlight></codeline>
<codeline lineno="1501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a19693c7f3a31b31d90a40dcf7fc34183" kindref="member">ckptSize</ref><sp/>+=<sp/>FTI_Data[i].<ref refid="structFTIT__dataset_1a112f9319765938eba3339d86c0e140c9" kindref="member">size</ref><sp/>-<sp/>oldSize;</highlight></codeline>
<codeline lineno="1502"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sprintf(str,<sp/></highlight><highlight class="stringliteral">&quot;Dataset<sp/>#%d<sp/>reallocated.&quot;</highlight><highlight class="normal">,<sp/>FTI_Data[i].</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(str,<sp/><ref refid="fti-intern_8h_1a26a561f0e03eec3d15541c85a2a21ffd" kindref="member">FTI_INFO</ref>);</highlight></codeline>
<codeline lineno="1504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1506"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1507"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1508"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1509"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;This<sp/>is<sp/>not<sp/>a<sp/>recovery.<sp/>Couldn&apos;t<sp/>reallocate<sp/>memory.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1510"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1511"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ptr;</highlight></codeline>
<codeline lineno="1512"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1513"><highlight class="normal"></highlight></codeline>
<codeline lineno="1514"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="1524"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1525" refid="api_8c_1aa6acb36d29481cd0da05ee66f944c1e8" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="api_8c_1aa6acb36d29481cd0da05ee66f944c1e8" kindref="member">FTI_BitFlip</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>datasetID)</highlight></codeline>
<codeline lineno="1526"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1527"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Exec.<ref refid="structFTIT__execution_1a5ff8dd064b2a4cc4b7272abddacb8cc1" kindref="member">initSCES</ref><sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;FTI<sp/>is<sp/>not<sp/>initialized.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1530"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1531"><highlight class="normal"></highlight></codeline>
<codeline lineno="1532"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Inje.<ref refid="structFTIT__injection_1aba75a38cd410b415bfb78121f30435e7" kindref="member">rank</ref><sp/>==<sp/>FTI_Topo.<ref refid="structFTIT__topology_1a3d4083051c43d031972d83cffb242a38" kindref="member">splitRank</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1533"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(datasetID<sp/>&gt;=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1534"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1535"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Inje.<ref refid="structFTIT__injection_1ab12d3237041b7c64f040763fd8f2b399" kindref="member">counter</ref><sp/>&lt;<sp/>FTI_Inje.<ref refid="structFTIT__injection_1ab439efe2f6c7d28edd01c048801e2352" kindref="member">number</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1537"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((MPI_Wtime()<sp/>-<sp/>FTI_Inje.<ref refid="structFTIT__injection_1a95bf2ff87b433ce58c6a228b9baf164a" kindref="member">timer</ref>)<sp/>&gt;<sp/>FTI_Inje.<ref refid="structFTIT__injection_1a7a07c6bf9162ec57e49de446b1f9fb02" kindref="member">frequency</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Inje.<ref refid="structFTIT__injection_1a12000c498bf27c5e8f3872467eeeff86" kindref="member">index</ref><sp/>&lt;<sp/>FTI_Data[datasetID].<ref refid="structFTIT__dataset_1abc07f32e21abf951afcae67f9636e65c" kindref="member">count</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1539"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>str[<ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>];</highlight></codeline>
<codeline lineno="1540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Data[datasetID].type-&gt;<ref refid="structFTIT__dataset_1ac9c58324a5f443f1ea5804b530f7dab2" kindref="member">id</ref><sp/>==<sp/>9)<sp/>{<sp/></highlight><highlight class="comment">//<sp/>If<sp/>it<sp/>is<sp/>a<sp/>double</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal">*<sp/>target<sp/>=<sp/>FTI_Data[datasetID].<ref refid="structFTIT__dataset_1a36ee086d6d8ddace556bdbdbd142acbb" kindref="member">ptr</ref><sp/>+<sp/>FTI_Inje.<ref refid="structFTIT__injection_1a12000c498bf27c5e8f3872467eeeff86" kindref="member">index</ref>;</highlight></codeline>
<codeline lineno="1542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>ori<sp/>=<sp/>*target;</highlight></codeline>
<codeline lineno="1543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>res<sp/>=<sp/><ref refid="failure-injection_8c_1acd287cd3e5911bb2d8266c0d8219c861" kindref="member">FTI_DoubleBitFlip</ref>(target,<sp/>FTI_Inje.<ref refid="structFTIT__injection_1a68feabeb9e29d210543ec154ad3951e8" kindref="member">position</ref>);</highlight></codeline>
<codeline lineno="1544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Inje.<ref refid="structFTIT__injection_1ab12d3237041b7c64f040763fd8f2b399" kindref="member">counter</ref><sp/>=<sp/>(res<sp/>==<sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>)<sp/>?<sp/>FTI_Inje.<ref refid="structFTIT__injection_1ab12d3237041b7c64f040763fd8f2b399" kindref="member">counter</ref><sp/>+<sp/>1<sp/>:<sp/>FTI_Inje.<ref refid="structFTIT__injection_1ab12d3237041b7c64f040763fd8f2b399" kindref="member">counter</ref>;</highlight></codeline>
<codeline lineno="1545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Inje.<ref refid="structFTIT__injection_1a95bf2ff87b433ce58c6a228b9baf164a" kindref="member">timer</ref><sp/>=<sp/>(res<sp/>==<sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>)<sp/>?<sp/>MPI_Wtime()<sp/>:<sp/>FTI_Inje.<ref refid="structFTIT__injection_1a95bf2ff87b433ce58c6a228b9baf164a" kindref="member">timer</ref>;</highlight></codeline>
<codeline lineno="1546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sprintf(str,<sp/></highlight><highlight class="stringliteral">&quot;Injecting<sp/>bit-flip<sp/>in<sp/>dataset<sp/>%d,<sp/>index<sp/>%d,<sp/>bit<sp/>%d<sp/>:<sp/>%f<sp/>=&gt;<sp/>%f&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>datasetID,<sp/>FTI_Inje.<ref refid="structFTIT__injection_1a12000c498bf27c5e8f3872467eeeff86" kindref="member">index</ref>,<sp/>FTI_Inje.<ref refid="structFTIT__injection_1a68feabeb9e29d210543ec154ad3951e8" kindref="member">position</ref>,<sp/>ori,<sp/>*target);</highlight></codeline>
<codeline lineno="1548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(str,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>res;</highlight></codeline>
<codeline lineno="1550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Data[datasetID].type-&gt;<ref refid="structFTIT__dataset_1ac9c58324a5f443f1ea5804b530f7dab2" kindref="member">id</ref><sp/>==<sp/>8)<sp/>{<sp/></highlight><highlight class="comment">//<sp/>If<sp/>it<sp/>is<sp/>a<sp/>float</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal">*<sp/>target<sp/>=<sp/>FTI_Data[datasetID].<ref refid="structFTIT__dataset_1a36ee086d6d8ddace556bdbdbd142acbb" kindref="member">ptr</ref><sp/>+<sp/>FTI_Inje.<ref refid="structFTIT__injection_1a12000c498bf27c5e8f3872467eeeff86" kindref="member">index</ref>;</highlight></codeline>
<codeline lineno="1553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>ori<sp/>=<sp/>*target;</highlight></codeline>
<codeline lineno="1554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>res<sp/>=<sp/><ref refid="failure-injection_8c_1a791fd93b18d6c214cef5d6b934dcbd55" kindref="member">FTI_FloatBitFlip</ref>(target,<sp/>FTI_Inje.<ref refid="structFTIT__injection_1a68feabeb9e29d210543ec154ad3951e8" kindref="member">position</ref>);</highlight></codeline>
<codeline lineno="1555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Inje.<ref refid="structFTIT__injection_1ab12d3237041b7c64f040763fd8f2b399" kindref="member">counter</ref><sp/>=<sp/>(res<sp/>==<sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>)<sp/>?<sp/>FTI_Inje.<ref refid="structFTIT__injection_1ab12d3237041b7c64f040763fd8f2b399" kindref="member">counter</ref><sp/>+<sp/>1<sp/>:<sp/>FTI_Inje.<ref refid="structFTIT__injection_1ab12d3237041b7c64f040763fd8f2b399" kindref="member">counter</ref>;</highlight></codeline>
<codeline lineno="1556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Inje.<ref refid="structFTIT__injection_1a95bf2ff87b433ce58c6a228b9baf164a" kindref="member">timer</ref><sp/>=<sp/>(res<sp/>==<sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>)<sp/>?<sp/>MPI_Wtime()<sp/>:<sp/>FTI_Inje.<ref refid="structFTIT__injection_1a95bf2ff87b433ce58c6a228b9baf164a" kindref="member">timer</ref>;</highlight></codeline>
<codeline lineno="1557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sprintf(str,<sp/></highlight><highlight class="stringliteral">&quot;Injecting<sp/>bit-flip<sp/>in<sp/>dataset<sp/>%d,<sp/>index<sp/>%d,<sp/>bit<sp/>%d<sp/>:<sp/>%f<sp/>=&gt;<sp/>%f&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>datasetID,<sp/>FTI_Inje.<ref refid="structFTIT__injection_1a12000c498bf27c5e8f3872467eeeff86" kindref="member">index</ref>,<sp/>FTI_Inje.<ref refid="structFTIT__injection_1a68feabeb9e29d210543ec154ad3951e8" kindref="member">position</ref>,<sp/>ori,<sp/>*target);</highlight></codeline>
<codeline lineno="1559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(str,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>res;</highlight></codeline>
<codeline lineno="1561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1564"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1565"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1566"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1567"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1568"><highlight class="normal"></highlight></codeline>
<codeline lineno="1569"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="1582"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1583" refid="api_8c_1a85ccf559fcbee51bd335ba2c6671eadf" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="api_8c_1a85ccf559fcbee51bd335ba2c6671eadf" kindref="member">FTI_Checkpoint</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>level)</highlight></codeline>
<codeline lineno="1584"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1585"><highlight class="normal"></highlight></codeline>
<codeline lineno="1586"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>str[<ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>];<sp/></highlight><highlight class="comment">//For<sp/>console<sp/>output</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1587"><highlight class="normal"></highlight></codeline>
<codeline lineno="1588"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Exec.<ref refid="structFTIT__execution_1a5ff8dd064b2a4cc4b7272abddacb8cc1" kindref="member">initSCES</ref><sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1589"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;FTI<sp/>is<sp/>not<sp/>initialized.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1590"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1591"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1592"><highlight class="normal"></highlight></codeline>
<codeline lineno="1593"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((level<sp/>&lt;<sp/><ref refid="fti-intern_8h_1ab206d890311c7ccca78bb7220898b3e4afa5ca9b682c8e8fa119abba8fdb7958a" kindref="member">FTI_MIN_LEVEL_ID</ref>)<sp/>||<sp/>(level<sp/>&gt;<sp/><ref refid="fti-intern_8h_1ab206d890311c7ccca78bb7220898b3e4ad426aae8372aad979bfbae2273344098" kindref="member">FTI_MAX_LEVEL_ID</ref>))<sp/>{</highlight></codeline>
<codeline lineno="1594"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;Invalid<sp/>level<sp/>id!<sp/>Aborting<sp/>checkpoint<sp/>creation...&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1595"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1596"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1597"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((level<sp/>&gt;<sp/><ref refid="fti-intern_8h_1ab206d890311c7ccca78bb7220898b3e4a044a75c265db7e345d4956e38e6995ea" kindref="member">FTI_L4</ref>)<sp/>&amp;&amp;<sp/>(level<sp/>&lt;<sp/><ref refid="fti-intern_8h_1ab206d890311c7ccca78bb7220898b3e4a3de1f9de3351ddb6abef7e1dbe78a09b" kindref="member">FTI_L4_DCP</ref>))<sp/>{</highlight></codeline>
<codeline lineno="1598"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>snprintf(<sp/>str,<sp/><ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;dCP<sp/>only<sp/>implemented<sp/>for<sp/>level<sp/>4!<sp/>setting<sp/>to<sp/>level<sp/>%d...&quot;</highlight><highlight class="normal">,<sp/>level<sp/>-<sp/>4<sp/>);</highlight></codeline>
<codeline lineno="1599"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(str,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1600"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>level<sp/>-=<sp/>4;<sp/></highlight></codeline>
<codeline lineno="1601"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1602"><highlight class="normal"></highlight></codeline>
<codeline lineno="1603"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>t1,<sp/>t2;</highlight></codeline>
<codeline lineno="1604"><highlight class="normal"></highlight></codeline>
<codeline lineno="1605"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1afe4ababcb4c2ea0a21a87b237f8d7a00" kindref="member">ckptID</ref><sp/>=<sp/>id;</highlight></codeline>
<codeline lineno="1606"><highlight class="normal"></highlight></codeline>
<codeline lineno="1607"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>reset<sp/>hdf5<sp/>single<sp/>file<sp/>requests.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1608"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a18192d9c04546cfdbb41d3472be77946" kindref="member">h5SingleFile</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1609"><highlight class="normal"></highlight></codeline>
<codeline lineno="1610"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>reset<sp/>dcp<sp/>requests.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1611"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Ckpt[4].<ref refid="structFTIT__checkpoint_1a2e5377d7aa3c3342b6d633bb1f3afb70" kindref="member">isDcp</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1612"><highlight class="normal"></highlight></codeline>
<codeline lineno="1613"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>level<sp/>==<sp/><ref refid="fti-intern_8h_1ab206d890311c7ccca78bb7220898b3e4a3de1f9de3351ddb6abef7e1dbe78a09b" kindref="member">FTI_L4_DCP</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1614"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>(FTI_Conf.<ref refid="structFTIT__configuration_1a5853fc734fbdc50680125595e6cc4f74" kindref="member">ioMode</ref><sp/>==<sp/><ref refid="fti-intern_8h_1a2b6ae4a8dc77345c8aa9497f8cb9291b" kindref="member">FTI_IO_FTIFF</ref>)<sp/>||<sp/>(FTI_Conf.<ref refid="structFTIT__configuration_1a5853fc734fbdc50680125595e6cc4f74" kindref="member">ioMode</ref><sp/>==<sp/><ref refid="fti-intern_8h_1ab4185f9b1ad1804d6d89182627205923" kindref="member">FTI_IO_POSIX</ref>)<sp/><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1615"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>FTI_Conf.<ref refid="structFTIT__configuration_1aae6a605160c14bd0f0174d9aa94b4183" kindref="member">dcpFtiff</ref><sp/>||<sp/>FTI_Conf.<ref refid="structFTIT__configuration_1a5e319b258138bbb03d5da9917f99acd6" kindref="member">dcpPosix</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1616"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Ckpt[4].<ref refid="structFTIT__checkpoint_1a2e5377d7aa3c3342b6d633bb1f3afb70" kindref="member">isDcp</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1617"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1618"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;L4<sp/>dCP<sp/>requested,<sp/>but<sp/>dCP<sp/>is<sp/>disabled!&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1619"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1620"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;L4<sp/>dCP<sp/>requested,<sp/>but<sp/>dCP<sp/>needs<sp/>FTI-FF!&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1622"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1623"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>level<sp/>=<sp/>4;</highlight></codeline>
<codeline lineno="1624"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1625"><highlight class="normal"></highlight></codeline>
<codeline lineno="1626"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>t0<sp/>=<sp/>MPI_Wtime();<sp/></highlight><highlight class="comment">//Start<sp/>time</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1627"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Exec.<ref refid="structFTIT__execution_1a5f9c804789b75f8a3cab11fb1685c106" kindref="member">wasLastOffline</ref><sp/>==<sp/>1)<sp/>{<sp/></highlight><highlight class="comment">//<sp/>Block<sp/>until<sp/>previous<sp/>checkpoint<sp/>is<sp/>done<sp/>(Async.<sp/>work)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1628"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>lastLevel;</highlight></codeline>
<codeline lineno="1629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MPI_Recv(&amp;lastLevel,<sp/>1,<sp/>MPI_INT,<sp/>FTI_Topo.<ref refid="structFTIT__topology_1ad6b000c681a3230febbc5829c6ad9247" kindref="member">headRank</ref>,<sp/>FTI_Conf.<ref refid="structFTIT__configuration_1ae11893be3341d992d9722a21c00eddd4" kindref="member">generalTag</ref>,<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a9cbca3e2e49bb808bc73569db3fdecb2" kindref="member">globalComm</ref>,<sp/>MPI_STATUS_IGNORE);</highlight></codeline>
<codeline lineno="1630"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(lastLevel<sp/>!=<sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>)<sp/>{<sp/></highlight><highlight class="comment">//Head<sp/>sends<sp/>level<sp/>of<sp/>checkpoint<sp/>if<sp/>post-processing<sp/>succeed,<sp/>FTI_NSCS<sp/>Otherwise</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a92ac9b3e26177d2e59ecfc83a4e460b9" kindref="member">lastCkptLvel</ref><sp/>=<sp/>lastLevel;<sp/></highlight><highlight class="comment">//Store<sp/>last<sp/>successful<sp/>post-processing<sp/>checkpoint<sp/>level</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sprintf(str,<sp/></highlight><highlight class="stringliteral">&quot;LastCkptLvel<sp/>received<sp/>from<sp/>head:<sp/>%d&quot;</highlight><highlight class="normal">,<sp/>lastLevel);</highlight></codeline>
<codeline lineno="1633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(str,<sp/><ref refid="fti-intern_8h_1a299db837571db9e73119d159b3428fe0" kindref="member">FTI_DBUG</ref>);</highlight></codeline>
<codeline lineno="1634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;Head<sp/>failed<sp/>to<sp/>do<sp/>post-processing<sp/>after<sp/>previous<sp/>checkpoint.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1637"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1638"><highlight class="normal"></highlight></codeline>
<codeline lineno="1639"><highlight class="normal"><sp/><sp/><sp/><sp/>t1<sp/>=<sp/>MPI_Wtime();<sp/></highlight><highlight class="comment">//Time<sp/>after<sp/>waiting<sp/>for<sp/>head<sp/>to<sp/>done<sp/>previous<sp/>post-processing</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1640"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a19a4f92c1d8dd2c86350f59eb7372ca8" kindref="member">ckptLvel</ref><sp/>=<sp/>level;<sp/></highlight><highlight class="comment">//For<sp/>FTI_WriteCkpt</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1641"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>res<sp/>=<sp/><ref refid="tools_8c_1a950803008f7cef4892fbba9b2069928e" kindref="member">FTI_Try</ref>(<ref refid="checkpoint_8c_1a656858362954a335040262a54a0235ce" kindref="member">FTI_WriteCkpt</ref>(&amp;FTI_Conf,<sp/>&amp;FTI_Exec,<sp/>&amp;FTI_Topo,<sp/>FTI_Ckpt,<sp/>FTI_Data),<sp/></highlight><highlight class="stringliteral">&quot;write<sp/>the<sp/>checkpoint.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1642"><highlight class="normal"><sp/><sp/><sp/><sp/>t2<sp/>=<sp/>MPI_Wtime();<sp/></highlight><highlight class="comment">//Time<sp/>after<sp/>writing<sp/>checkpoint</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1643"><highlight class="normal"></highlight></codeline>
<codeline lineno="1644"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>no<sp/>postprocessing<sp/>or<sp/>meta<sp/>data<sp/>for<sp/>h5<sp/>single<sp/>file</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1645"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>res<sp/>==<sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref><sp/>&amp;&amp;<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a18192d9c04546cfdbb41d3472be77946" kindref="member">h5SingleFile</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>str[<ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>];</highlight></codeline>
<codeline lineno="1647"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sprintf(<sp/>str,<sp/></highlight><highlight class="stringliteral">&quot;Ckpt.<sp/>ID<sp/>%d<sp/>(Variate<sp/>Processor<sp/>Recovery<sp/>File)<sp/>(%.2f<sp/>MB/proc)<sp/>taken<sp/>in<sp/>%.2f<sp/>sec.&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1afe4ababcb4c2ea0a21a87b237f8d7a00" kindref="member">ckptID</ref>,<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a19693c7f3a31b31d90a40dcf7fc34183" kindref="member">ckptSize</ref><sp/>/<sp/>(1024.0<sp/>*<sp/>1024.0),<sp/>t2<sp/>-<sp/>t1<sp/>);</highlight></codeline>
<codeline lineno="1649"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(str,<sp/><ref refid="fti-intern_8h_1a26a561f0e03eec3d15541c85a2a21ffd" kindref="member">FTI_INFO</ref>);</highlight></codeline>
<codeline lineno="1650"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="1651"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1652"><highlight class="normal"></highlight></codeline>
<codeline lineno="1653"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!FTI_Ckpt[FTI_Exec.<ref refid="structFTIT__execution_1a19a4f92c1d8dd2c86350f59eb7372ca8" kindref="member">ckptLvel</ref>].<ref refid="structFTIT__checkpoint_1a3759ecf0747658a49b8d4e1715092b12" kindref="member">isInline</ref>)<sp/>{<sp/></highlight><highlight class="comment">//<sp/>If<sp/>postCkpt.<sp/>work<sp/>is<sp/>Async.<sp/>then<sp/>send<sp/>message</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1654"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a5dba7e9abb06346b040c3e74370f879f" kindref="member">activateHeads</ref>(<sp/>&amp;FTI_Conf,<sp/>&amp;FTI_Exec,<sp/>&amp;FTI_Topo,<sp/>FTI_Ckpt,<sp/>res<sp/>);</highlight></codeline>
<codeline lineno="1655"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1656"><highlight class="normal"></highlight></codeline>
<codeline lineno="1657"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/></highlight><highlight class="comment">//If<sp/>post-processing<sp/>is<sp/>inline</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a5f9c804789b75f8a3cab11fb1685c106" kindref="member">wasLastOffline</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>!=<sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>)<sp/>{<sp/></highlight><highlight class="comment">//If<sp/>Writing<sp/>checkpoint<sp/>failed</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1660"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a19a4f92c1d8dd2c86350f59eb7372ca8" kindref="member">ckptLvel</ref><sp/>=<sp/><ref refid="fti-intern_8h_1aeb28ad968c769903d39cec8d41690f3c" kindref="member">FTI_REJW</ref><sp/>-<sp/><ref refid="fti-intern_8h_1a8072c73e48c25b82d8a0dc35794586c3" kindref="member">FTI_BASE</ref>;<sp/></highlight><highlight class="comment">//The<sp/>same<sp/>as<sp/>head<sp/>call<sp/>FTI_PostCkpt<sp/>with<sp/>reject<sp/>ckptLvel<sp/>if<sp/>not<sp/>success</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1661"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1662"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="tools_8c_1a950803008f7cef4892fbba9b2069928e" kindref="member">FTI_Try</ref>(<ref refid="checkpoint_8c_1a304411ac19756871bac1eec1517bc57b" kindref="member">FTI_PostCkpt</ref>(&amp;FTI_Conf,<sp/>&amp;FTI_Exec,<sp/>&amp;FTI_Topo,<sp/>FTI_Ckpt),<sp/></highlight><highlight class="stringliteral">&quot;postprocess<sp/>the<sp/>checkpoint.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1663"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>)<sp/>{<sp/></highlight><highlight class="comment">//If<sp/>post-processing<sp/>succeed</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1664"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a92ac9b3e26177d2e59ecfc83a4e460b9" kindref="member">lastCkptLvel</ref><sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a19a4f92c1d8dd2c86350f59eb7372ca8" kindref="member">ckptLvel</ref>;<sp/></highlight><highlight class="comment">//Store<sp/>last<sp/>successful<sp/>post-processing<sp/>checkpoint<sp/>level</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1665"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1666"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1667"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>t3;</highlight></codeline>
<codeline lineno="1668"><highlight class="normal"></highlight></codeline>
<codeline lineno="1669"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>!FTI_Exec.<ref refid="structFTIT__execution_1a6b8b6b1922b2561d237b1097a2ea14ef" kindref="member">hasCkpt</ref><sp/>&amp;&amp;<sp/>(FTI_Topo.<ref refid="structFTIT__topology_1a3d4083051c43d031972d83cffb242a38" kindref="member">splitRank</ref><sp/>==<sp/>0)<sp/>&amp;&amp;<sp/>(res<sp/>==<sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>)<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1670"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Setting<sp/>recover<sp/>flag<sp/>to<sp/>1<sp/>(to<sp/>recover<sp/>from<sp/>current<sp/>ckpt<sp/>level)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1671"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="tools_8c_1a950803008f7cef4892fbba9b2069928e" kindref="member">FTI_Try</ref>(<ref refid="conf_8c_1a072119e00ecaef96e6b516174beb0321" kindref="member">FTI_UpdateConf</ref>(&amp;FTI_Conf,<sp/>&amp;FTI_Exec,<sp/>1),<sp/></highlight><highlight class="stringliteral">&quot;update<sp/>configuration<sp/>file.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1672"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a5ff8dd064b2a4cc4b7272abddacb8cc1" kindref="member">initSCES</ref><sp/>=<sp/>1;<sp/></highlight><highlight class="comment">//in<sp/>case<sp/>FTI<sp/>couldn&apos;t<sp/>recover<sp/>all<sp/>ckpt<sp/>files<sp/>in<sp/>FTI_Init</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1673"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>res<sp/>==<sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1674"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a6b8b6b1922b2561d237b1097a2ea14ef" kindref="member">hasCkpt</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1675"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1676"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1677"><highlight class="normal"></highlight></codeline>
<codeline lineno="1678"><highlight class="normal"><sp/><sp/><sp/><sp/>MPI_Bcast(<sp/>&amp;FTI_Exec.<ref refid="structFTIT__execution_1a6b8b6b1922b2561d237b1097a2ea14ef" kindref="member">hasCkpt</ref>,<sp/>1,<sp/>MPI_INT,<sp/>0,<sp/><ref refid="api_8c_1a7deaa5171fbf22fe59ae1c08f2bdcc97" kindref="member">FTI_COMM_WORLD</ref><sp/>);</highlight></codeline>
<codeline lineno="1679"><highlight class="normal"></highlight></codeline>
<codeline lineno="1680"><highlight class="normal"><sp/><sp/><sp/><sp/>t3<sp/>=<sp/>MPI_Wtime();<sp/></highlight><highlight class="comment">//Time<sp/>after<sp/>post-processing</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1681"><highlight class="normal"></highlight></codeline>
<codeline lineno="1682"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>!=<sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1683"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sprintf(str,<sp/></highlight><highlight class="stringliteral">&quot;Checkpoint<sp/>with<sp/>ID<sp/>%d<sp/>at<sp/>Level<sp/>%d<sp/>failed.&quot;</highlight><highlight class="normal">,<sp/>FTI_Exec.<ref refid="structFTIT__execution_1afe4ababcb4c2ea0a21a87b237f8d7a00" kindref="member">ckptID</ref>,<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a19a4f92c1d8dd2c86350f59eb7372ca8" kindref="member">ckptLvel</ref>);</highlight></codeline>
<codeline lineno="1684"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(str,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1686"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1687"><highlight class="normal"></highlight></codeline>
<codeline lineno="1688"><highlight class="normal"><sp/><sp/><sp/><sp/>sprintf(str,<sp/></highlight><highlight class="stringliteral">&quot;Ckpt.<sp/>ID<sp/>%d<sp/>(L%d)<sp/>(%.2f<sp/>MB/proc)<sp/>taken<sp/>in<sp/>%.2f<sp/>sec.<sp/>(Wt:%.2fs,<sp/>Wr:%.2fs,<sp/>Ps:%.2fs)&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1689"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1afe4ababcb4c2ea0a21a87b237f8d7a00" kindref="member">ckptID</ref>,<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a19a4f92c1d8dd2c86350f59eb7372ca8" kindref="member">ckptLvel</ref>,<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a19693c7f3a31b31d90a40dcf7fc34183" kindref="member">ckptSize</ref><sp/>/<sp/>(1024.0<sp/>*<sp/>1024.0),<sp/>t3<sp/>-<sp/>t0,<sp/>t1<sp/>-<sp/>t0,<sp/>t2<sp/>-<sp/>t1,<sp/>t3<sp/>-<sp/>t2);</highlight></codeline>
<codeline lineno="1690"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(str,<sp/><ref refid="fti-intern_8h_1a26a561f0e03eec3d15541c85a2a21ffd" kindref="member">FTI_INFO</ref>);</highlight></codeline>
<codeline lineno="1691"><highlight class="normal"></highlight></codeline>
<codeline lineno="1692"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>(FTI_Conf.<ref refid="structFTIT__configuration_1aae6a605160c14bd0f0174d9aa94b4183" kindref="member">dcpFtiff</ref><sp/>||<sp/>FTI_Conf.<ref refid="structFTIT__configuration_1a5e319b258138bbb03d5da9917f99acd6" kindref="member">dcpPosix</ref>)<sp/>&amp;&amp;<sp/>FTI_Ckpt[4].<ref refid="structFTIT__checkpoint_1a2e5377d7aa3c3342b6d633bb1f3afb70" kindref="member">isDcp</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dcp_8c_1a794fe50f7bf99fcbd9e5b55d62c81f9d" kindref="member">FTI_PrintDcpStats</ref>(<sp/>FTI_Conf,<sp/>FTI_Exec,<sp/>FTI_Topo<sp/>);<sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1694"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1695"><highlight class="normal"></highlight></codeline>
<codeline lineno="1696"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a7dee5a1994faa8e4a2664942d4d8c024" kindref="member">FTI_DONE</ref>;</highlight></codeline>
<codeline lineno="1697"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1698"><highlight class="normal"></highlight></codeline>
<codeline lineno="1699"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="1717"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1718" refid="api_8c_1a7cd136cac151e0a71320ff3f80215e25" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="api_8c_1a7cd136cac151e0a71320ff3f80215e25" kindref="member">FTI_InitICP</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>level,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>activate)</highlight></codeline>
<codeline lineno="1719"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1720"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Exec.<ref refid="structFTIT__execution_1a5ff8dd064b2a4cc4b7272abddacb8cc1" kindref="member">initSCES</ref><sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1721"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;FTI<sp/>is<sp/>not<sp/>initialized.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1722"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1723"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1724"><highlight class="normal"></highlight></codeline>
<codeline lineno="1725"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>only<sp/>step<sp/>in<sp/>if<sp/>activate<sp/>TRUE.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1726"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>!activate<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1727"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="1728"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1729"><highlight class="normal"></highlight></codeline>
<codeline lineno="1730"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>reset<sp/>hdf5<sp/>single<sp/>file<sp/>requests.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1731"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a18192d9c04546cfdbb41d3472be77946" kindref="member">h5SingleFile</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1732"><highlight class="normal"></highlight></codeline>
<codeline lineno="1733"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>reset<sp/>iCP<sp/>meta<sp/>info<sp/>(i.e.<sp/>set<sp/>counter<sp/>to<sp/>zero<sp/>etc.)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1734"><highlight class="normal"><sp/><sp/><sp/><sp/>memset(<sp/>&amp;(FTI_Exec.<ref refid="structFTIT__execution_1a60384be16093e9c57bed8078cc5b7b2b" kindref="member">iCPInfo</ref>),<sp/>0x0,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structFTIT__iCPInfo" kindref="compound">FTIT_iCPInfo</ref>)<sp/>);</highlight></codeline>
<codeline lineno="1735"><highlight class="normal"></highlight></codeline>
<codeline lineno="1736"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>init<sp/>iCP<sp/>status<sp/>with<sp/>failure</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1737"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a60384be16093e9c57bed8078cc5b7b2b" kindref="member">iCPInfo</ref>.<ref refid="structFTIT__iCPInfo_1afc19d9ee59e21138eac3643795ebb505" kindref="member">status</ref><sp/>=<sp/><ref refid="icp_8h_1a2dbc8d3165bda9759e43d8b5943942b3" kindref="member">FTI_ICP_FAIL</ref>;</highlight></codeline>
<codeline lineno="1738"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a60384be16093e9c57bed8078cc5b7b2b" kindref="member">iCPInfo</ref>.<ref refid="structFTIT__iCPInfo_1a512d31bfccfb8c286b88c2dd54a68733" kindref="member">result</ref><sp/>=<sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1739"><highlight class="normal"></highlight></codeline>
<codeline lineno="1740"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>res<sp/>=<sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1741"><highlight class="normal"></highlight></codeline>
<codeline lineno="1742"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>str[<ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>];<sp/></highlight><highlight class="comment">//For<sp/>console<sp/>output</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1743"><highlight class="normal"></highlight></codeline>
<codeline lineno="1744"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Exec.<ref refid="structFTIT__execution_1a5ff8dd064b2a4cc4b7272abddacb8cc1" kindref="member">initSCES</ref><sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1745"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;FTI<sp/>is<sp/>not<sp/>initialized.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1747"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1748"><highlight class="normal"></highlight></codeline>
<codeline lineno="1749"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((level<sp/>&lt;<sp/><ref refid="fti-intern_8h_1ab206d890311c7ccca78bb7220898b3e4afa5ca9b682c8e8fa119abba8fdb7958a" kindref="member">FTI_MIN_LEVEL_ID</ref>)<sp/>||<sp/>(level<sp/>&gt;<sp/><ref refid="fti-intern_8h_1ab206d890311c7ccca78bb7220898b3e4ad426aae8372aad979bfbae2273344098" kindref="member">FTI_MAX_LEVEL_ID</ref>))<sp/>{</highlight></codeline>
<codeline lineno="1750"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;Invalid<sp/>level<sp/>id!<sp/>Aborting<sp/>checkpoint<sp/>creation...&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1751"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1752"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1753"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((level<sp/>&gt;<sp/><ref refid="fti-intern_8h_1ab206d890311c7ccca78bb7220898b3e4a044a75c265db7e345d4956e38e6995ea" kindref="member">FTI_L4</ref>)<sp/>&amp;&amp;<sp/>(level<sp/>&lt;<sp/><ref refid="fti-intern_8h_1ab206d890311c7ccca78bb7220898b3e4a3de1f9de3351ddb6abef7e1dbe78a09b" kindref="member">FTI_L4_DCP</ref>))<sp/>{</highlight></codeline>
<codeline lineno="1754"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>snprintf(<sp/>str,<sp/><ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;dCP<sp/>only<sp/>implemented<sp/>for<sp/>level<sp/>4!<sp/>setting<sp/>to<sp/>level<sp/>%d...&quot;</highlight><highlight class="normal">,<sp/>level<sp/>-<sp/>4<sp/>);</highlight></codeline>
<codeline lineno="1755"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(str,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1756"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>level<sp/>-=<sp/>4;<sp/></highlight></codeline>
<codeline lineno="1757"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1758"><highlight class="normal"></highlight></codeline>
<codeline lineno="1759"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a60384be16093e9c57bed8078cc5b7b2b" kindref="member">iCPInfo</ref>.<ref refid="structFTIT__iCPInfo_1afe3db06d76fa7808ebe81a70f54c132e" kindref="member">lastCkptID</ref><sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1afe4ababcb4c2ea0a21a87b237f8d7a00" kindref="member">ckptID</ref>;</highlight></codeline>
<codeline lineno="1760"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a60384be16093e9c57bed8078cc5b7b2b" kindref="member">iCPInfo</ref>.<ref refid="structFTIT__iCPInfo_1a50a98f63da5b018f47119597bbb6b748" kindref="member">isFirstCp</ref><sp/>=<sp/>!FTI_Exec.<ref refid="structFTIT__execution_1afe4ababcb4c2ea0a21a87b237f8d7a00" kindref="member">ckptID</ref>;<sp/></highlight><highlight class="comment">//ckptID<sp/>=<sp/>0<sp/>if<sp/>first<sp/>checkpoint</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1761"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1afe4ababcb4c2ea0a21a87b237f8d7a00" kindref="member">ckptID</ref><sp/>=<sp/>id;</highlight></codeline>
<codeline lineno="1762"><highlight class="normal"></highlight></codeline>
<codeline lineno="1763"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>reset<sp/>dcp<sp/>requests.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1764"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Ckpt[4].<ref refid="structFTIT__checkpoint_1a2e5377d7aa3c3342b6d633bb1f3afb70" kindref="member">isDcp</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1765"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>level<sp/>==<sp/><ref refid="fti-intern_8h_1ab206d890311c7ccca78bb7220898b3e4a3de1f9de3351ddb6abef7e1dbe78a09b" kindref="member">FTI_L4_DCP</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1766"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>(FTI_Conf.<ref refid="structFTIT__configuration_1a5853fc734fbdc50680125595e6cc4f74" kindref="member">ioMode</ref><sp/>==<sp/><ref refid="fti-intern_8h_1a2b6ae4a8dc77345c8aa9497f8cb9291b" kindref="member">FTI_IO_FTIFF</ref>)<sp/>||<sp/>(FTI_Conf.<ref refid="structFTIT__configuration_1a5853fc734fbdc50680125595e6cc4f74" kindref="member">ioMode</ref><sp/>==<sp/><ref refid="fti-intern_8h_1ab4185f9b1ad1804d6d89182627205923" kindref="member">FTI_IO_POSIX</ref>)<sp/><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1767"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>FTI_Conf.<ref refid="structFTIT__configuration_1aae6a605160c14bd0f0174d9aa94b4183" kindref="member">dcpFtiff</ref><sp/>||<sp/>FTI_Conf.<ref refid="structFTIT__configuration_1a5e319b258138bbb03d5da9917f99acd6" kindref="member">dcpPosix</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1768"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Ckpt[4].<ref refid="structFTIT__checkpoint_1a2e5377d7aa3c3342b6d633bb1f3afb70" kindref="member">isDcp</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1769"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1770"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;L4<sp/>dCP<sp/>requested,<sp/>but<sp/>dCP<sp/>is<sp/>disabled!&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1771"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1772"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1773"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;L4<sp/>dCP<sp/>requested,<sp/>but<sp/>dCP<sp/>needs<sp/>FTI-FF!&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1774"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1775"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>level<sp/>=<sp/>4;</highlight></codeline>
<codeline lineno="1776"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1777"><highlight class="normal"></highlight></codeline>
<codeline lineno="1778"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a60384be16093e9c57bed8078cc5b7b2b" kindref="member">iCPInfo</ref>.<ref refid="structFTIT__iCPInfo_1a447bef7931d6159561c1697a9e69299e" kindref="member">t0</ref><sp/>=<sp/>MPI_Wtime();<sp/></highlight><highlight class="comment">//Start<sp/>time</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1779"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Exec.<ref refid="structFTIT__execution_1a5f9c804789b75f8a3cab11fb1685c106" kindref="member">wasLastOffline</ref><sp/>==<sp/>1)<sp/>{<sp/></highlight><highlight class="comment">//<sp/>Block<sp/>until<sp/>previous<sp/>checkpoint<sp/>is<sp/>done<sp/>(Async.<sp/>work)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1780"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>lastLevel;</highlight></codeline>
<codeline lineno="1781"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MPI_Recv(&amp;lastLevel,<sp/>1,<sp/>MPI_INT,<sp/>FTI_Topo.<ref refid="structFTIT__topology_1ad6b000c681a3230febbc5829c6ad9247" kindref="member">headRank</ref>,<sp/>FTI_Conf.<ref refid="structFTIT__configuration_1ae11893be3341d992d9722a21c00eddd4" kindref="member">generalTag</ref>,<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a9cbca3e2e49bb808bc73569db3fdecb2" kindref="member">globalComm</ref>,<sp/>MPI_STATUS_IGNORE);</highlight></codeline>
<codeline lineno="1782"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(lastLevel<sp/>!=<sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>)<sp/>{<sp/></highlight><highlight class="comment">//Head<sp/>sends<sp/>level<sp/>of<sp/>checkpoint<sp/>if<sp/>post-processing<sp/>succeed,<sp/>FTI_NSCS<sp/>Otherwise</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1783"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a92ac9b3e26177d2e59ecfc83a4e460b9" kindref="member">lastCkptLvel</ref><sp/>=<sp/>lastLevel;<sp/></highlight><highlight class="comment">//Store<sp/>last<sp/>successful<sp/>post-processing<sp/>checkpoint<sp/>level</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1784"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sprintf(str,<sp/></highlight><highlight class="stringliteral">&quot;LastCkptLvel<sp/>received<sp/>from<sp/>head:<sp/>%d&quot;</highlight><highlight class="normal">,<sp/>lastLevel);</highlight></codeline>
<codeline lineno="1785"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(str,<sp/><ref refid="fti-intern_8h_1a299db837571db9e73119d159b3428fe0" kindref="member">FTI_DBUG</ref>);</highlight></codeline>
<codeline lineno="1786"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1787"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;Head<sp/>failed<sp/>to<sp/>do<sp/>post-processing<sp/>after<sp/>previous<sp/>checkpoint.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1788"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1789"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1790"><highlight class="normal"></highlight></codeline>
<codeline lineno="1791"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a60384be16093e9c57bed8078cc5b7b2b" kindref="member">iCPInfo</ref>.<ref refid="structFTIT__iCPInfo_1a2fb00d9b13849a7bf898de5c42b56155" kindref="member">t1</ref><sp/>=<sp/>MPI_Wtime();<sp/></highlight><highlight class="comment">//Time<sp/>after<sp/>waiting<sp/>for<sp/>head<sp/>to<sp/>done<sp/>previous<sp/>post-processing</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1792"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a19a4f92c1d8dd2c86350f59eb7372ca8" kindref="member">ckptLvel</ref><sp/>=<sp/>level;<sp/></highlight><highlight class="comment">//For<sp/>FTI_WriteCkpt</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1793"><highlight class="normal"></highlight></codeline>
<codeline lineno="1794"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Name<sp/>of<sp/>the<sp/><sp/>CKPT<sp/>file.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1795"><highlight class="normal"><sp/><sp/><sp/><sp/>snprintf(FTI_Exec.<ref refid="structFTIT__execution_1a800c2671725989e4b600fb8a62e4145e" kindref="member">meta</ref>[0].<ref refid="structFTIT__metadata_1af649446726d9d2147f208dee79a75a75" kindref="member">ckptFile</ref>,<sp/><ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Ckpt%d-Rank%d.%s&quot;</highlight><highlight class="normal">,<sp/>FTI_Exec.<ref refid="structFTIT__execution_1afe4ababcb4c2ea0a21a87b237f8d7a00" kindref="member">ckptID</ref>,<sp/>FTI_Topo.<ref refid="structFTIT__topology_1afd9e834e60e98abbce232192a38a7d58" kindref="member">myRank</ref>,FTI_Conf.<ref refid="structFTIT__configuration_1a0894284fb39ed4715b9841771717c8c3" kindref="member">suffix</ref>);</highlight></codeline>
<codeline lineno="1796"><highlight class="normal"></highlight></codeline>
<codeline lineno="1797"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//If<sp/>checkpoint<sp/>is<sp/>inlin<sp/>and<sp/>level<sp/>4<sp/>save<sp/>directly<sp/>to<sp/>PFS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1798"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>offset<sp/>=<sp/>2*(FTI_Conf.<ref refid="structFTIT__configuration_1a5e319b258138bbb03d5da9917f99acd6" kindref="member">dcpPosix</ref>);</highlight></codeline>
<codeline lineno="1799"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Ckpt[4].isInline<sp/>&amp;&amp;<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a19a4f92c1d8dd2c86350f59eb7372ca8" kindref="member">ckptLvel</ref><sp/>==<sp/>4)<sp/>{</highlight></codeline>
<codeline lineno="1800"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>!((FTI_Conf.<ref refid="structFTIT__configuration_1aae6a605160c14bd0f0174d9aa94b4183" kindref="member">dcpFtiff</ref><sp/>||<sp/>FTI_Conf.<ref refid="structFTIT__configuration_1a5e319b258138bbb03d5da9917f99acd6" kindref="member">dcpPosix</ref>)<sp/>&amp;&amp;<sp/>FTI_Ckpt[4].<ref refid="structFTIT__checkpoint_1a2e5377d7aa3c3342b6d633bb1f3afb70" kindref="member">isDcp</ref>)<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1801"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="macros_8h_1a2bf44344e285663ad0b0b7bb001ac4fd" kindref="member">MKDIR</ref>(FTI_Conf.<ref refid="structFTIT__configuration_1ab5c4f469d7c85ea0efe36f891be796fa" kindref="member">gTmpDir</ref>,0777);<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1802"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>!FTI_Ckpt[4].hasDcp<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1803"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="macros_8h_1a2bf44344e285663ad0b0b7bb001ac4fd" kindref="member">MKDIR</ref>(FTI_Ckpt[4].dcpDir,0777);</highlight></codeline>
<codeline lineno="1804"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1805"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1aae9a4203fa8dc35b854360b02ba315f5" kindref="member">initICPFunc</ref>[<ref refid="fti-intern_8h_1a3de33738fd3c7e77bffbcfaefc3e7645" kindref="member">GLOBAL</ref>](&amp;FTI_Conf,<sp/>&amp;FTI_Exec,<sp/>&amp;FTI_Topo,<sp/>FTI_Ckpt,<sp/>FTI_Data,&amp;<ref refid="fti-io_8c_1a28a33d94e22f56316d3cc558fbc22ea2" kindref="member">ftiIO</ref>[<ref refid="fti-intern_8h_1a3de33738fd3c7e77bffbcfaefc3e7645" kindref="member">GLOBAL</ref>+offset]);</highlight></codeline>
<codeline lineno="1806"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1807"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1808"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>!((FTI_Conf.<ref refid="structFTIT__configuration_1aae6a605160c14bd0f0174d9aa94b4183" kindref="member">dcpFtiff</ref><sp/>||<sp/>FTI_Conf.<ref refid="structFTIT__configuration_1a5e319b258138bbb03d5da9917f99acd6" kindref="member">dcpPosix</ref>)<sp/>&amp;&amp;<sp/>FTI_Ckpt[4].<ref refid="structFTIT__checkpoint_1a2e5377d7aa3c3342b6d633bb1f3afb70" kindref="member">isDcp</ref>)<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1809"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="macros_8h_1a2bf44344e285663ad0b0b7bb001ac4fd" kindref="member">MKDIR</ref>(FTI_Conf.<ref refid="structFTIT__configuration_1a06bfe0fcd4a7ad1e247e1b3d235bfe01" kindref="member">lTmpDir</ref>,0777);</highlight></codeline>
<codeline lineno="1810"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>!FTI_Ckpt[4].hasDcp<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1811"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="macros_8h_1a2bf44344e285663ad0b0b7bb001ac4fd" kindref="member">MKDIR</ref>(FTI_Ckpt[1].dcpDir,0777);</highlight></codeline>
<codeline lineno="1812"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1813"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1aae9a4203fa8dc35b854360b02ba315f5" kindref="member">initICPFunc</ref>[<ref refid="fti-intern_8h_1a3758dd5d300a594312c95bc393378df0" kindref="member">LOCAL</ref>](&amp;FTI_Conf,<sp/>&amp;FTI_Exec,<sp/>&amp;FTI_Topo,<sp/>FTI_Ckpt,<sp/>FTI_Data,&amp;<ref refid="fti-io_8c_1a28a33d94e22f56316d3cc558fbc22ea2" kindref="member">ftiIO</ref>[<ref refid="fti-intern_8h_1a3758dd5d300a594312c95bc393378df0" kindref="member">LOCAL</ref>+offset]);</highlight></codeline>
<codeline lineno="1814"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1815"><highlight class="normal"></highlight></codeline>
<codeline lineno="1816"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>res<sp/>==<sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref><sp/>)<sp/></highlight></codeline>
<codeline lineno="1817"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a60384be16093e9c57bed8078cc5b7b2b" kindref="member">iCPInfo</ref>.<ref refid="structFTIT__iCPInfo_1afc19d9ee59e21138eac3643795ebb505" kindref="member">status</ref><sp/>=<sp/><ref refid="icp_8h_1af6dc810ae941e1db4b3c67ad45b3fced" kindref="member">FTI_ICP_ACTV</ref>;</highlight></codeline>
<codeline lineno="1818"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="1819"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;Could<sp/>Not<sp/>initialize<sp/>ICP&quot;</highlight><highlight class="normal">,<ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1820"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1821"><highlight class="normal"></highlight></codeline>
<codeline lineno="1822"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>res;</highlight></codeline>
<codeline lineno="1823"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1824"><highlight class="normal"></highlight></codeline>
<codeline lineno="1825"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="1836"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1837" refid="api_8c_1a8eb9b278fa5aa30e53ca4ad8baf95ba1" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="api_8c_1a8eb9b278fa5aa30e53ca4ad8baf95ba1" kindref="member">FTI_AddVarICP</ref>(<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>varID<sp/>)<sp/></highlight></codeline>
<codeline lineno="1838"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1839"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Exec.<ref refid="structFTIT__execution_1a5ff8dd064b2a4cc4b7272abddacb8cc1" kindref="member">initSCES</ref><sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1840"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;FTI<sp/>is<sp/>not<sp/>initialized.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1841"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1842"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1843"><highlight class="normal"></highlight></codeline>
<codeline lineno="1844"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>only<sp/>step<sp/>in<sp/>if<sp/>iCP<sp/>was<sp/>successfully<sp/>initialized</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1845"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a60384be16093e9c57bed8078cc5b7b2b" kindref="member">iCPInfo</ref>.<ref refid="structFTIT__iCPInfo_1afc19d9ee59e21138eac3643795ebb505" kindref="member">status</ref><sp/>==<sp/><ref refid="icp_8h_1af26d3cc9ee10fe6b0ea516ba65f34604" kindref="member">FTI_ICP_NINI</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1846"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="1847"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1848"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a60384be16093e9c57bed8078cc5b7b2b" kindref="member">iCPInfo</ref>.<ref refid="structFTIT__iCPInfo_1afc19d9ee59e21138eac3643795ebb505" kindref="member">status</ref><sp/>==<sp/><ref refid="icp_8h_1a2dbc8d3165bda9759e43d8b5943942b3" kindref="member">FTI_ICP_FAIL</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1849"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1850"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1851"><highlight class="normal"></highlight></codeline>
<codeline lineno="1852"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>str[<ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>];</highlight></codeline>
<codeline lineno="1853"><highlight class="normal"></highlight></codeline>
<codeline lineno="1854"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>validID<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1855"><highlight class="normal"></highlight></codeline>
<codeline lineno="1856"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="1857"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>check<sp/>if<sp/>dataset<sp/>with<sp/>&apos;varID&apos;<sp/>exists.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1858"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(i=0;<sp/>i&lt;FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>;<sp/>++i)<sp/>{</highlight></codeline>
<codeline lineno="1859"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>validID<sp/>|=<sp/>(FTI_Data[i].<ref refid="structFTIT__dataset_1ac9c58324a5f443f1ea5804b530f7dab2" kindref="member">id</ref><sp/>==<sp/>varID);</highlight></codeline>
<codeline lineno="1860"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1861"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!validID<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1862"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>snprintf(<sp/>str,<sp/><ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;FTI_AddVarICP:<sp/>dataset<sp/>ID:<sp/>%d<sp/>is<sp/>invalid!&quot;</highlight><highlight class="normal">,<sp/>varID<sp/>);</highlight></codeline>
<codeline lineno="1863"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(str,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1864"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1865"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1866"><highlight class="normal"></highlight></codeline>
<codeline lineno="1867"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>check<sp/>if<sp/>dataset<sp/>was<sp/>not<sp/>already<sp/>written.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1868"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(i=0;<sp/>i&lt;FTI_Exec.<ref refid="structFTIT__execution_1a60384be16093e9c57bed8078cc5b7b2b" kindref="member">iCPInfo</ref>.<ref refid="structFTIT__iCPInfo_1a76a30582ac1ab588bf74c393ab7b64b1" kindref="member">countVar</ref>;<sp/>++i)<sp/>{</highlight></codeline>
<codeline lineno="1869"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>validID<sp/>&amp;=<sp/>!(FTI_Exec.<ref refid="structFTIT__execution_1a60384be16093e9c57bed8078cc5b7b2b" kindref="member">iCPInfo</ref>.<ref refid="structFTIT__iCPInfo_1a4acebcc1bdf734027923a1487bec1f53" kindref="member">isWritten</ref>[i]<sp/>==<sp/>varID);</highlight></codeline>
<codeline lineno="1870"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1871"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!validID<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1872"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>snprintf(<sp/>str,<sp/><ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Dataset<sp/>with<sp/>ID:<sp/>%d<sp/>was<sp/>already<sp/>successfully<sp/>written!&quot;</highlight><highlight class="normal">,<sp/>varID<sp/>);</highlight></codeline>
<codeline lineno="1873"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(str,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1874"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1875"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1876"><highlight class="normal"></highlight></codeline>
<codeline lineno="1877"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>res;</highlight></codeline>
<codeline lineno="1878"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>funcID<sp/>=<sp/>FTI_Ckpt[4].<ref refid="structFTIT__checkpoint_1a3759ecf0747658a49b8d4e1715092b12" kindref="member">isInline</ref><sp/>&amp;&amp;<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a19a4f92c1d8dd2c86350f59eb7372ca8" kindref="member">ckptLvel</ref><sp/>==<sp/>4;</highlight></codeline>
<codeline lineno="1879"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>offset<sp/>=<sp/>2*(FTI_Conf.<ref refid="structFTIT__configuration_1a5e319b258138bbb03d5da9917f99acd6" kindref="member">dcpPosix</ref>);</highlight></codeline>
<codeline lineno="1880"><highlight class="normal"><sp/><sp/><sp/><sp/>res=FTI_Exec.<ref refid="structFTIT__execution_1a36029e63668d480ed0b4bf8f9f4ae6da" kindref="member">writeVarICPFunc</ref>[funcID](varID,<sp/>&amp;FTI_Conf,<sp/>&amp;FTI_Exec,<sp/>&amp;FTI_Topo,<sp/>FTI_Ckpt,<sp/>FTI_Data,&amp;<ref refid="fti-io_8c_1a28a33d94e22f56316d3cc558fbc22ea2" kindref="member">ftiIO</ref>[funcID+offset]);</highlight></codeline>
<codeline lineno="1881"><highlight class="normal"></highlight></codeline>
<codeline lineno="1882"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>res<sp/>==<sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1883"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a60384be16093e9c57bed8078cc5b7b2b" kindref="member">iCPInfo</ref>.<ref refid="structFTIT__iCPInfo_1a4acebcc1bdf734027923a1487bec1f53" kindref="member">isWritten</ref>[FTI_Exec.<ref refid="structFTIT__execution_1a60384be16093e9c57bed8078cc5b7b2b" kindref="member">iCPInfo</ref>.<ref refid="structFTIT__iCPInfo_1a76a30582ac1ab588bf74c393ab7b64b1" kindref="member">countVar</ref>++]<sp/>=<sp/>varID;</highlight></codeline>
<codeline lineno="1884"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1885"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="1886"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;Could<sp/>not<sp/>add<sp/>variable<sp/>to<sp/>checkpoint&quot;</highlight><highlight class="normal">,<ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1887"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1888"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>res;</highlight></codeline>
<codeline lineno="1889"><highlight class="normal"></highlight></codeline>
<codeline lineno="1890"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1891"><highlight class="normal"></highlight></codeline>
<codeline lineno="1892"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="1901"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1902" refid="api_8c_1ab21e904a57a97bef0b20c1afbe0d868d" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="api_8c_1ab21e904a57a97bef0b20c1afbe0d868d" kindref="member">FTI_FinalizeICP</ref>()<sp/></highlight></codeline>
<codeline lineno="1903"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1904"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Exec.<ref refid="structFTIT__execution_1a5ff8dd064b2a4cc4b7272abddacb8cc1" kindref="member">initSCES</ref><sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1905"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;FTI<sp/>is<sp/>not<sp/>initialized.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1906"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="1907"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1908"><highlight class="normal"></highlight></codeline>
<codeline lineno="1909"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>if<sp/>iCP<sp/>uninitialized,<sp/>don&apos;t<sp/>step<sp/>in.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1910"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a60384be16093e9c57bed8078cc5b7b2b" kindref="member">iCPInfo</ref>.<ref refid="structFTIT__iCPInfo_1afc19d9ee59e21138eac3643795ebb505" kindref="member">status</ref><sp/>==<sp/><ref refid="icp_8h_1af26d3cc9ee10fe6b0ea516ba65f34604" kindref="member">FTI_ICP_NINI</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1911"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="1912"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1913"><highlight class="normal"></highlight></codeline>
<codeline lineno="1914"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>allRes[2];</highlight></codeline>
<codeline lineno="1915"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>locRes[2]<sp/>=<sp/>{<sp/>(int)(FTI_Exec.<ref refid="structFTIT__execution_1a60384be16093e9c57bed8078cc5b7b2b" kindref="member">iCPInfo</ref>.<ref refid="structFTIT__iCPInfo_1a512d31bfccfb8c286b88c2dd54a68733" kindref="member">result</ref>==<ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>),<sp/>(int)(FTI_Exec.<ref refid="structFTIT__execution_1a60384be16093e9c57bed8078cc5b7b2b" kindref="member">iCPInfo</ref>.<ref refid="structFTIT__iCPInfo_1a76a30582ac1ab588bf74c393ab7b64b1" kindref="member">countVar</ref>==FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>)<sp/>};</highlight></codeline>
<codeline lineno="1916"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Check<sp/>if<sp/>all<sp/>processes<sp/>have<sp/>written<sp/>all<sp/>the<sp/>datasets<sp/>failure<sp/>free.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1917"><highlight class="normal"><sp/><sp/><sp/><sp/>MPI_Allreduce(locRes,<sp/>allRes,<sp/>2,<sp/>MPI_INT,<sp/>MPI_SUM,<sp/><ref refid="api_8c_1a7deaa5171fbf22fe59ae1c08f2bdcc97" kindref="member">FTI_COMM_WORLD</ref>);</highlight></codeline>
<codeline lineno="1918"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(allRes[0]<sp/>!=<sp/>FTI_Topo.<ref refid="structFTIT__topology_1ae95183051d84d1ee105771251c27d0b6" kindref="member">nbNodes</ref>*FTI_Topo.<ref refid="structFTIT__topology_1ab2b0c3441e7d43d243de5fefb4d8bf5d" kindref="member">nbApprocs</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1919"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a60384be16093e9c57bed8078cc5b7b2b" kindref="member">iCPInfo</ref>.<ref refid="structFTIT__iCPInfo_1afc19d9ee59e21138eac3643795ebb505" kindref="member">status</ref><sp/>=<sp/><ref refid="icp_8h_1a2dbc8d3165bda9759e43d8b5943942b3" kindref="member">FTI_ICP_FAIL</ref>;</highlight></codeline>
<codeline lineno="1920"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;Not<sp/>all<sp/>variables<sp/>were<sp/>successfully<sp/>written!.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a5cb1252ae17ef4ac13b3dbe5a8b1ab13" kindref="member">FTI_EROR</ref>);</highlight></codeline>
<codeline lineno="1921"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1922"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(allRes[1]<sp/>!=<sp/>FTI_Topo.<ref refid="structFTIT__topology_1ae95183051d84d1ee105771251c27d0b6" kindref="member">nbNodes</ref>*FTI_Topo.<ref refid="structFTIT__topology_1ab2b0c3441e7d43d243de5fefb4d8bf5d" kindref="member">nbApprocs</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1923"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a60384be16093e9c57bed8078cc5b7b2b" kindref="member">iCPInfo</ref>.<ref refid="structFTIT__iCPInfo_1afc19d9ee59e21138eac3643795ebb505" kindref="member">status</ref><sp/>=<sp/><ref refid="icp_8h_1a2dbc8d3165bda9759e43d8b5943942b3" kindref="member">FTI_ICP_FAIL</ref>;</highlight></codeline>
<codeline lineno="1924"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;Not<sp/>all<sp/>datasets<sp/>were<sp/>added<sp/>to<sp/>the<sp/>CP<sp/>file!.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a5cb1252ae17ef4ac13b3dbe5a8b1ab13" kindref="member">FTI_EROR</ref>);</highlight></codeline>
<codeline lineno="1925"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1926"><highlight class="normal"></highlight></codeline>
<codeline lineno="1927"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>str[<ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>];</highlight></codeline>
<codeline lineno="1928"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>resCP;</highlight></codeline>
<codeline lineno="1929"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>resPP<sp/>=<sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="1930"><highlight class="normal"></highlight></codeline>
<codeline lineno="1931"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>funcID<sp/>=<sp/>FTI_Ckpt[4].<ref refid="structFTIT__checkpoint_1a3759ecf0747658a49b8d4e1715092b12" kindref="member">isInline</ref><sp/>&amp;&amp;<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a19a4f92c1d8dd2c86350f59eb7372ca8" kindref="member">ckptLvel</ref><sp/>==<sp/>4;</highlight></codeline>
<codeline lineno="1932"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>offset<sp/>=<sp/>2*(FTI_Conf.<ref refid="structFTIT__configuration_1a5e319b258138bbb03d5da9917f99acd6" kindref="member">dcpPosix</ref>);</highlight></codeline>
<codeline lineno="1933"><highlight class="normal"><sp/><sp/><sp/><sp/>resCP=FTI_Exec.<ref refid="structFTIT__execution_1ad6add7b6d971d0601513da0e5034588e" kindref="member">finalizeICPFunc</ref>[funcID](&amp;FTI_Conf,<sp/>&amp;FTI_Exec,<sp/>&amp;FTI_Topo,<sp/>FTI_Ckpt,<sp/>FTI_Data,<sp/>&amp;<ref refid="fti-io_8c_1a28a33d94e22f56316d3cc558fbc22ea2" kindref="member">ftiIO</ref>[funcID+offset]);</highlight></codeline>
<codeline lineno="1934"><highlight class="normal"></highlight></codeline>
<codeline lineno="1935"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>no<sp/>postprocessing<sp/>or<sp/>meta<sp/>data<sp/>for<sp/>h5<sp/>single<sp/>file</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1936"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>resCP<sp/>==<sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref><sp/>&amp;&amp;<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a18192d9c04546cfdbb41d3472be77946" kindref="member">h5SingleFile</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1937"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>str[<ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>];</highlight></codeline>
<codeline lineno="1938"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sprintf(<sp/>str,<sp/></highlight><highlight class="stringliteral">&quot;Ckpt.<sp/>ID<sp/>%d<sp/>(Variate<sp/>Processor<sp/>Recovery<sp/>File)<sp/>(%.2f<sp/>MB/proc)<sp/>taken<sp/>in<sp/>%.2f<sp/>sec.&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1939"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1afe4ababcb4c2ea0a21a87b237f8d7a00" kindref="member">ckptID</ref>,<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a19693c7f3a31b31d90a40dcf7fc34183" kindref="member">ckptSize</ref><sp/>/<sp/>(1024.0<sp/>*<sp/>1024.0),<sp/>MPI_Wtime()<sp/>-<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a60384be16093e9c57bed8078cc5b7b2b" kindref="member">iCPInfo</ref>.<ref refid="structFTIT__iCPInfo_1a447bef7931d6159561c1697a9e69299e" kindref="member">t0</ref><sp/>);</highlight></codeline>
<codeline lineno="1940"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(str,<sp/><ref refid="fti-intern_8h_1a26a561f0e03eec3d15541c85a2a21ffd" kindref="member">FTI_INFO</ref>);</highlight></codeline>
<codeline lineno="1941"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="1942"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1943"><highlight class="normal"></highlight></codeline>
<codeline lineno="1944"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>resCP<sp/>==<sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1945"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>resCP<sp/>=<sp/><ref refid="tools_8c_1a950803008f7cef4892fbba9b2069928e" kindref="member">FTI_Try</ref>(<ref refid="meta_8c_1ae6dfc4ce50cbd1081f52962e5b822ac3" kindref="member">FTI_CreateMetadata</ref>(&amp;FTI_Conf,<sp/>&amp;FTI_Exec,<sp/>&amp;FTI_Topo,<sp/>FTI_Ckpt,<sp/>FTI_Data),<sp/></highlight><highlight class="stringliteral">&quot;create<sp/>metadata.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1946"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1947"><highlight class="normal"></highlight></codeline>
<codeline lineno="1948"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>resCP<sp/>!=<sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1949"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a60384be16093e9c57bed8078cc5b7b2b" kindref="member">iCPInfo</ref>.<ref refid="structFTIT__iCPInfo_1afc19d9ee59e21138eac3643795ebb505" kindref="member">status</ref><sp/>=<sp/><ref refid="icp_8h_1a2dbc8d3165bda9759e43d8b5943942b3" kindref="member">FTI_ICP_FAIL</ref>;</highlight></codeline>
<codeline lineno="1950"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sprintf(str,<sp/></highlight><highlight class="stringliteral">&quot;Checkpoint<sp/>with<sp/>ID<sp/>%d<sp/>at<sp/>Level<sp/>%d<sp/>failed.&quot;</highlight><highlight class="normal">,<sp/>FTI_Exec.<ref refid="structFTIT__execution_1afe4ababcb4c2ea0a21a87b237f8d7a00" kindref="member">ckptID</ref>,<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a19a4f92c1d8dd2c86350f59eb7372ca8" kindref="member">ckptLvel</ref>);</highlight></codeline>
<codeline lineno="1951"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(str,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="1952"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1953"><highlight class="normal"></highlight></codeline>
<codeline lineno="1954"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>t2<sp/>=<sp/>MPI_Wtime();<sp/></highlight><highlight class="comment">//Time<sp/>after<sp/>writing<sp/>checkpoint</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1955"><highlight class="normal"></highlight></codeline>
<codeline lineno="1956"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>(FTI_Conf.<ref refid="structFTIT__configuration_1aae6a605160c14bd0f0174d9aa94b4183" kindref="member">dcpFtiff</ref>||FTI_Conf.<ref refid="structFTIT__configuration_1a5e319b258138bbb03d5da9917f99acd6" kindref="member">dcpPosix</ref>)<sp/>&amp;&amp;<sp/>FTI_Ckpt[4].<ref refid="structFTIT__checkpoint_1a2e5377d7aa3c3342b6d633bb1f3afb70" kindref="member">isDcp</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1957"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>After<sp/>dCP<sp/>update<sp/>store<sp/>total<sp/>data<sp/>and<sp/>dCP<sp/>sizes<sp/>in<sp/>application<sp/>rank<sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1958"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>*dataSize<sp/>=<sp/>(FTI_Conf.<ref refid="structFTIT__configuration_1aae6a605160c14bd0f0174d9aa94b4183" kindref="member">dcpFtiff</ref>)?(</highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal">*)&amp;FTI_Exec.<ref refid="structFTIT__execution_1a4516e35484d3cf4777b95303f3948f03" kindref="member">FTIFFMeta</ref>.<ref refid="structFTIFF__metaInfo_1ac3c6b9f5c481fc44e69db2d625201547" kindref="member">pureDataSize</ref>:&amp;FTI_Exec.<ref refid="structFTIT__execution_1a2989b4148c5ef93b8ae18bfe84c3cc59" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpExecutionPosix_1abcf766ef7f738705f5dac1f42aeaa0e7" kindref="member">dataSize</ref>;</highlight></codeline>
<codeline lineno="1959"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>*dcpSize<sp/>=<sp/>(FTI_Conf.<ref refid="structFTIT__configuration_1aae6a605160c14bd0f0174d9aa94b4183" kindref="member">dcpFtiff</ref>)?(</highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal">*)&amp;FTI_Exec.<ref refid="structFTIT__execution_1a4516e35484d3cf4777b95303f3948f03" kindref="member">FTIFFMeta</ref>.<ref refid="structFTIFF__metaInfo_1a48a91b60de626495c80f26096bbb6c97" kindref="member">dcpSize</ref>:&amp;FTI_Exec.<ref refid="structFTIT__execution_1a2989b4148c5ef93b8ae18bfe84c3cc59" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpExecutionPosix_1abf959bf358b8122c0ac01aa3fa945bdc" kindref="member">dcpSize</ref>;</highlight></codeline>
<codeline lineno="1960"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>dcpStats[2];<sp/></highlight><highlight class="comment">//<sp/>0:totalDcpSize,<sp/>1:totalDataSize</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1961"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>sendBuf[]<sp/>=<sp/>{<sp/>*dcpSize,<sp/>*dataSize<sp/>};</highlight></codeline>
<codeline lineno="1962"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MPI_Reduce(<sp/>sendBuf,<sp/>dcpStats,<sp/>2,<sp/>MPI_UNSIGNED_LONG,<sp/>MPI_SUM,<sp/>0,<sp/><ref refid="api_8c_1a7deaa5171fbf22fe59ae1c08f2bdcc97" kindref="member">FTI_COMM_WORLD</ref><sp/>);</highlight></codeline>
<codeline lineno="1963"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>FTI_Topo.<ref refid="structFTIT__topology_1a3d4083051c43d031972d83cffb242a38" kindref="member">splitRank</ref><sp/>==<sp/><sp/>0<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1964"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*dcpSize<sp/>=<sp/>dcpStats[0];<sp/></highlight></codeline>
<codeline lineno="1965"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*dataSize<sp/>=<sp/>dcpStats[1];</highlight></codeline>
<codeline lineno="1966"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1967"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1968"><highlight class="normal"></highlight></codeline>
<codeline lineno="1969"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>TODO<sp/>this<sp/>has<sp/>to<sp/>come<sp/>inside<sp/>postckpt<sp/>on<sp/>success!<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1970"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>(FTI_Conf.<ref refid="structFTIT__configuration_1aae6a605160c14bd0f0174d9aa94b4183" kindref="member">dcpFtiff</ref><sp/>||<sp/>FTI_Conf.<ref refid="structFTIT__configuration_1aade25d97154976c2efbf75f1343fada5" kindref="member">keepL4Ckpt</ref>)<sp/>&amp;&amp;<sp/>(FTI_Topo.<ref refid="structFTIT__topology_1a3d4083051c43d031972d83cffb242a38" kindref="member">splitRank</ref><sp/>==<sp/>0)<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1971"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="meta_8c_1aebd3655df169cee88d8a5324f41cbe3c" kindref="member">FTI_WriteCkptMetaData</ref>(<sp/>&amp;FTI_Conf,<sp/>&amp;FTI_Exec,<sp/>&amp;FTI_Topo,<sp/>FTI_Ckpt<sp/>);</highlight></codeline>
<codeline lineno="1972"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1973"><highlight class="normal"></highlight></codeline>
<codeline lineno="1974"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>status<sp/>=<sp/>(FTI_Exec.<ref refid="structFTIT__execution_1a60384be16093e9c57bed8078cc5b7b2b" kindref="member">iCPInfo</ref>.<ref refid="structFTIT__iCPInfo_1afc19d9ee59e21138eac3643795ebb505" kindref="member">status</ref><sp/>==<sp/><ref refid="icp_8h_1a2dbc8d3165bda9759e43d8b5943942b3" kindref="member">FTI_ICP_FAIL</ref>)<sp/>?<sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref><sp/>:<sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="1975"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!FTI_Ckpt[FTI_Exec.<ref refid="structFTIT__execution_1a19a4f92c1d8dd2c86350f59eb7372ca8" kindref="member">ckptLvel</ref>].<ref refid="structFTIT__checkpoint_1a3759ecf0747658a49b8d4e1715092b12" kindref="member">isInline</ref>)<sp/>{<sp/></highlight><highlight class="comment">//<sp/>If<sp/>postCkpt.<sp/>work<sp/>is<sp/>Async.<sp/>then<sp/>send<sp/>message</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1976"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a5dba7e9abb06346b040c3e74370f879f" kindref="member">activateHeads</ref>(<sp/>&amp;FTI_Conf,<sp/>&amp;FTI_Exec,<sp/>&amp;FTI_Topo,<sp/>FTI_Ckpt,<sp/>status);</highlight></codeline>
<codeline lineno="1977"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/></highlight><highlight class="comment">//If<sp/>post-processing<sp/>is<sp/>inline</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1978"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a5f9c804789b75f8a3cab11fb1685c106" kindref="member">wasLastOffline</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1979"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Exec.<ref refid="structFTIT__execution_1a60384be16093e9c57bed8078cc5b7b2b" kindref="member">iCPInfo</ref>.<ref refid="structFTIT__iCPInfo_1afc19d9ee59e21138eac3643795ebb505" kindref="member">status</ref><sp/>==<sp/><ref refid="icp_8h_1a2dbc8d3165bda9759e43d8b5943942b3" kindref="member">FTI_ICP_FAIL</ref>)<sp/>{<sp/></highlight><highlight class="comment">//If<sp/>Writing<sp/>checkpoint<sp/>failed</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1980"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a19a4f92c1d8dd2c86350f59eb7372ca8" kindref="member">ckptLvel</ref><sp/>=<sp/><ref refid="fti-intern_8h_1aeb28ad968c769903d39cec8d41690f3c" kindref="member">FTI_REJW</ref><sp/>-<sp/><ref refid="fti-intern_8h_1a8072c73e48c25b82d8a0dc35794586c3" kindref="member">FTI_BASE</ref>;<sp/></highlight><highlight class="comment">//The<sp/>same<sp/>as<sp/>head<sp/>call<sp/>FTI_PostCkpt<sp/>with<sp/>reject<sp/>ckptLvel<sp/>if<sp/>not<sp/>success</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1981"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1982"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>resPP<sp/>=<sp/><ref refid="tools_8c_1a950803008f7cef4892fbba9b2069928e" kindref="member">FTI_Try</ref>(<ref refid="checkpoint_8c_1a304411ac19756871bac1eec1517bc57b" kindref="member">FTI_PostCkpt</ref>(&amp;FTI_Conf,<sp/>&amp;FTI_Exec,<sp/>&amp;FTI_Topo,<sp/>FTI_Ckpt),<sp/></highlight><highlight class="stringliteral">&quot;postprocess<sp/>the<sp/>checkpoint.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1983"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(resPP<sp/>==<sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>)<sp/>{<sp/></highlight><highlight class="comment">//If<sp/>post-processing<sp/>succeed</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1984"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a92ac9b3e26177d2e59ecfc83a4e460b9" kindref="member">lastCkptLvel</ref><sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a19a4f92c1d8dd2c86350f59eb7372ca8" kindref="member">ckptLvel</ref>;<sp/></highlight><highlight class="comment">//Store<sp/>last<sp/>successful<sp/>post-processing<sp/>checkpoint<sp/>level</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1985"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1986"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1987"><highlight class="normal"></highlight></codeline>
<codeline lineno="1988"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>!FTI_Exec.<ref refid="structFTIT__execution_1a6b8b6b1922b2561d237b1097a2ea14ef" kindref="member">hasCkpt</ref><sp/>&amp;&amp;<sp/>(FTI_Topo.<ref refid="structFTIT__topology_1a3d4083051c43d031972d83cffb242a38" kindref="member">splitRank</ref><sp/>==<sp/>0)<sp/>&amp;&amp;<sp/>(resPP<sp/>==<sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>)<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1989"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Setting<sp/>recover<sp/>flag<sp/>to<sp/>1<sp/>(to<sp/>recover<sp/>from<sp/>current<sp/>ckpt<sp/>level)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1990"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>res<sp/>=<sp/><ref refid="tools_8c_1a950803008f7cef4892fbba9b2069928e" kindref="member">FTI_Try</ref>(<ref refid="conf_8c_1a072119e00ecaef96e6b516174beb0321" kindref="member">FTI_UpdateConf</ref>(&amp;FTI_Conf,<sp/>&amp;FTI_Exec,<sp/>1),<sp/></highlight><highlight class="stringliteral">&quot;update<sp/>configuration<sp/>file.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1991"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a5ff8dd064b2a4cc4b7272abddacb8cc1" kindref="member">initSCES</ref><sp/>=<sp/>1;<sp/></highlight><highlight class="comment">//in<sp/>case<sp/>FTI<sp/>couldn&apos;t<sp/>recover<sp/>all<sp/>ckpt<sp/>files<sp/>in<sp/>FTI_Init</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1992"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>res<sp/>==<sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1993"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a6b8b6b1922b2561d237b1097a2ea14ef" kindref="member">hasCkpt</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1994"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1995"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1996"><highlight class="normal"></highlight></codeline>
<codeline lineno="1997"><highlight class="normal"><sp/><sp/><sp/><sp/>MPI_Bcast(<sp/>&amp;FTI_Exec.<ref refid="structFTIT__execution_1a6b8b6b1922b2561d237b1097a2ea14ef" kindref="member">hasCkpt</ref>,<sp/>1,<sp/>MPI_INT,<sp/>0,<sp/><ref refid="api_8c_1a7deaa5171fbf22fe59ae1c08f2bdcc97" kindref="member">FTI_COMM_WORLD</ref><sp/>);</highlight></codeline>
<codeline lineno="1998"><highlight class="normal"></highlight></codeline>
<codeline lineno="1999"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>t3<sp/>=<sp/>MPI_Wtime();<sp/></highlight><highlight class="comment">//Time<sp/>after<sp/>post-processing</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2000"><highlight class="normal"></highlight></codeline>
<codeline lineno="2001"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>resCP<sp/>==<sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="2002"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sprintf(str,<sp/></highlight><highlight class="stringliteral">&quot;Ckpt.<sp/>ID<sp/>%d<sp/>(L%d)<sp/>(%.2f<sp/>MB/proc)<sp/>taken<sp/>in<sp/>%.2f<sp/>sec.<sp/>(Wt:%.2fs,<sp/>Wr:%.2fs,<sp/>Ps:%.2fs)&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2003"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1afe4ababcb4c2ea0a21a87b237f8d7a00" kindref="member">ckptID</ref>,<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a19a4f92c1d8dd2c86350f59eb7372ca8" kindref="member">ckptLvel</ref>,<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a19693c7f3a31b31d90a40dcf7fc34183" kindref="member">ckptSize</ref><sp/>/<sp/>(1024.0<sp/>*<sp/>1024.0),<sp/>t3<sp/>-<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a60384be16093e9c57bed8078cc5b7b2b" kindref="member">iCPInfo</ref>.<ref refid="structFTIT__iCPInfo_1a447bef7931d6159561c1697a9e69299e" kindref="member">t0</ref>,<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a60384be16093e9c57bed8078cc5b7b2b" kindref="member">iCPInfo</ref>.<ref refid="structFTIT__iCPInfo_1a2fb00d9b13849a7bf898de5c42b56155" kindref="member">t1</ref><sp/>-<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a60384be16093e9c57bed8078cc5b7b2b" kindref="member">iCPInfo</ref>.<ref refid="structFTIT__iCPInfo_1a447bef7931d6159561c1697a9e69299e" kindref="member">t0</ref>,<sp/>t2<sp/>-<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a60384be16093e9c57bed8078cc5b7b2b" kindref="member">iCPInfo</ref>.<ref refid="structFTIT__iCPInfo_1a2fb00d9b13849a7bf898de5c42b56155" kindref="member">t1</ref>,<sp/>t3<sp/>-<sp/>t2);</highlight></codeline>
<codeline lineno="2004"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(str,<sp/><ref refid="fti-intern_8h_1a26a561f0e03eec3d15541c85a2a21ffd" kindref="member">FTI_INFO</ref>);</highlight></codeline>
<codeline lineno="2005"><highlight class="normal"></highlight></codeline>
<codeline lineno="2006"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>(FTI_Conf.<ref refid="structFTIT__configuration_1aae6a605160c14bd0f0174d9aa94b4183" kindref="member">dcpFtiff</ref>||FTI_Conf.<ref refid="structFTIT__configuration_1a5e319b258138bbb03d5da9917f99acd6" kindref="member">dcpPosix</ref>)<sp/>&amp;&amp;<sp/>FTI_Ckpt[4].<ref refid="structFTIT__checkpoint_1a2e5377d7aa3c3342b6d633bb1f3afb70" kindref="member">isDcp</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="2007"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dcp_8c_1a794fe50f7bf99fcbd9e5b55d62c81f9d" kindref="member">FTI_PrintDcpStats</ref>(<sp/>FTI_Conf,<sp/>FTI_Exec,<sp/>FTI_Topo<sp/>);</highlight></codeline>
<codeline lineno="2008"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2009"><highlight class="normal"></highlight></codeline>
<codeline lineno="2010"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Exec.<ref refid="structFTIT__execution_1a60384be16093e9c57bed8078cc5b7b2b" kindref="member">iCPInfo</ref>.<ref refid="structFTIT__iCPInfo_1a50a98f63da5b018f47119597bbb6b748" kindref="member">isFirstCp</ref><sp/>&amp;&amp;<sp/>FTI_Topo.<ref refid="structFTIT__topology_1a3d4083051c43d031972d83cffb242a38" kindref="member">splitRank</ref><sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="2011"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Setting<sp/>recover<sp/>flag<sp/>to<sp/>1<sp/>(to<sp/>recover<sp/>from<sp/>current<sp/>ckpt<sp/>level)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2012"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tools_8c_1a950803008f7cef4892fbba9b2069928e" kindref="member">FTI_Try</ref>(<ref refid="conf_8c_1a072119e00ecaef96e6b516174beb0321" kindref="member">FTI_UpdateConf</ref>(&amp;FTI_Conf,<sp/>&amp;FTI_Exec,<sp/>1),<sp/></highlight><highlight class="stringliteral">&quot;update<sp/>configuration<sp/>file.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="2013"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a5ff8dd064b2a4cc4b7272abddacb8cc1" kindref="member">initSCES</ref><sp/>=<sp/>1;<sp/></highlight><highlight class="comment">//in<sp/>case<sp/>FTI<sp/>couldn&apos;t<sp/>recover<sp/>all<sp/>ckpt<sp/>files<sp/>in<sp/>FTI_Init</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2014"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2015"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2016"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1afe4ababcb4c2ea0a21a87b237f8d7a00" kindref="member">ckptID</ref><sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a60384be16093e9c57bed8078cc5b7b2b" kindref="member">iCPInfo</ref>.<ref refid="structFTIT__iCPInfo_1afe3db06d76fa7808ebe81a70f54c132e" kindref="member">lastCkptID</ref>;</highlight></codeline>
<codeline lineno="2017"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2018"><highlight class="normal"></highlight></codeline>
<codeline lineno="2019"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a60384be16093e9c57bed8078cc5b7b2b" kindref="member">iCPInfo</ref>.<ref refid="structFTIT__iCPInfo_1afc19d9ee59e21138eac3643795ebb505" kindref="member">status</ref><sp/>=<sp/><ref refid="icp_8h_1af26d3cc9ee10fe6b0ea516ba65f34604" kindref="member">FTI_ICP_NINI</ref>;</highlight></codeline>
<codeline lineno="2020"><highlight class="normal"></highlight></codeline>
<codeline lineno="2021"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="2022"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2023"><highlight class="normal"></highlight></codeline>
<codeline lineno="2024"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="2033"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2034" refid="api_8c_1ab761c55656aab212daf8e6f447ec2214" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="api_8c_1ab761c55656aab212daf8e6f447ec2214" kindref="member">FTI_Recover</ref>()</highlight></codeline>
<codeline lineno="2035"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2036"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>FTI_Conf.<ref refid="structFTIT__configuration_1a5853fc734fbdc50680125595e6cc4f74" kindref="member">ioMode</ref><sp/>==<sp/><ref refid="fti-intern_8h_1a2b6ae4a8dc77345c8aa9497f8cb9291b" kindref="member">FTI_IO_FTIFF</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="2037"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>ret<sp/>=<sp/><ref refid="tools_8c_1a950803008f7cef4892fbba9b2069928e" kindref="member">FTI_Try</ref>(FTIFF_Recover(<sp/>&amp;FTI_Exec,<sp/>FTI_Data,<sp/>FTI_Ckpt<sp/>),<sp/></highlight><highlight class="stringliteral">&quot;Recovering<sp/>from<sp/>Checkpoint&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="2038"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ret;</highlight></codeline>
<codeline lineno="2039"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2040"><highlight class="normal"></highlight></codeline>
<codeline lineno="2041"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Exec.<ref refid="structFTIT__execution_1a5ff8dd064b2a4cc4b7272abddacb8cc1" kindref="member">initSCES</ref><sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="2042"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;FTI<sp/>is<sp/>not<sp/>initialized.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="2043"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="2044"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2045"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Exec.<ref refid="structFTIT__execution_1a5ff8dd064b2a4cc4b7272abddacb8cc1" kindref="member">initSCES</ref><sp/>==<sp/>2)<sp/>{</highlight></codeline>
<codeline lineno="2046"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;No<sp/>checkpoint<sp/>files<sp/>to<sp/>make<sp/>recovery.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="2047"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="2048"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2049"><highlight class="normal"></highlight></codeline>
<codeline lineno="2050"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="2051"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>fn[<ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>];<sp/></highlight><highlight class="comment">//Path<sp/>to<sp/>the<sp/>checkpoint<sp/>file</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2052"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>str[2*<ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>];<sp/></highlight><highlight class="comment">//For<sp/>console<sp/>output</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2053"><highlight class="normal"></highlight></codeline>
<codeline lineno="2054"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Check<sp/>if<sp/>number<sp/>of<sp/>protected<sp/>variables<sp/>matches</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2055"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a18192d9c04546cfdbb41d3472be77946" kindref="member">h5SingleFile</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="2056"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>ENABLE_HDF5</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2057"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>FTI_CheckDimensions(<sp/>FTI_Data,<sp/>&amp;FTI_Exec<sp/>)<sp/>!=<sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="2058"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(<sp/></highlight><highlight class="stringliteral">&quot;Dimension<sp/>missmatch<sp/>in<sp/>VPR<sp/>file.<sp/>Recovery<sp/>failed!&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref><sp/>);</highlight></codeline>
<codeline lineno="2059"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1ac879dcdb853f4b5993ceed9fb1d06e88" kindref="member">FTI_NREC</ref>;</highlight></codeline>
<codeline lineno="2060"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2061"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2062"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;FTI<sp/>is<sp/>not<sp/>compiled<sp/>with<sp/>HDF5<sp/>support!&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a5cb1252ae17ef4ac13b3dbe5a8b1ab13" kindref="member">FTI_EROR</ref>);</highlight></codeline>
<codeline lineno="2063"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="2064"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2065"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!(FTI_Ckpt[FTI_Exec.<ref refid="structFTIT__execution_1a19a4f92c1d8dd2c86350f59eb7372ca8" kindref="member">ckptLvel</ref>].<ref refid="structFTIT__checkpoint_1acc3a5b7f60cd9828620e01745c9d4350" kindref="member">recoIsDcp</ref><sp/>&amp;&amp;<sp/>FTI_Conf.<ref refid="structFTIT__configuration_1a5e319b258138bbb03d5da9917f99acd6" kindref="member">dcpPosix</ref>)<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="2066"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref><sp/>!=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a800c2671725989e4b600fb8a62e4145e" kindref="member">meta</ref>[FTI_Exec.<ref refid="structFTIT__execution_1a19a4f92c1d8dd2c86350f59eb7372ca8" kindref="member">ckptLvel</ref>].<ref refid="structFTIT__metadata_1ac37464bdb77263ab72dbc31638e0cfdd" kindref="member">nbVar</ref>[0]<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="2067"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sprintf(str,<sp/></highlight><highlight class="stringliteral">&quot;Checkpoint<sp/>has<sp/>%d<sp/>protected<sp/>variables,<sp/>but<sp/>FTI<sp/>protects<sp/>%d.&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2068"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a800c2671725989e4b600fb8a62e4145e" kindref="member">meta</ref>[FTI_Exec.<ref refid="structFTIT__execution_1a19a4f92c1d8dd2c86350f59eb7372ca8" kindref="member">ckptLvel</ref>].<ref refid="structFTIT__metadata_1ac37464bdb77263ab72dbc31638e0cfdd" kindref="member">nbVar</ref>[0],<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>);</highlight></codeline>
<codeline lineno="2069"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(str,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="2070"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1ac879dcdb853f4b5993ceed9fb1d06e88" kindref="member">FTI_NREC</ref>;</highlight></codeline>
<codeline lineno="2071"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2072"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Check<sp/>if<sp/>sizes<sp/>of<sp/>protected<sp/>variables<sp/>matches</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2073"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="2074"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Data[i].size<sp/>!=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a800c2671725989e4b600fb8a62e4145e" kindref="member">meta</ref>[FTI_Exec.<ref refid="structFTIT__execution_1a19a4f92c1d8dd2c86350f59eb7372ca8" kindref="member">ckptLvel</ref>].<ref refid="structFTIT__metadata_1aa823ffc7331029d058ef43a742309231" kindref="member">varSize</ref>[i])<sp/>{</highlight></codeline>
<codeline lineno="2075"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sprintf(str,<sp/></highlight><highlight class="stringliteral">&quot;Cannot<sp/>recover<sp/>%ld<sp/>bytes<sp/>to<sp/>protected<sp/>variable<sp/>(ID<sp/>%d)<sp/>size:<sp/>%ld&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2076"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a800c2671725989e4b600fb8a62e4145e" kindref="member">meta</ref>[FTI_Exec.<ref refid="structFTIT__execution_1a19a4f92c1d8dd2c86350f59eb7372ca8" kindref="member">ckptLvel</ref>].<ref refid="structFTIT__metadata_1aa823ffc7331029d058ef43a742309231" kindref="member">varSize</ref>[i],<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a800c2671725989e4b600fb8a62e4145e" kindref="member">meta</ref>[FTI_Exec.<ref refid="structFTIT__execution_1a19a4f92c1d8dd2c86350f59eb7372ca8" kindref="member">ckptLvel</ref>].<ref refid="structFTIT__metadata_1aed21e735edbac0db31f09e23eb2e3b2f" kindref="member">varID</ref>[i],</highlight></codeline>
<codeline lineno="2077"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[i].<ref refid="structFTIT__dataset_1a112f9319765938eba3339d86c0e140c9" kindref="member">size</ref>);</highlight></codeline>
<codeline lineno="2078"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(str,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="2079"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1ac879dcdb853f4b5993ceed9fb1d06e88" kindref="member">FTI_NREC</ref>;</highlight></codeline>
<codeline lineno="2080"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2081"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2082"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2083"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref><sp/>!=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a2989b4148c5ef93b8ae18bfe84c3cc59" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpExecutionPosix_1a67560eeb276a22f571f61e47517b1858" kindref="member">nbVarReco</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="2084"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sprintf(str,<sp/></highlight><highlight class="stringliteral">&quot;Checkpoint<sp/>has<sp/>%d<sp/>protected<sp/>variables,<sp/>but<sp/>FTI<sp/>protects<sp/>%d.&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2085"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a2989b4148c5ef93b8ae18bfe84c3cc59" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpExecutionPosix_1a67560eeb276a22f571f61e47517b1858" kindref="member">nbVarReco</ref>,<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>);</highlight></codeline>
<codeline lineno="2086"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(str,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="2087"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1ac879dcdb853f4b5993ceed9fb1d06e88" kindref="member">FTI_NREC</ref>;</highlight></codeline>
<codeline lineno="2088"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2089"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Check<sp/>if<sp/>sizes<sp/>of<sp/>protected<sp/>variables<sp/>matches</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2090"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>lidx<sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a2989b4148c5ef93b8ae18bfe84c3cc59" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpExecutionPosix_1a13072c6afb5b025e98db73f4e013275a" kindref="member">nbLayerReco</ref><sp/>-<sp/>1;</highlight></codeline>
<codeline lineno="2091"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="2092"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>vidx<sp/>=<sp/>FTI_DataGetIdx(<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a2989b4148c5ef93b8ae18bfe84c3cc59" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpExecutionPosix_1a23f59d5fce406a0f93e8f8476a24603c" kindref="member">datasetInfo</ref>[lidx][i].<ref refid="structFTIT__datasetInfo_1a3daa3b8766e7d322475dfce6a467a5d2" kindref="member">varID</ref>,<sp/>&amp;FTI_Exec,<sp/>FTI_Data<sp/>);<sp/></highlight></codeline>
<codeline lineno="2093"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Data[vidx].size<sp/>!=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a2989b4148c5ef93b8ae18bfe84c3cc59" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpExecutionPosix_1a23f59d5fce406a0f93e8f8476a24603c" kindref="member">datasetInfo</ref>[lidx][i].<ref refid="structFTIT__datasetInfo_1a845b2ffd815eb7557b50c0764049653e" kindref="member">varSize</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="2094"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sprintf(str,<sp/></highlight><highlight class="stringliteral">&quot;Cannot<sp/>recover<sp/>%ld<sp/>bytes<sp/>to<sp/>protected<sp/>variable<sp/>(ID<sp/>%d)<sp/>size:<sp/>%ld&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2095"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a2989b4148c5ef93b8ae18bfe84c3cc59" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpExecutionPosix_1a23f59d5fce406a0f93e8f8476a24603c" kindref="member">datasetInfo</ref>[lidx][i].<ref refid="structFTIT__datasetInfo_1a845b2ffd815eb7557b50c0764049653e" kindref="member">varSize</ref>,<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a2989b4148c5ef93b8ae18bfe84c3cc59" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpExecutionPosix_1a23f59d5fce406a0f93e8f8476a24603c" kindref="member">datasetInfo</ref>[lidx][i].<ref refid="structFTIT__datasetInfo_1a3daa3b8766e7d322475dfce6a467a5d2" kindref="member">varID</ref>,</highlight></codeline>
<codeline lineno="2096"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Data[vidx].<ref refid="structFTIT__dataset_1a112f9319765938eba3339d86c0e140c9" kindref="member">size</ref>);</highlight></codeline>
<codeline lineno="2097"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(str,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="2098"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1ac879dcdb853f4b5993ceed9fb1d06e88" kindref="member">FTI_NREC</ref>;</highlight></codeline>
<codeline lineno="2099"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2101"><highlight class="normal"></highlight></codeline>
<codeline lineno="2102"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2103"><highlight class="normal"></highlight></codeline>
<codeline lineno="2104"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>ENABLE_HDF5<sp/>//If<sp/>HDF5<sp/>is<sp/>installed</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2105"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Conf.<ref refid="structFTIT__configuration_1a5853fc734fbdc50680125595e6cc4f74" kindref="member">ioMode</ref><sp/>==<sp/><ref refid="fti-intern_8h_1ace2ba9a1f6bf621481f19d0ac9aaf839" kindref="member">FTI_IO_HDF5</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>ret<sp/>=<sp/>FTI_RecoverHDF5(&amp;FTI_Conf,<sp/>&amp;FTI_Exec,<sp/>FTI_Ckpt,<sp/>FTI_Data);</highlight></codeline>
<codeline lineno="2107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ret;<sp/></highlight></codeline>
<codeline lineno="2108"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2109"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2110"><highlight class="normal"></highlight></codeline>
<codeline lineno="2111"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Recovering<sp/>from<sp/>local<sp/>for<sp/>L4<sp/>case<sp/>in<sp/>FTI_Recover</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2112"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Exec.<ref refid="structFTIT__execution_1a19a4f92c1d8dd2c86350f59eb7372ca8" kindref="member">ckptLvel</ref><sp/>==<sp/>4)<sp/>{</highlight></codeline>
<codeline lineno="2113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>FTI_Ckpt[4].recoIsDcp<sp/>&amp;&amp;<sp/>FTI_Conf.<ref refid="structFTIT__configuration_1a5e319b258138bbb03d5da9917f99acd6" kindref="member">dcpPosix</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="2114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>FTI_RecoverDcpPosix(&amp;FTI_Conf,<sp/>&amp;FTI_Exec,<sp/>FTI_Ckpt,<sp/>FTI_Data);</highlight></codeline>
<codeline lineno="2115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Try<sp/>from<sp/>L1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>snprintf(fn,<sp/><ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;%s/%s&quot;</highlight><highlight class="normal">,<sp/>FTI_Ckpt[1].dir,<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a800c2671725989e4b600fb8a62e4145e" kindref="member">meta</ref>[1].<ref refid="structFTIT__metadata_1af649446726d9d2147f208dee79a75a75" kindref="member">ckptFile</ref>);</highlight></codeline>
<codeline lineno="2118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(access(fn,<sp/>R_OK)<sp/>!=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="2119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//if<sp/>no<sp/>L1<sp/>files<sp/>try<sp/>from<sp/>L4</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>snprintf(fn,<sp/><ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;%s/%s&quot;</highlight><highlight class="normal">,<sp/>FTI_Ckpt[4].dir,<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a800c2671725989e4b600fb8a62e4145e" kindref="member">meta</ref>[4].<ref refid="structFTIT__metadata_1af649446726d9d2147f208dee79a75a75" kindref="member">ckptFile</ref>);</highlight></codeline>
<codeline lineno="2121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2123"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2124"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>snprintf(fn,<sp/><ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;%s/%s&quot;</highlight><highlight class="normal">,<sp/>FTI_Ckpt[FTI_Exec.<ref refid="structFTIT__execution_1a19a4f92c1d8dd2c86350f59eb7372ca8" kindref="member">ckptLvel</ref>].<ref refid="structFTIT__checkpoint_1a98f4f26f6e99e7a07d4fde76b23515ea" kindref="member">dir</ref>,<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a800c2671725989e4b600fb8a62e4145e" kindref="member">meta</ref>[FTI_Exec.<ref refid="structFTIT__execution_1a19a4f92c1d8dd2c86350f59eb7372ca8" kindref="member">ckptLvel</ref>].<ref refid="structFTIT__metadata_1af649446726d9d2147f208dee79a75a75" kindref="member">ckptFile</ref>);</highlight></codeline>
<codeline lineno="2126"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2127"><highlight class="normal"></highlight></codeline>
<codeline lineno="2128"><highlight class="normal"><sp/><sp/><sp/><sp/>sprintf(str,<sp/></highlight><highlight class="stringliteral">&quot;Trying<sp/>to<sp/>load<sp/>FTI<sp/>checkpoint<sp/>file<sp/>(%s)...&quot;</highlight><highlight class="normal">,<sp/>fn);</highlight></codeline>
<codeline lineno="2129"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(str,<sp/><ref refid="fti-intern_8h_1a299db837571db9e73119d159b3428fe0" kindref="member">FTI_DBUG</ref>);</highlight></codeline>
<codeline lineno="2130"><highlight class="normal"></highlight></codeline>
<codeline lineno="2131"><highlight class="normal"><sp/><sp/><sp/><sp/>FILE*<sp/>fd<sp/>=<sp/>fopen(fn,<sp/></highlight><highlight class="stringliteral">&quot;rb&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="2132"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fd<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="2133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sprintf(str,<sp/></highlight><highlight class="stringliteral">&quot;Could<sp/>not<sp/>open<sp/>FTI<sp/>checkpoint<sp/>file.<sp/>(%s)...&quot;</highlight><highlight class="normal">,<sp/>fn);</highlight></codeline>
<codeline lineno="2134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(str,<sp/><ref refid="fti-intern_8h_1a5cb1252ae17ef4ac13b3dbe5a8b1ab13" kindref="member">FTI_EROR</ref>);</highlight></codeline>
<codeline lineno="2135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1ac879dcdb853f4b5993ceed9fb1d06e88" kindref="member">FTI_NREC</ref>;</highlight></codeline>
<codeline lineno="2136"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2137"><highlight class="normal"></highlight></codeline>
<codeline lineno="2138"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>GPUSUPPORT</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2139"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="2140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>filePos<sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a800c2671725989e4b600fb8a62e4145e" kindref="member">meta</ref>[FTI_Exec.<ref refid="structFTIT__execution_1a19a4f92c1d8dd2c86350f59eb7372ca8" kindref="member">ckptLvel</ref>].<ref refid="structFTIT__metadata_1a4f560988ed88d861fb53c023a325655d" kindref="member">filePos</ref>[i];</highlight></codeline>
<codeline lineno="2141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>strncpy(FTI_Data[i].idChar,<sp/>&amp;(FTI_Exec.<ref refid="structFTIT__execution_1a800c2671725989e4b600fb8a62e4145e" kindref="member">meta</ref>[FTI_Exec.<ref refid="structFTIT__execution_1a19a4f92c1d8dd2c86350f59eb7372ca8" kindref="member">ckptLvel</ref>].<ref refid="structFTIT__metadata_1a778cf3ca25931e378be4f58e0ad5e503" kindref="member">idChar</ref>[i*<ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>]),<sp/><ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>);</highlight></codeline>
<codeline lineno="2142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fseek(fd,<sp/>filePos,<sp/>SEEK_SET);</highlight></codeline>
<codeline lineno="2143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Data[i].isDevicePtr)</highlight></codeline>
<codeline lineno="2144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api-cuda_8c_1aa25ca3090fb1052359f6a5fa4b724082" kindref="member">FTI_TransferFileToDeviceAsync</ref>(fd,FTI_Data[i].devicePtr,<sp/>FTI_Data[i].size);<sp/></highlight></codeline>
<codeline lineno="2145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fread(FTI_Data[i].ptr,<sp/>1,<sp/>FTI_Data[i].size,<sp/>fd);</highlight></codeline>
<codeline lineno="2147"><highlight class="normal"></highlight></codeline>
<codeline lineno="2148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ferror(fd))<sp/>{</highlight></codeline>
<codeline lineno="2149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;Could<sp/>not<sp/>read<sp/>FTI<sp/>checkpoint<sp/>file.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a5cb1252ae17ef4ac13b3dbe5a8b1ab13" kindref="member">FTI_EROR</ref>);</highlight></codeline>
<codeline lineno="2150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fclose(fd);</highlight></codeline>
<codeline lineno="2151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1ac879dcdb853f4b5993ceed9fb1d06e88" kindref="member">FTI_NREC</ref>;</highlight></codeline>
<codeline lineno="2152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2153"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/><sp/><sp/></highlight></codeline>
<codeline lineno="2154"><highlight class="normal"></highlight></codeline>
<codeline lineno="2155"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2156"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="2157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>filePos<sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a800c2671725989e4b600fb8a62e4145e" kindref="member">meta</ref>[FTI_Exec.<ref refid="structFTIT__execution_1a19a4f92c1d8dd2c86350f59eb7372ca8" kindref="member">ckptLvel</ref>].<ref refid="structFTIT__metadata_1a4f560988ed88d861fb53c023a325655d" kindref="member">filePos</ref>[i];</highlight></codeline>
<codeline lineno="2158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>strncpy(FTI_Data[i].idChar,<sp/>&amp;(FTI_Exec.<ref refid="structFTIT__execution_1a800c2671725989e4b600fb8a62e4145e" kindref="member">meta</ref>[FTI_Exec.<ref refid="structFTIT__execution_1a19a4f92c1d8dd2c86350f59eb7372ca8" kindref="member">ckptLvel</ref>].<ref refid="structFTIT__metadata_1a778cf3ca25931e378be4f58e0ad5e503" kindref="member">idChar</ref>[i*<ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>]),<sp/><ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>);</highlight></codeline>
<codeline lineno="2159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fseek(fd,<sp/>filePos,<sp/>SEEK_SET);</highlight></codeline>
<codeline lineno="2160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fread(FTI_Data[i].ptr,<sp/>1,<sp/>FTI_Data[i].size,<sp/>fd);</highlight></codeline>
<codeline lineno="2161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ferror(fd))<sp/>{</highlight></codeline>
<codeline lineno="2162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;Could<sp/>not<sp/>read<sp/>FTI<sp/>checkpoint<sp/>file.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a5cb1252ae17ef4ac13b3dbe5a8b1ab13" kindref="member">FTI_EROR</ref>);</highlight></codeline>
<codeline lineno="2163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fclose(fd);</highlight></codeline>
<codeline lineno="2164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1ac879dcdb853f4b5993ceed9fb1d06e88" kindref="member">FTI_NREC</ref>;</highlight></codeline>
<codeline lineno="2165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2166"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="2167"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/><sp/><sp/><sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2168"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fclose(fd)<sp/>!=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="2169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;Could<sp/>not<sp/>close<sp/>FTI<sp/>checkpoint<sp/>file.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a5cb1252ae17ef4ac13b3dbe5a8b1ab13" kindref="member">FTI_EROR</ref>);</highlight></codeline>
<codeline lineno="2170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1ac879dcdb853f4b5993ceed9fb1d06e88" kindref="member">FTI_NREC</ref>;</highlight></codeline>
<codeline lineno="2171"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="2172"><highlight class="normal"></highlight></codeline>
<codeline lineno="2173"><highlight class="normal"><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a061085b1c93b22c4fafbe527e7b1f165" kindref="member">reco</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2174"><highlight class="normal"></highlight></codeline>
<codeline lineno="2175"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="2176"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2177"><highlight class="normal"></highlight></codeline>
<codeline lineno="2178"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="2190"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2191" refid="api_8c_1a6cbf6d6f6b4181e314eef599f85d6c5b" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="api_8c_1a6cbf6d6f6b4181e314eef599f85d6c5b" kindref="member">FTI_Snapshot</ref>()</highlight></codeline>
<codeline lineno="2192"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2193"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Exec.<ref refid="structFTIT__execution_1a5ff8dd064b2a4cc4b7272abddacb8cc1" kindref="member">initSCES</ref><sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="2194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;FTI<sp/>is<sp/>not<sp/>initialized.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="2195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="2196"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2197"><highlight class="normal"></highlight></codeline>
<codeline lineno="2198"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i,<sp/>res,<sp/>level<sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="2199"><highlight class="normal"></highlight></codeline>
<codeline lineno="2200"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Exec.<ref refid="structFTIT__execution_1a061085b1c93b22c4fafbe527e7b1f165" kindref="member">reco</ref>)<sp/>{<sp/></highlight><highlight class="comment">//<sp/>If<sp/>this<sp/>is<sp/>a<sp/>recovery<sp/>load<sp/>icheckpoint<sp/>data</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="tools_8c_1a950803008f7cef4892fbba9b2069928e" kindref="member">FTI_Try</ref>(<ref refid="api_8c_1ab761c55656aab212daf8e6f447ec2214" kindref="member">FTI_Recover</ref>(),<sp/></highlight><highlight class="stringliteral">&quot;recover<sp/>the<sp/>checkpointed<sp/>data.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="2202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="fti_8h_1ac879dcdb853f4b5993ceed9fb1d06e88" kindref="member">FTI_NREC</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1ac879dcdb853f4b5993ceed9fb1d06e88" kindref="member">FTI_NREC</ref>;</highlight></codeline>
<codeline lineno="2204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2205"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2206"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/></highlight><highlight class="comment">//<sp/>If<sp/>it<sp/>is<sp/>a<sp/>checkpoint<sp/>test</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="2208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="checkpoint_8c_1a8479ea8ec8132ae55da9a6573f3d7440" kindref="member">FTI_UpdateIterTime</ref>(&amp;FTI_Exec);</highlight></codeline>
<codeline lineno="2209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Exec.<ref refid="structFTIT__execution_1a753ca607f3813ca1fa4e24f6c50c8902" kindref="member">ckptNext</ref><sp/>==<sp/>FTI_Exec.<ref refid="structFTIT__execution_1ab2c8d7fc648d2fc4f9812da6bbf45c6f" kindref="member">ckptIcnt</ref>)<sp/>{<sp/></highlight><highlight class="comment">//<sp/>If<sp/>it<sp/>is<sp/>time<sp/>to<sp/>check<sp/>for<sp/>possible<sp/>ckpt.<sp/>(every<sp/>minute)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;Checking<sp/>if<sp/>it<sp/>is<sp/>time<sp/>to<sp/>checkpoint.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a299db837571db9e73119d159b3428fe0" kindref="member">FTI_DBUG</ref>);</highlight></codeline>
<codeline lineno="2211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Exec.<ref refid="structFTIT__execution_1a8b37e551e657be4102f47d2362ffe712" kindref="member">globMeanIter</ref><sp/>&gt;<sp/>60)<sp/>{</highlight></codeline>
<codeline lineno="2212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a92de914c1975228186170ee0a2ab650a" kindref="member">minuteCnt</ref><sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a1a0ae3ba0820ef65eb3a877d770f1140" kindref="member">totalIterTime</ref>/60;</highlight></codeline>
<codeline lineno="2213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a92de914c1975228186170ee0a2ab650a" kindref="member">minuteCnt</ref>++;<sp/></highlight><highlight class="comment">//<sp/>Increment<sp/>minute<sp/>counter</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>1;<sp/>i<sp/>&lt;<sp/>5;<sp/>i++)<sp/>{<sp/></highlight><highlight class="comment">//<sp/>Check<sp/>ckpt.<sp/>level</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>(FTI_Ckpt[i].ckptDcpIntv<sp/>&gt;<sp/>0)<sp/></highlight></codeline>
<codeline lineno="2219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>(FTI_Exec.<ref refid="structFTIT__execution_1a92de914c1975228186170ee0a2ab650a" kindref="member">minuteCnt</ref>/(FTI_Ckpt[i].<ref refid="structFTIT__checkpoint_1a77515c8a3f343d7b73ac7e63df0000e9" kindref="member">ckptDcpCnt</ref>*FTI_Ckpt[i].<ref refid="structFTIT__checkpoint_1aa704831ea3ad4d17e37e7a5f310ded04" kindref="member">ckptDcpIntv</ref>))<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="2220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>dCP<sp/>level<sp/>is<sp/>level<sp/>+<sp/>4</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>level<sp/>=<sp/>i<sp/>+<sp/>4;</highlight></codeline>
<codeline lineno="2222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>counts<sp/>the<sp/>passed<sp/>intervall<sp/>times<sp/>(if<sp/>taken<sp/>or<sp/>not...)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Ckpt[i].<ref refid="structFTIT__checkpoint_1a77515c8a3f343d7b73ac7e63df0000e9" kindref="member">ckptDcpCnt</ref>++;</highlight></codeline>
<codeline lineno="2224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>(FTI_Ckpt[i].ckptIntv)<sp/>&gt;<sp/>0<sp/></highlight></codeline>
<codeline lineno="2226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>(FTI_Exec.<ref refid="structFTIT__execution_1a92de914c1975228186170ee0a2ab650a" kindref="member">minuteCnt</ref>/(FTI_Ckpt[i].<ref refid="structFTIT__checkpoint_1a1871c770167dad43a41f1b64adbbf53b" kindref="member">ckptCnt</ref>*FTI_Ckpt[i].<ref refid="structFTIT__checkpoint_1a621b1318efb4ec40077c6f9dc24c7ff5" kindref="member">ckptIntv</ref>))<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="2227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>level<sp/>=<sp/>i;</highlight></codeline>
<codeline lineno="2228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>counts<sp/>the<sp/>passed<sp/>intervall<sp/>times<sp/>(if<sp/>taken<sp/>or<sp/>not...)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Ckpt[i].<ref refid="structFTIT__checkpoint_1a1871c770167dad43a41f1b64adbbf53b" kindref="member">ckptCnt</ref>++;</highlight></codeline>
<codeline lineno="2230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(level<sp/>!=<sp/>-1)<sp/>{</highlight></codeline>
<codeline lineno="2233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="tools_8c_1a950803008f7cef4892fbba9b2069928e" kindref="member">FTI_Try</ref>(<ref refid="api_8c_1a85ccf559fcbee51bd335ba2c6671eadf" kindref="member">FTI_Checkpoint</ref>(FTI_Exec.<ref refid="structFTIT__execution_1a590db72f82171781a3ac02de59b350f6" kindref="member">ckptCnt</ref>,<sp/>level),<sp/></highlight><highlight class="stringliteral">&quot;take<sp/>checkpoint.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="2234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="fti_8h_1a7dee5a1994faa8e4a2664942d4d8c024" kindref="member">FTI_DONE</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a590db72f82171781a3ac02de59b350f6" kindref="member">ckptCnt</ref>++;</highlight></codeline>
<codeline lineno="2236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1ad624914e1aea7eceb3d6217a5ced3114" kindref="member">ckptLast</ref><sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a753ca607f3813ca1fa4e24f6c50c8902" kindref="member">ckptNext</ref>;</highlight></codeline>
<codeline lineno="2239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a753ca607f3813ca1fa4e24f6c50c8902" kindref="member">ckptNext</ref><sp/>=<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a753ca607f3813ca1fa4e24f6c50c8902" kindref="member">ckptNext</ref><sp/>+<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a7e235bbde55b64b0d2e02ec4b6a0385b" kindref="member">ckptIntv</ref>;</highlight></codeline>
<codeline lineno="2240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1ae9be8c33108533c9cd149d2d5adc6d24" kindref="member">iterTime</ref><sp/>=<sp/>MPI_Wtime();<sp/></highlight><highlight class="comment">//<sp/>Reset<sp/>iteration<sp/>duration<sp/>timer</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2242"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2243"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>res;</highlight></codeline>
<codeline lineno="2244"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2245"><highlight class="normal"></highlight></codeline>
<codeline lineno="2246"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="2256"><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2257" refid="api_8c_1aa58102aa8540ed35f2efba23cf2dc19b" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="api_8c_1aa58102aa8540ed35f2efba23cf2dc19b" kindref="member">FTI_Finalize</ref>()</highlight></codeline>
<codeline lineno="2258"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2259"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Exec.<ref refid="structFTIT__execution_1a5ff8dd064b2a4cc4b7272abddacb8cc1" kindref="member">initSCES</ref><sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="2260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;FTI<sp/>is<sp/>not<sp/>initialized.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="2261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="2262"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2263"><highlight class="normal"></highlight></codeline>
<codeline lineno="2264"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Topo.<ref refid="structFTIT__topology_1ad44da908f25f84e0dc29086b77b37d8d" kindref="member">amIaHead</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tools_8c_1a099b42118594b7ec8469348819bfaf93" kindref="member">FTI_FreeMeta</ref>(&amp;FTI_Exec);</highlight></codeline>
<codeline lineno="2266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>FTI_Conf.<ref refid="structFTIT__configuration_1ae6c297d0a3c6e122ee63085f2a365a30" kindref="member">stagingEnabled</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="2267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="stage_8c_1acf6cca854e653c7c23d24011f5b3afc4" kindref="member">FTI_FinalizeStage</ref>(<sp/>&amp;FTI_Exec,<sp/>&amp;FTI_Topo,<sp/>&amp;FTI_Conf<sp/>);</highlight></codeline>
<codeline lineno="2268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MPI_Barrier(FTI_Exec.<ref refid="structFTIT__execution_1a9cbca3e2e49bb808bc73569db3fdecb2" kindref="member">globalComm</ref>);</highlight></codeline>
<codeline lineno="2270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>!FTI_Conf.<ref refid="structFTIT__configuration_1a688e263d23e6dfec49b576cf18f333eb" kindref="member">keepHeadsAlive</ref><sp/>)<sp/>{<sp/></highlight></codeline>
<codeline lineno="2271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MPI_Finalize();</highlight></codeline>
<codeline lineno="2272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>exit(0);</highlight></codeline>
<codeline lineno="2273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="2275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2276"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2277"><highlight class="normal"></highlight></codeline>
<codeline lineno="2278"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Notice:<sp/>The<sp/>following<sp/>code<sp/>is<sp/>only<sp/>executed<sp/>by<sp/>the<sp/>application<sp/>procs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2279"><highlight class="normal"></highlight></codeline>
<codeline lineno="2280"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>free<sp/>hashArray<sp/>memory</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2281"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>FTI_Conf.<ref refid="structFTIT__configuration_1a5e319b258138bbb03d5da9917f99acd6" kindref="member">dcpPosix</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="2282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(;<sp/>i&lt;FTI_Exec.<ref refid="structFTIT__execution_1a97f8b8aebedb2904ad10a18a5a90574f" kindref="member">nbVar</ref>;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="2284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!(<sp/>FTI_Data[i].isDevicePtr)<sp/>){</highlight></codeline>
<codeline lineno="2285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>free(FTI_Data[i].dcpInfoPosix.currentHashArray);</highlight></codeline>
<codeline lineno="2286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>free(FTI_Data[i].dcpInfoPosix.oldHashArray);</highlight></codeline>
<codeline lineno="2287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2288"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>GPUSUPPORT</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="2290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cudaFree(FTI_Data[i].dcpInfoPosix.currentHashArray);</highlight></codeline>
<codeline lineno="2291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cudaFree(FTI_Data[i].dcpInfoPosix.oldHashArray);</highlight></codeline>
<codeline lineno="2292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2293"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2295"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2296"><highlight class="normal"></highlight></codeline>
<codeline lineno="2297"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="tools_8c_1a950803008f7cef4892fbba9b2069928e" kindref="member">FTI_Try</ref>(<ref refid="api-cuda_8c_1abb1ca3c8e8cbff17fdcba133ca6a344d" kindref="member">FTI_DestroyDevices</ref>(),<sp/></highlight><highlight class="stringliteral">&quot;Destroying<sp/>accelerator<sp/>allocated<sp/>memory&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="2298"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Conf.<ref refid="structFTIT__configuration_1a082b3136afb25beb45f0c9ece72ddca7" kindref="member">dcpInfoPosix</ref>.<ref refid="structFTIT__dcpConfigurationPosix_1a04fa4bcb52a95be05b7ac6d128a8c720" kindref="member">cachedCkpt</ref>){<sp/></highlight></codeline>
<codeline lineno="2299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_destroyMD5();</highlight></codeline>
<codeline lineno="2300"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2301"><highlight class="normal"></highlight></codeline>
<codeline lineno="2302"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>If<sp/>there<sp/>is<sp/>remaining<sp/>work<sp/>to<sp/>do<sp/>for<sp/>last<sp/>checkpoint</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2303"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Exec.<ref refid="structFTIT__execution_1a5f9c804789b75f8a3cab11fb1685c106" kindref="member">wasLastOffline</ref><sp/>==<sp/>1)<sp/>{</highlight></codeline>
<codeline lineno="2304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>lastLevel;</highlight></codeline>
<codeline lineno="2305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MPI_Recv(&amp;lastLevel,<sp/>1,<sp/>MPI_INT,<sp/>FTI_Topo.<ref refid="structFTIT__topology_1ad6b000c681a3230febbc5829c6ad9247" kindref="member">headRank</ref>,<sp/>FTI_Conf.<ref refid="structFTIT__configuration_1ae11893be3341d992d9722a21c00eddd4" kindref="member">generalTag</ref>,<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a9cbca3e2e49bb808bc73569db3fdecb2" kindref="member">globalComm</ref>,<sp/>MPI_STATUS_IGNORE);</highlight></codeline>
<codeline lineno="2306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(lastLevel<sp/>!=<sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>)<sp/>{<sp/></highlight><highlight class="comment">//Head<sp/>sends<sp/>level<sp/>of<sp/>checkpoint<sp/>if<sp/>post-processing<sp/>succeed,<sp/>FTI_NSCS<sp/>Otherwise</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_Exec.<ref refid="structFTIT__execution_1a92ac9b3e26177d2e59ecfc83a4e460b9" kindref="member">lastCkptLvel</ref><sp/>=<sp/>lastLevel;</highlight></codeline>
<codeline lineno="2308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2309"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2310"><highlight class="normal"></highlight></codeline>
<codeline lineno="2311"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Send<sp/>notice<sp/>to<sp/>the<sp/>head<sp/>to<sp/>stop<sp/>listening</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2312"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Topo.<ref refid="structFTIT__topology_1ae6c9d66ebe7506e56262bfdd65628ac8" kindref="member">nbHeads</ref><sp/>==<sp/>1)<sp/>{</highlight></codeline>
<codeline lineno="2313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>value<sp/>=<sp/><ref refid="fti-intern_8h_1a9d4e7a150970f56378722be0262d1abb" kindref="member">FTI_ENDW</ref>;</highlight></codeline>
<codeline lineno="2314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MPI_Send(&amp;value,<sp/>1,<sp/>MPI_INT,<sp/>FTI_Topo.<ref refid="structFTIT__topology_1ad6b000c681a3230febbc5829c6ad9247" kindref="member">headRank</ref>,<sp/>FTI_Conf.<ref refid="structFTIT__configuration_1abea01ca900054821ac64628715357082" kindref="member">finalTag</ref>,<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a9cbca3e2e49bb808bc73569db3fdecb2" kindref="member">globalComm</ref>);</highlight></codeline>
<codeline lineno="2315"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2316"><highlight class="normal"></highlight></codeline>
<codeline lineno="2317"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>for<sp/>staging,<sp/>we<sp/>have<sp/>to<sp/>ensure,<sp/>that<sp/>the<sp/>call<sp/>to<sp/>FTI_Clean<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2318"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>comes<sp/>after<sp/>the<sp/>heads<sp/>have<sp/>written<sp/>all<sp/>the<sp/>staging<sp/>files.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2319"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Thus<sp/>FTI_FinalizeStage<sp/>is<sp/>blocking<sp/>on<sp/>global<sp/>communicator.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2320"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>FTI_Conf.<ref refid="structFTIT__configuration_1ae6c297d0a3c6e122ee63085f2a365a30" kindref="member">stagingEnabled</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="2321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="stage_8c_1acf6cca854e653c7c23d24011f5b3afc4" kindref="member">FTI_FinalizeStage</ref>(<sp/>&amp;FTI_Exec,<sp/>&amp;FTI_Topo,<sp/>&amp;FTI_Conf<sp/>);</highlight></codeline>
<codeline lineno="2322"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2323"><highlight class="normal"></highlight></codeline>
<codeline lineno="2324"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>If<sp/>we<sp/>need<sp/>to<sp/>keep<sp/>the<sp/>last<sp/>checkpoint<sp/>and<sp/>there<sp/>was<sp/>a<sp/>checkpoint</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2325"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>FTI_Conf.<ref refid="structFTIT__configuration_1affcbd54643b6e0e594249799fed2517d" kindref="member">saveLastCkpt</ref><sp/>&amp;&amp;<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a6b8b6b1922b2561d237b1097a2ea14ef" kindref="member">hasCkpt</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="2326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//if<sp/>((FTI_Conf.saveLastCkpt<sp/>||<sp/>FTI_Conf.keepL4Ckpt)<sp/>&amp;&amp;<sp/>FTI_Exec.ckptID<sp/>&gt;<sp/>0)<sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Exec.<ref refid="structFTIT__execution_1a92ac9b3e26177d2e59ecfc83a4e460b9" kindref="member">lastCkptLvel</ref><sp/>!=<sp/>4)<sp/>{</highlight></codeline>
<codeline lineno="2328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tools_8c_1a950803008f7cef4892fbba9b2069928e" kindref="member">FTI_Try</ref>(<ref refid="postckpt_8c_1af7ae0209528e53e50e05c8cb94262474" kindref="member">FTI_Flush</ref>(&amp;FTI_Conf,<sp/>&amp;FTI_Exec,<sp/>&amp;FTI_Topo,<sp/>FTI_Ckpt,<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a92ac9b3e26177d2e59ecfc83a4e460b9" kindref="member">lastCkptLvel</ref>),<sp/></highlight><highlight class="stringliteral">&quot;save<sp/>the<sp/>last<sp/>ckpt.<sp/>in<sp/>the<sp/>PFS.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="2329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MPI_Barrier(<ref refid="api_8c_1a7deaa5171fbf22fe59ae1c08f2bdcc97" kindref="member">FTI_COMM_WORLD</ref>);</highlight></codeline>
<codeline lineno="2330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Topo.<ref refid="structFTIT__topology_1a3d4083051c43d031972d83cffb242a38" kindref="member">splitRank</ref><sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="2331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(access(FTI_Ckpt[4].dir,<sp/>0)<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="2332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tools_8c_1ac4bfe54a9748e8915a5a43c17b334452" kindref="member">FTI_RmDir</ref>(FTI_Ckpt[4].dir,<sp/>1);<sp/></highlight><highlight class="comment">//Delete<sp/>previous<sp/>L4<sp/>checkpoint</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="macros_8h_1a1d81d949ec5e13d1eea8d5c287b7312c" kindref="member">RENAME</ref>(FTI_Conf.<ref refid="structFTIT__configuration_1ab5c4f469d7c85ea0efe36f891be796fa" kindref="member">gTmpDir</ref>,FTI_Ckpt[4].<ref refid="structFTIT__checkpoint_1a98f4f26f6e99e7a07d4fde76b23515ea" kindref="member">dir</ref>);</highlight></codeline>
<codeline lineno="2335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>FTI_Conf.<ref refid="structFTIT__configuration_1a5853fc734fbdc50680125595e6cc4f74" kindref="member">ioMode</ref><sp/>!=<sp/><ref refid="fti-intern_8h_1a2b6ae4a8dc77345c8aa9497f8cb9291b" kindref="member">FTI_IO_FTIFF</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="2336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(access(FTI_Ckpt[4].metaDir,<sp/>0)<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="2337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tools_8c_1ac4bfe54a9748e8915a5a43c17b334452" kindref="member">FTI_RmDir</ref>(FTI_Ckpt[4].metaDir,<sp/>1);<sp/></highlight><highlight class="comment">//Delete<sp/>previous<sp/>L4<sp/>metadata</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="macros_8h_1a1d81d949ec5e13d1eea8d5c287b7312c" kindref="member">RENAME</ref>(FTI_Ckpt[FTI_Exec.<ref refid="structFTIT__execution_1a19a4f92c1d8dd2c86350f59eb7372ca8" kindref="member">ckptLvel</ref>].<ref refid="structFTIT__checkpoint_1a98a696506a947071885b4d375029939d" kindref="member">metaDir</ref>,<sp/>FTI_Ckpt[4].<ref refid="structFTIT__checkpoint_1a98a696506a947071885b4d375029939d" kindref="member">metaDir</ref>);</highlight></codeline>
<codeline lineno="2340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Topo.<ref refid="structFTIT__topology_1a3d4083051c43d031972d83cffb242a38" kindref="member">splitRank</ref><sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="2344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Setting<sp/>recover<sp/>flag<sp/>to<sp/>2<sp/>(to<sp/>recover<sp/>from<sp/>L4,<sp/>keeped<sp/>last<sp/>checkpoint)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tools_8c_1a950803008f7cef4892fbba9b2069928e" kindref="member">FTI_Try</ref>(<ref refid="conf_8c_1a072119e00ecaef96e6b516174beb0321" kindref="member">FTI_UpdateConf</ref>(&amp;FTI_Conf,<sp/>&amp;FTI_Exec,<sp/>2),<sp/></highlight><highlight class="stringliteral">&quot;update<sp/>configuration<sp/>file<sp/>to<sp/>2.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="2346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Cleaning<sp/>only<sp/>local<sp/>storage</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tools_8c_1a950803008f7cef4892fbba9b2069928e" kindref="member">FTI_Try</ref>(<ref refid="tools_8c_1a09811bb56f318eab67b3d37bff86cf7f" kindref="member">FTI_Clean</ref>(&amp;FTI_Conf,<sp/>&amp;FTI_Topo,<sp/>FTI_Ckpt,<sp/>6),<sp/></highlight><highlight class="stringliteral">&quot;clean<sp/>local<sp/>directories&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="2349"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>FTI_Conf.<ref refid="structFTIT__configuration_1aade25d97154976c2efbf75f1343fada5" kindref="member">keepL4Ckpt</ref><sp/>&amp;&amp;<sp/>FTI_Ckpt[4].<ref refid="structFTIT__checkpoint_1a0dbcc461ba3263ccbcca067746159f59" kindref="member">hasCkpt</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="2350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="postckpt_8c_1ab9e3ad14022d3a4fa101bdc4e36cf2c2" kindref="member">FTI_ArchiveL4Ckpt</ref>(<sp/>&amp;FTI_Conf,<sp/>&amp;FTI_Exec,<sp/>FTI_Ckpt,<sp/>&amp;FTI_Topo<sp/>);</highlight></codeline>
<codeline lineno="2351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MPI_Barrier(<sp/><ref refid="api_8c_1a7deaa5171fbf22fe59ae1c08f2bdcc97" kindref="member">FTI_COMM_WORLD</ref><sp/>);</highlight></codeline>
<codeline lineno="2352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tools_8c_1ac4bfe54a9748e8915a5a43c17b334452" kindref="member">FTI_RmDir</ref>(<sp/>FTI_Ckpt[4].dir,<sp/>FTI_Topo.<ref refid="structFTIT__topology_1a3d4083051c43d031972d83cffb242a38" kindref="member">splitRank</ref><sp/>==<sp/>0<sp/>);<sp/></highlight></codeline>
<codeline lineno="2353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MPI_Barrier(<sp/><ref refid="api_8c_1a7deaa5171fbf22fe59ae1c08f2bdcc97" kindref="member">FTI_COMM_WORLD</ref><sp/>);</highlight></codeline>
<codeline lineno="2354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>globalFlag<sp/>=<sp/>!FTI_Topo.<ref refid="structFTIT__topology_1a3d4083051c43d031972d83cffb242a38" kindref="member">splitRank</ref>;</highlight></codeline>
<codeline lineno="2355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>globalFlag<sp/>=<sp/>(!(FTI_Ckpt[4].<ref refid="structFTIT__checkpoint_1a2e5377d7aa3c3342b6d633bb1f3afb70" kindref="member">isDcp</ref><sp/>&amp;&amp;<sp/>FTI_Conf.<ref refid="structFTIT__configuration_1aae6a605160c14bd0f0174d9aa94b4183" kindref="member">dcpFtiff</ref>)<sp/>&amp;&amp;<sp/>(globalFlag<sp/>!=<sp/>0));</highlight></codeline>
<codeline lineno="2356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(globalFlag)<sp/>{<sp/></highlight><highlight class="comment">//True<sp/>only<sp/>for<sp/>one<sp/>process<sp/>in<sp/>the<sp/>FTI_COMM_WORLD.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>str[<ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>];</highlight></codeline>
<codeline lineno="2358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>snprintf(str,<sp/><ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;%s/Ckpt_%d/&quot;</highlight><highlight class="normal">,FTI_Ckpt[4].archMeta,FTI_Ckpt[4].ckptID);</highlight></codeline>
<codeline lineno="2359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="macros_8h_1a1d81d949ec5e13d1eea8d5c287b7312c" kindref="member">RENAME</ref>(FTI_Ckpt[4].metaDir,<sp/>str<sp/>);</highlight></codeline>
<codeline lineno="2360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Cleaning<sp/>only<sp/>local<sp/>storage</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tools_8c_1a950803008f7cef4892fbba9b2069928e" kindref="member">FTI_Try</ref>(<ref refid="tools_8c_1a09811bb56f318eab67b3d37bff86cf7f" kindref="member">FTI_Clean</ref>(&amp;FTI_Conf,<sp/>&amp;FTI_Topo,<sp/>FTI_Ckpt,<sp/>6),<sp/></highlight><highlight class="stringliteral">&quot;clean<sp/>local<sp/>directories&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="2363"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Conf.<ref refid="structFTIT__configuration_1affcbd54643b6e0e594249799fed2517d" kindref="member">saveLastCkpt</ref>)<sp/>{<sp/></highlight><highlight class="comment">//if<sp/>there<sp/>was<sp/>no<sp/>saved<sp/>checkpoint</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;No<sp/>checkpoint<sp/>to<sp/>keep<sp/>in<sp/>PFS.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a26a561f0e03eec3d15541c85a2a21ffd" kindref="member">FTI_INFO</ref>);</highlight></codeline>
<codeline lineno="2366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Topo.<ref refid="structFTIT__topology_1a3d4083051c43d031972d83cffb242a38" kindref="member">splitRank</ref><sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="2368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Setting<sp/>recover<sp/>flag<sp/>to<sp/>0<sp/>(no<sp/>checkpoint<sp/>files<sp/>to<sp/>recover<sp/>from<sp/>means<sp/>no<sp/>recovery)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tools_8c_1a950803008f7cef4892fbba9b2069928e" kindref="member">FTI_Try</ref>(<ref refid="conf_8c_1a072119e00ecaef96e6b516174beb0321" kindref="member">FTI_UpdateConf</ref>(&amp;FTI_Conf,<sp/>&amp;FTI_Exec,<sp/>0),<sp/></highlight><highlight class="stringliteral">&quot;update<sp/>configuration<sp/>file<sp/>to<sp/>0.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="2370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Cleaning<sp/>everything</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tools_8c_1a950803008f7cef4892fbba9b2069928e" kindref="member">FTI_Try</ref>(<ref refid="tools_8c_1a09811bb56f318eab67b3d37bff86cf7f" kindref="member">FTI_Clean</ref>(&amp;FTI_Conf,<sp/>&amp;FTI_Topo,<sp/>FTI_Ckpt,<sp/>5),<sp/></highlight><highlight class="stringliteral">&quot;do<sp/>final<sp/>clean.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="2373"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2374"><highlight class="normal"></highlight></codeline>
<codeline lineno="2375"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Conf.<ref refid="structFTIT__configuration_1aae6a605160c14bd0f0174d9aa94b4183" kindref="member">dcpFtiff</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_FinalizeDcp(<sp/>&amp;FTI_Conf,<sp/>&amp;FTI_Exec<sp/>);</highlight></codeline>
<codeline lineno="2377"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2378"><highlight class="normal"></highlight></codeline>
<codeline lineno="2379"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="tools_8c_1a099b42118594b7ec8469348819bfaf93" kindref="member">FTI_FreeMeta</ref>(&amp;FTI_Exec);</highlight></codeline>
<codeline lineno="2380"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="tools_8c_1a152b83c7a93371bef4f0bcbe34620d6e" kindref="member">FTI_FreeTypesAndGroups</ref>(&amp;FTI_Exec);</highlight></codeline>
<codeline lineno="2381"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>FTI_Conf.<ref refid="structFTIT__configuration_1a5853fc734fbdc50680125595e6cc4f74" kindref="member">ioMode</ref><sp/>==<sp/><ref refid="fti-intern_8h_1a2b6ae4a8dc77345c8aa9497f8cb9291b" kindref="member">FTI_IO_FTIFF</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="2382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTIFF_FreeDbFTIFF(FTI_Exec.<ref refid="structFTIT__execution_1ad59b01935dd4a0b4f6766cc4aa26aeb8" kindref="member">lastdb</ref>);</highlight></codeline>
<codeline lineno="2383"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2384"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>ENABLE_HDF5</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2385"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>FTI_Conf.<ref refid="structFTIT__configuration_1ab72c57178235b8d749f88350ea2e248f" kindref="member">h5SingleFileEnable</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="2386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FTI_FreeVPRMem(<sp/>&amp;FTI_Exec,<sp/>FTI_Data<sp/>);<sp/></highlight></codeline>
<codeline lineno="2387"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2388"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2389"><highlight class="normal"><sp/><sp/><sp/><sp/>MPI_Barrier(FTI_Exec.<ref refid="structFTIT__execution_1a9cbca3e2e49bb808bc73569db3fdecb2" kindref="member">globalComm</ref>);</highlight></codeline>
<codeline lineno="2390"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;FTI<sp/>has<sp/>been<sp/>finalized.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a26a561f0e03eec3d15541c85a2a21ffd" kindref="member">FTI_INFO</ref>);</highlight></codeline>
<codeline lineno="2391"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="2392"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2393"><highlight class="normal"></highlight></codeline>
<codeline lineno="2394"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="2409"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2410" refid="api_8c_1a25b793276f5e79e5947e133abdd52c1e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="api_8c_1a25b793276f5e79e5947e133abdd52c1e" kindref="member">FTI_RecoverVar</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2411"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2412"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>res<sp/>=<sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="2413"><highlight class="normal"></highlight></codeline>
<codeline lineno="2414"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//int<sp/>activeID,<sp/>oldID;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2415"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>fn[<ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>];</highlight></codeline>
<codeline lineno="2416"><highlight class="normal"></highlight></codeline>
<codeline lineno="2417"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Exec.<ref refid="structFTIT__execution_1a5ff8dd064b2a4cc4b7272abddacb8cc1" kindref="member">initSCES</ref><sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="2418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;FTI<sp/>is<sp/>not<sp/>initialized.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="2419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="2420"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2421"><highlight class="normal"></highlight></codeline>
<codeline lineno="2422"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(FTI_Exec.<ref refid="structFTIT__execution_1a061085b1c93b22c4fafbe527e7b1f165" kindref="member">reco</ref>==0){</highlight></codeline>
<codeline lineno="2423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>This<sp/>is<sp/>not<sp/>a<sp/>restart:<sp/>no<sp/>actions<sp/>performed<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a8c1f0a06b877c18a7270d54c5e6039cf" kindref="member">FTI_SCES</ref>;</highlight></codeline>
<codeline lineno="2425"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2426"><highlight class="normal"></highlight></codeline>
<codeline lineno="2427"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Exec.<ref refid="structFTIT__execution_1a5ff8dd064b2a4cc4b7272abddacb8cc1" kindref="member">initSCES</ref><sp/>==<sp/>2)<sp/>{</highlight></codeline>
<codeline lineno="2428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;No<sp/>checkpoint<sp/>files<sp/>to<sp/>make<sp/>recovery.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="2429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="2430"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2431"><highlight class="normal"></highlight></codeline>
<codeline lineno="2432"><highlight class="normal"></highlight></codeline>
<codeline lineno="2433"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//snprintf(fn,<sp/>FTI_BUFS,<sp/>&quot;%s/%s&quot;,<sp/>FTI_Ckpt[FTI_Exec-&gt;ckptLvel].dir,<sp/>FTI_Exec-&gt;meta[FTI_Exec-&gt;ckptLvel].ckptFile);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2434"><highlight class="normal"><sp/><sp/><sp/><sp/>snprintf(fn,<sp/><ref refid="fti_8h_1a4da53a2ca9ef19b414ca7e2522c4864a" kindref="member">FTI_BUFS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;%s/%s&quot;</highlight><highlight class="normal">,<sp/>FTI_Ckpt[FTI_Exec.<ref refid="structFTIT__execution_1a19a4f92c1d8dd2c86350f59eb7372ca8" kindref="member">ckptLvel</ref>].<ref refid="structFTIT__checkpoint_1a98f4f26f6e99e7a07d4fde76b23515ea" kindref="member">dir</ref>,<sp/>FTI_Exec.<ref refid="structFTIT__execution_1a800c2671725989e4b600fb8a62e4145e" kindref="member">meta</ref>[FTI_Exec.<ref refid="structFTIT__execution_1a19a4f92c1d8dd2c86350f59eb7372ca8" kindref="member">ckptLvel</ref>].<ref refid="structFTIT__metadata_1af649446726d9d2147f208dee79a75a75" kindref="member">ckptFile</ref>);</highlight></codeline>
<codeline lineno="2435"><highlight class="normal"></highlight></codeline>
<codeline lineno="2436"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(FTI_Conf.<ref refid="structFTIT__configuration_1a5853fc734fbdc50680125595e6cc4f74" kindref="member">ioMode</ref>){</highlight></codeline>
<codeline lineno="2437"><highlight class="normal"></highlight></codeline>
<codeline lineno="2438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="fti-intern_8h_1ace2ba9a1f6bf621481f19d0ac9aaf839" kindref="member">FTI_IO_HDF5</ref>:</highlight></codeline>
<codeline lineno="2439"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>ENABLE_HDF5<sp/>//<sp/>--&gt;<sp/>If<sp/>HDF5<sp/>is<sp/>installed</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>hid_t<sp/>_file_id<sp/>=<sp/>FTI_RecoverVarInitHDF5(FTI_Conf,<sp/>FTI_Exec,<sp/>FTI_Ckpt,<sp/>FTI_Data,<sp/>fn);</highlight></codeline>
<codeline lineno="2441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(_file_id<sp/>!=<sp/>-1){</highlight></codeline>
<codeline lineno="2442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(FTI_RecoverVarHDF5(FTI_Conf,<sp/>FTI_Exec,<sp/>FTI_Ckpt,<sp/>FTI_Data,<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">)<sp/>!=<sp/>-1){</highlight><highlight class="comment">//evaluate<sp/>recovery</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/>FTI_RecoverVarFinalizeHDF5(FTI_Conf,<sp/>FTI_Exec,<sp/>FTI_Ckpt,<sp/>FTI_Data,<sp/>_file_id);</highlight></codeline>
<codeline lineno="2444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2446"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;Selected<sp/>Ckpt<sp/>I/O<sp/>is<sp/>HDF5,<sp/>but<sp/>HDF5<sp/>is<sp/>not<sp/>enabled.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="2448"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2450"><highlight class="normal"></highlight></codeline>
<codeline lineno="2451"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>ENABLE_SIONLIB<sp/>//<sp/>--&gt;<sp/>If<sp/>SIONlib<sp/>is<sp/>installed</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2452"><highlight class="normal"></highlight></codeline>
<codeline lineno="2453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="fti-intern_8h_1acbdad0be6e3192a3a6e7c0326f486047" kindref="member">FTI_IO_SIONLIB</ref>:</highlight></codeline>
<codeline lineno="2454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*int<sp/>filehandle<sp/>=<sp/>FTI_RecoverVarInitSION(fn);</highlight></codeline>
<codeline lineno="2455"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if(filehandle<sp/>&gt;<sp/>0){</highlight></codeline>
<codeline lineno="2456"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if(FTI_RecoverVarSION(filehandle)<sp/>!=<sp/>FTI_NSCS){</highlight></codeline>
<codeline lineno="2457"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/>FTI_RecoverVarFinalizeSION(filehandle);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="2458"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2459"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//call<sp/>posix<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FILE*<sp/>file;</highlight></codeline>
<codeline lineno="2462"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>file<sp/>=<sp/>FTI_RecoverVarInitPOSIX(fn);</highlight></codeline>
<codeline lineno="2463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(file<sp/>==<sp/>NULL){</highlight></codeline>
<codeline lineno="2464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="2465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="2466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/>FTI_RecoverVarPOSIX(&amp;FTI_Conf,<sp/>&amp;FTI_Exec,<sp/>&amp;FTI_Topo,<sp/>FTI_Ckpt,<sp/>FTI_Data,<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>file);</highlight></codeline>
<codeline lineno="2467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(res<sp/>!=<sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>){</highlight></codeline>
<codeline lineno="2468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/>FTI_RecoverVarFinalizePOSIX(file);</highlight></codeline>
<codeline lineno="2469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2471"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;Selected<sp/>Ckpt<sp/>I/O<sp/>is<sp/>SION,<sp/>but<sp/>SION<sp/>is<sp/>not<sp/>enabled.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>);</highlight></codeline>
<codeline lineno="2473"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2475"><highlight class="normal"></highlight></codeline>
<codeline lineno="2476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="fti-intern_8h_1ab4185f9b1ad1804d6d89182627205923" kindref="member">FTI_IO_POSIX</ref>:</highlight></codeline>
<codeline lineno="2477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FILE*<sp/>file;</highlight></codeline>
<codeline lineno="2479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>file<sp/>=<sp/>FTI_RecoverVarInitPOSIX(fn);</highlight></codeline>
<codeline lineno="2480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(file<sp/>==<sp/>NULL){</highlight></codeline>
<codeline lineno="2481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="2482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="2483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/>FTI_RecoverVarPOSIX(&amp;FTI_Conf,<sp/>&amp;FTI_Exec,<sp/>&amp;FTI_Topo,<sp/>FTI_Ckpt,<sp/>FTI_Data,<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>file);</highlight></codeline>
<codeline lineno="2484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(res<sp/>!=<sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>){</highlight></codeline>
<codeline lineno="2485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/>FTI_RecoverVarFinalizePOSIX(file);</highlight></codeline>
<codeline lineno="2486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2490"><highlight class="normal"></highlight></codeline>
<codeline lineno="2491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="fti-intern_8h_1aabd1aaea4c0ca8933c8e3035f5506c29" kindref="member">FTI_IO_MPI</ref>:</highlight></codeline>
<codeline lineno="2492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*MPI_File<sp/>mpf<sp/>;</highlight></codeline>
<codeline lineno="2493"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mpf<sp/>=<sp/>FTI_RecoverVarInitMPIIO(fn);</highlight></codeline>
<codeline lineno="2494"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/>FTI_RecoverVarMPIIO(mpf);</highlight></codeline>
<codeline lineno="2495"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if(res<sp/>!=<sp/>FTI_NSCS){</highlight></codeline>
<codeline lineno="2496"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/>FTI_RecoverVarFinalizeMPIIO(mpf);</highlight></codeline>
<codeline lineno="2497"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2498"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//call<sp/>posix<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2499"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FILE*<sp/>file;</highlight></codeline>
<codeline lineno="2501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>file<sp/>=<sp/>FTI_RecoverVarInitPOSIX(fn);</highlight></codeline>
<codeline lineno="2502"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(file<sp/>==<sp/>NULL){</highlight></codeline>
<codeline lineno="2503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="2504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="2505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/>FTI_RecoverVarPOSIX(&amp;FTI_Conf,<sp/>&amp;FTI_Exec,<sp/>&amp;FTI_Topo,<sp/>FTI_Ckpt,<sp/>FTI_Data,<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>file);</highlight></codeline>
<codeline lineno="2506"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(res<sp/>!=<sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>){</highlight></codeline>
<codeline lineno="2507"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/>FTI_RecoverVarFinalizePOSIX(file);</highlight></codeline>
<codeline lineno="2508"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2509"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2512"><highlight class="normal"></highlight></codeline>
<codeline lineno="2513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="fti-intern_8h_1a2b6ae4a8dc77345c8aa9497f8cb9291b" kindref="member">FTI_IO_FTIFF</ref>:</highlight></codeline>
<codeline lineno="2514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*fmmap<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="2516"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal">stat<sp/>st;</highlight></codeline>
<codeline lineno="2517"><highlight class="normal"></highlight></codeline>
<codeline lineno="2518"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(FTI_RecoverVarInitFTIFF(fn,<sp/>fmmap,<sp/>st)<sp/>!=<sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>){</highlight></codeline>
<codeline lineno="2519"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(FTIFF_RecoverVar(&amp;FTI_Conf,<sp/>&amp;FTI_Exec,<sp/>&amp;FTI_Topo,<sp/>FTI_Ckpt,<sp/>FTI_Data,<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>fmmap,<sp/>st)<sp/>!=<sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>){</highlight></codeline>
<codeline lineno="2520"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/>FTI_RecoverVarFinalizeFTIFF(fmmap,<sp/>st);</highlight></codeline>
<codeline lineno="2521"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2525"><highlight class="normal"></highlight></codeline>
<codeline lineno="2526"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:<sp/></highlight></codeline>
<codeline lineno="2527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="stringliteral">&quot;Unknown<sp/>I/O<sp/>mode.&quot;</highlight><highlight class="normal">,<sp/><ref refid="fti-intern_8h_1a5cb1252ae17ef4ac13b3dbe5a8b1ab13" kindref="member">FTI_EROR</ref>);</highlight></codeline>
<codeline lineno="2528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="fti_8h_1a06d23a2210e17078a6a8862bb6ed3dbd" kindref="member">FTI_NSCS</ref>;</highlight></codeline>
<codeline lineno="2529"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2530"><highlight class="normal"></highlight></codeline>
<codeline lineno="2531"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>res;<sp/></highlight></codeline>
<codeline lineno="2532"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2533"><highlight class="normal"></highlight></codeline>
<codeline lineno="2534"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="2547"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*-------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2548" refid="tools_8h_1a691a9e560e92286bb5bc1b5cf2f7b199" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="api_8c_1a691a9e560e92286bb5bc1b5cf2f7b199" kindref="member">FTI_Print</ref>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>msg,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>priority)</highlight></codeline>
<codeline lineno="2549"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(priority<sp/>&gt;=<sp/>FTI_Conf.<ref refid="structFTIT__configuration_1a2776919d74dd1310a03eb046a1c16d0f" kindref="member">verbosity</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(msg<sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="2552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(priority)<sp/>{</highlight></codeline>
<codeline lineno="2553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="fti-intern_8h_1a5cb1252ae17ef4ac13b3dbe5a8b1ab13" kindref="member">FTI_EROR</ref>:</highlight></codeline>
<codeline lineno="2554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fprintf(stderr,<sp/></highlight><highlight class="stringliteral">&quot;[<sp/>&quot;</highlight><highlight class="normal"><sp/><ref refid="fti-intern_8h_1ac3683454d173eb7760cb1522546edd6f" kindref="member">FTI_COLOR_RED</ref><sp/></highlight><highlight class="stringliteral">&quot;FTI<sp/>Error<sp/>-<sp/>%06d&quot;</highlight><highlight class="normal"><sp/><ref refid="fti-intern_8h_1acd80acb4bfaa1876873074dc16523949" kindref="member">FTI_COLOR_RESET</ref><sp/></highlight><highlight class="stringliteral">&quot;<sp/>]<sp/>:<sp/>%s<sp/>:<sp/>%s<sp/>\n&quot;</highlight><highlight class="normal">,<sp/>FTI_Topo.<ref refid="structFTIT__topology_1afd9e834e60e98abbce232192a38a7d58" kindref="member">myRank</ref>,<sp/>msg,<sp/>strerror(errno));</highlight></codeline>
<codeline lineno="2555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="fti-intern_8h_1a93eeeef1e283517099194859e3811ea3" kindref="member">FTI_WARN</ref>:</highlight></codeline>
<codeline lineno="2557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fprintf(stdout,<sp/></highlight><highlight class="stringliteral">&quot;[<sp/>&quot;</highlight><highlight class="normal"><sp/><ref refid="fti-intern_8h_1a7e585d7d07971244e02b7611e13a6ede" kindref="member">FTI_COLOR_ORG</ref><sp/></highlight><highlight class="stringliteral">&quot;FTI<sp/>Warning<sp/>%06d&quot;</highlight><highlight class="normal"><sp/><ref refid="fti-intern_8h_1acd80acb4bfaa1876873074dc16523949" kindref="member">FTI_COLOR_RESET</ref><sp/></highlight><highlight class="stringliteral">&quot;<sp/>]<sp/>:<sp/>%s<sp/>\n&quot;</highlight><highlight class="normal">,<sp/>FTI_Topo.<ref refid="structFTIT__topology_1afd9e834e60e98abbce232192a38a7d58" kindref="member">myRank</ref>,<sp/>msg);</highlight></codeline>
<codeline lineno="2558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="fti-intern_8h_1a26a561f0e03eec3d15541c85a2a21ffd" kindref="member">FTI_INFO</ref>:</highlight></codeline>
<codeline lineno="2560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Topo.<ref refid="structFTIT__topology_1a3d4083051c43d031972d83cffb242a38" kindref="member">splitRank</ref><sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="2561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fprintf(stdout,<sp/></highlight><highlight class="stringliteral">&quot;[<sp/>&quot;</highlight><highlight class="normal"><sp/><ref refid="fti-intern_8h_1a88c5836e3bd4a15e42940f9c3ccd2650" kindref="member">FTI_COLOR_GRN</ref><sp/></highlight><highlight class="stringliteral">&quot;FTI<sp/><sp/>Information&quot;</highlight><highlight class="normal"><sp/><ref refid="fti-intern_8h_1acd80acb4bfaa1876873074dc16523949" kindref="member">FTI_COLOR_RESET</ref><sp/></highlight><highlight class="stringliteral">&quot;<sp/>]<sp/>:<sp/>%s<sp/>\n&quot;</highlight><highlight class="normal">,<sp/>msg);</highlight></codeline>
<codeline lineno="2562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2564"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="fti-intern_8h_1a1f830f16990f67e20896cef5e40e949d" kindref="member">FTI_IDCP</ref>:</highlight></codeline>
<codeline lineno="2565"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FTI_Topo.<ref refid="structFTIT__topology_1a3d4083051c43d031972d83cffb242a38" kindref="member">splitRank</ref><sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="2566"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fprintf(stdout,<sp/></highlight><highlight class="stringliteral">&quot;[<sp/>&quot;</highlight><highlight class="normal"><sp/><ref refid="fti-intern_8h_1acd37e039b072d4aaa9b0f29ed4e981f3" kindref="member">FTI_COLOR_BLU</ref><sp/></highlight><highlight class="stringliteral">&quot;FTI<sp/><sp/>dCP<sp/>Message&quot;</highlight><highlight class="normal"><sp/><ref refid="fti-intern_8h_1acd80acb4bfaa1876873074dc16523949" kindref="member">FTI_COLOR_RESET</ref><sp/></highlight><highlight class="stringliteral">&quot;<sp/>]<sp/>:<sp/>%s<sp/>\n&quot;</highlight><highlight class="normal">,<sp/>msg);</highlight></codeline>
<codeline lineno="2567"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2568"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2569"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="fti-intern_8h_1a299db837571db9e73119d159b3428fe0" kindref="member">FTI_DBUG</ref>:</highlight></codeline>
<codeline lineno="2570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fprintf(stdout,<sp/></highlight><highlight class="stringliteral">&quot;[FTI<sp/>Debug<sp/>-<sp/>%06d]<sp/>:<sp/>%s<sp/>\n&quot;</highlight><highlight class="normal">,<sp/>FTI_Topo.<ref refid="structFTIT__topology_1afd9e834e60e98abbce232192a38a7d58" kindref="member">myRank</ref>,<sp/>msg);</highlight></codeline>
<codeline lineno="2571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2575"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fflush(stdout);</highlight></codeline>
<codeline lineno="2576"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
    </programlisting>
    <location file="/home/bscuser/Documents/release/dev/fti/src/api.c"/>
  </compounddef>
</doxygen>
